"use strict";(()=>{var Nc=Object.create;var vo=Object.defineProperty;var El=Object.getOwnPropertyDescriptor;var Bc=Object.getOwnPropertyNames;var Hc=Object.getPrototypeOf,Uc=Object.prototype.hasOwnProperty;var _i=Math.pow;var Vc=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var Gc=(s,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Bc(t))!Uc.call(s,a)&&a!==e&&vo(s,a,{get:()=>t[a],enumerable:!(i=El(t,a))||i.enumerable});return s};var Fc=(s,t,e)=>(e=s!=null?Nc(Hc(s)):{},Gc(t||!s||!s.__esModule?vo(e,"default",{value:s,enumerable:!0}):e,s));var u=(s,t,e,i)=>{for(var a=i>1?void 0:i?El(t,e):t,n=s.length-1,r;n>=0;n--)(r=s[n])&&(a=(i?r(t,e,a):r(a))||a);return i&&a&&vo(t,e,a),a};var _=(s,t,e)=>new Promise((i,a)=>{var n=l=>{try{o(e.next(l))}catch(v){a(v)}},r=l=>{try{o(e.throw(l))}catch(v){a(v)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(n,r);o((e=e.apply(s,t)).next())});var Dl=Vc((xo,Ao)=>{"use strict";(function(s,t){typeof xo=="object"&&typeof Ao!="undefined"?Ao.exports=t():typeof define=="function"&&define.amd?define(t):(s=typeof globalThis!="undefined"?globalThis:s||self).jsSHA=t()})(xo,function(){"use strict";var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function t(g,c,h,y){var L,m,T,M=c||[0],O=(h=h||0)>>>3,G=y===-1?3:0;for(L=0;L<g.length;L+=1)m=(T=L+O)>>>2,M.length<=m&&M.push(0),M[m]|=g[L]<<8*(G+y*(T%4));return{value:M,binLen:8*g.length+h}}function e(g,c,h){switch(c){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(g){case"HEX":return function(y,L,m){return function(T,M,O,G){var $,U,K,st;if(T.length%2!=0)throw new Error("String of HEX type must be in byte increments");var N=M||[0],ht=(O=O||0)>>>3,ut=G===-1?3:0;for($=0;$<T.length;$+=2){if(U=parseInt(T.substr($,2),16),isNaN(U))throw new Error("String of HEX type contains invalid characters");for(K=(st=($>>>1)+ht)>>>2;N.length<=K;)N.push(0);N[K]|=U<<8*(ut+G*(st%4))}return{value:N,binLen:4*T.length+O}}(y,L,m,h)};case"TEXT":return function(y,L,m){return function(T,M,O,G,$){var U,K,st,N,ht,ut,gt,St,Ie=0,Jt=O||[0],ce=(G=G||0)>>>3;if(M==="UTF8")for(gt=$===-1?3:0,st=0;st<T.length;st+=1)for(K=[],128>(U=T.charCodeAt(st))?K.push(U):2048>U?(K.push(192|U>>>6),K.push(128|63&U)):55296>U||57344<=U?K.push(224|U>>>12,128|U>>>6&63,128|63&U):(st+=1,U=65536+((1023&U)<<10|1023&T.charCodeAt(st)),K.push(240|U>>>18,128|U>>>12&63,128|U>>>6&63,128|63&U)),N=0;N<K.length;N+=1){for(ht=(ut=Ie+ce)>>>2;Jt.length<=ht;)Jt.push(0);Jt[ht]|=K[N]<<8*(gt+$*(ut%4)),Ie+=1}else for(gt=$===-1?2:0,St=M==="UTF16LE"&&$!==1||M!=="UTF16LE"&&$===1,st=0;st<T.length;st+=1){for(U=T.charCodeAt(st),St===!0&&(U=(N=255&U)<<8|U>>>8),ht=(ut=Ie+ce)>>>2;Jt.length<=ht;)Jt.push(0);Jt[ht]|=U<<8*(gt+$*(ut%4)),Ie+=2}return{value:Jt,binLen:8*Ie+G}}(y,c,L,m,h)};case"B64":return function(y,L,m){return function(T,M,O,G){var $,U,K,st,N,ht,ut=0,gt=M||[0],St=(O=O||0)>>>3,Ie=G===-1?3:0,Jt=T.indexOf("=");if(T.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(T=T.replace(/=/g,""),Jt!==-1&&Jt<T.length)throw new Error("Invalid '=' found in base-64 string");for($=0;$<T.length;$+=4){for(st=T.substr($,4),K=0,U=0;U<st.length;U+=1)K|=s.indexOf(st.charAt(U))<<18-6*U;for(U=0;U<st.length-1;U+=1){for(N=(ht=ut+St)>>>2;gt.length<=N;)gt.push(0);gt[N]|=(K>>>16-8*U&255)<<8*(Ie+G*(ht%4)),ut+=1}}return{value:gt,binLen:8*ut+O}}(y,L,m,h)};case"BYTES":return function(y,L,m){return function(T,M,O,G){var $,U,K,st,N=M||[0],ht=(O=O||0)>>>3,ut=G===-1?3:0;for(U=0;U<T.length;U+=1)$=T.charCodeAt(U),K=(st=U+ht)>>>2,N.length<=K&&N.push(0),N[K]|=$<<8*(ut+G*(st%4));return{value:N,binLen:8*T.length+O}}(y,L,m,h)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(y){throw new Error("ARRAYBUFFER not supported by this environment")}return function(y,L,m){return function(T,M,O,G){return t(new Uint8Array(T),M,O,G)}(y,L,m,h)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(y){throw new Error("UINT8ARRAY not supported by this environment")}return function(y,L,m){return t(y,L,m,h)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function i(g,c,h,y){switch(g){case"HEX":return function(L){return function(m,T,M,O){var G,$,U="",K=T/8,st=M===-1?3:0;for(G=0;G<K;G+=1)$=m[G>>>2]>>>8*(st+M*(G%4)),U+="0123456789abcdef".charAt($>>>4&15)+"0123456789abcdef".charAt(15&$);return O.outputUpper?U.toUpperCase():U}(L,c,h,y)};case"B64":return function(L){return function(m,T,M,O){var G,$,U,K,st,N="",ht=T/8,ut=M===-1?3:0;for(G=0;G<ht;G+=3)for(K=G+1<ht?m[G+1>>>2]:0,st=G+2<ht?m[G+2>>>2]:0,U=(m[G>>>2]>>>8*(ut+M*(G%4))&255)<<16|(K>>>8*(ut+M*((G+1)%4))&255)<<8|st>>>8*(ut+M*((G+2)%4))&255,$=0;$<4;$+=1)N+=8*G+6*$<=T?s.charAt(U>>>6*(3-$)&63):O.b64Pad;return N}(L,c,h,y)};case"BYTES":return function(L){return function(m,T,M){var O,G,$="",U=T/8,K=M===-1?3:0;for(O=0;O<U;O+=1)G=m[O>>>2]>>>8*(K+M*(O%4))&255,$+=String.fromCharCode(G);return $}(L,c,h)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(L){throw new Error("ARRAYBUFFER not supported by this environment")}return function(L){return function(m,T,M){var O,G=T/8,$=new ArrayBuffer(G),U=new Uint8Array($),K=M===-1?3:0;for(O=0;O<G;O+=1)U[O]=m[O>>>2]>>>8*(K+M*(O%4))&255;return $}(L,c,h)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(L){throw new Error("UINT8ARRAY not supported by this environment")}return function(L){return function(m,T,M){var O,G=T/8,$=M===-1?3:0,U=new Uint8Array(G);for(O=0;O<G;O+=1)U[O]=m[O>>>2]>>>8*($+M*(O%4))&255;return U}(L,c,h)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],o="Chosen SHA variant is not supported";function l(g,c){var h,y,L=g.binLen>>>3,m=c.binLen>>>3,T=L<<3,M=4-L<<3;if(L%4!=0){for(h=0;h<m;h+=4)y=L+h>>>2,g.value[y]|=c.value[h>>>2]<<T,g.value.push(0),g.value[y+1]|=c.value[h>>>2]>>>M;return(g.value.length<<2)-4>=m+L&&g.value.pop(),{value:g.value,binLen:g.binLen+c.binLen}}return{value:g.value.concat(c.value),binLen:g.binLen+c.binLen}}function v(g){var c={outputUpper:!1,b64Pad:"=",outputLen:-1},h=g||{},y="Output length must be a multiple of 8";if(c.outputUpper=h.outputUpper||!1,h.b64Pad&&(c.b64Pad=h.b64Pad),h.outputLen){if(h.outputLen%8!=0)throw new Error(y);c.outputLen=h.outputLen}else if(h.shakeLen){if(h.shakeLen%8!=0)throw new Error(y);c.outputLen=h.shakeLen}if(typeof c.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof c.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return c}function I(g,c,h,y){var L=g+" must include a value and format";if(!c){if(!y)throw new Error(L);return y}if(c.value===void 0||!c.format)throw new Error(L);return e(c.format,c.encoding||"UTF8",h)(c.value)}var k=function(){function g(c,h,y){var L=y||{};if(this.t=h,this.i=L.encoding||"UTF8",this.numRounds=L.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=c,this.u=[],this.s=0,this.h=!1,this.v=0,this.A=!1,this.l=[],this.H=[]}return g.prototype.update=function(c){var h,y=0,L=this.S>>>5,m=this.p(c,this.u,this.s),T=m.binLen,M=m.value,O=T>>>5;for(h=0;h<O;h+=L)y+this.S<=T&&(this.m=this.R(M.slice(h,h+L),this.m),y+=this.S);this.v+=y,this.u=M.slice(y>>>5),this.s=T%this.S,this.h=!0},g.prototype.getHash=function(c,h){var y,L,m=this.U,T=v(h);if(this.T){if(T.outputLen===-1)throw new Error("Output length must be specified in options");m=T.outputLen}var M=i(c,m,this.C,T);if(this.A&&this.F)return M(this.F(T));for(L=this.K(this.u.slice(),this.s,this.v,this.B(this.m),m),y=1;y<this.numRounds;y+=1)this.T&&m%32!=0&&(L[L.length-1]&=16777215>>>24-m%32),L=this.K(L,m,0,this.L(this.o),m);return M(L)},g.prototype.setHMACKey=function(c,h,y){if(!this.g)throw new Error("Variant does not support HMAC");if(this.h)throw new Error("Cannot set MAC key after calling update");var L=e(h,(y||{}).encoding||"UTF8",this.C);this.k(L(c))},g.prototype.k=function(c){var h,y=this.S>>>3,L=y/4-1;if(this.numRounds!==1)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(y<c.binLen/8&&(c.value=this.K(c.value,c.binLen,0,this.L(this.o),this.U));c.value.length<=L;)c.value.push(0);for(h=0;h<=L;h+=1)this.l[h]=909522486^c.value[h],this.H[h]=1549556828^c.value[h];this.m=this.R(this.l,this.m),this.v=this.S,this.A=!0},g.prototype.getHMAC=function(c,h){var y=v(h);return i(c,this.U,this.C,y)(this.Y())},g.prototype.Y=function(){var c;if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");var h=this.K(this.u.slice(),this.s,this.v,this.B(this.m),this.U);return c=this.R(this.H,this.L(this.o)),c=this.K(h,this.U,this.S,c,this.U)},g}(),q=function(g,c){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,y){h.__proto__=y}||function(h,y){for(var L in y)Object.prototype.hasOwnProperty.call(y,L)&&(h[L]=y[L])})(g,c)};function Q(g,c){function h(){this.constructor=g}q(g,c),g.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)}function H(g,c){return g<<c|g>>>32-c}function Z(g,c){return g>>>c|g<<32-c}function Dt(g,c){return g>>>c}function Gt(g,c,h){return g^c^h}function Wt(g,c,h){return g&c^~g&h}function we(g,c,h){return g&c^g&h^c&h}function gi(g){return Z(g,2)^Z(g,13)^Z(g,22)}function Ft(g,c){var h=(65535&g)+(65535&c);return(65535&(g>>>16)+(c>>>16)+(h>>>16))<<16|65535&h}function yc(g,c,h,y){var L=(65535&g)+(65535&c)+(65535&h)+(65535&y);return(65535&(g>>>16)+(c>>>16)+(h>>>16)+(y>>>16)+(L>>>16))<<16|65535&L}function bi(g,c,h,y,L){var m=(65535&g)+(65535&c)+(65535&h)+(65535&y)+(65535&L);return(65535&(g>>>16)+(c>>>16)+(h>>>16)+(y>>>16)+(L>>>16)+(m>>>16))<<16|65535&m}function gc(g){return Z(g,7)^Z(g,18)^Dt(g,3)}function bc(g){return Z(g,6)^Z(g,11)^Z(g,25)}function fc(g){return[1732584193,4023233417,2562383102,271733878,3285377520]}function gl(g,c){var h,y,L,m,T,M,O,G=[];for(h=c[0],y=c[1],L=c[2],m=c[3],T=c[4],O=0;O<80;O+=1)G[O]=O<16?g[O]:H(G[O-3]^G[O-8]^G[O-14]^G[O-16],1),M=O<20?bi(H(h,5),Wt(y,L,m),T,1518500249,G[O]):O<40?bi(H(h,5),Gt(y,L,m),T,1859775393,G[O]):O<60?bi(H(h,5),we(y,L,m),T,2400959708,G[O]):bi(H(h,5),Gt(y,L,m),T,3395469782,G[O]),T=m,m=L,L=H(y,30),y=h,h=M;return c[0]=Ft(h,c[0]),c[1]=Ft(y,c[1]),c[2]=Ft(L,c[2]),c[3]=Ft(m,c[3]),c[4]=Ft(T,c[4]),c}function Lc(g,c,h,y){for(var L,m=15+(c+65>>>9<<4),T=c+h;g.length<=m;)g.push(0);for(g[c>>>5]|=128<<24-c%32,g[m]=4294967295&T,g[m-1]=T/4294967296|0,L=0;L<g.length;L+=16)y=gl(g.slice(L,L+16),y);return y}var _c=function(g){function c(h,y,L){var m=this;if(h!=="SHA-1")throw new Error(o);var T=L||{};return(m=g.call(this,h,y,L)||this).g=!0,m.F=m.Y,m.C=-1,m.p=e(m.t,m.i,m.C),m.R=gl,m.B=function(M){return M.slice()},m.L=fc,m.K=Lc,m.m=[1732584193,4023233417,2562383102,271733878,3285377520],m.S=512,m.U=160,m.T=!1,T.hmacKey&&m.k(I("hmacKey",T.hmacKey,m.C)),m}return Q(c,g),c}(k);function bl(g){return g=="SHA-224"?n.slice():r.slice()}function fl(g,c){var h,y,L,m,T,M,O,G,$,U,K,st,N=[];for(h=c[0],y=c[1],L=c[2],m=c[3],T=c[4],M=c[5],O=c[6],G=c[7],K=0;K<64;K+=1)N[K]=K<16?g[K]:yc(Z(st=N[K-2],17)^Z(st,19)^Dt(st,10),N[K-7],gc(N[K-15]),N[K-16]),$=bi(G,bc(T),Wt(T,M,O),a[K],N[K]),U=Ft(gi(h),we(h,y,L)),G=O,O=M,M=T,T=Ft(m,$),m=L,L=y,y=h,h=Ft($,U);return c[0]=Ft(h,c[0]),c[1]=Ft(y,c[1]),c[2]=Ft(L,c[2]),c[3]=Ft(m,c[3]),c[4]=Ft(T,c[4]),c[5]=Ft(M,c[5]),c[6]=Ft(O,c[6]),c[7]=Ft(G,c[7]),c}var vc=function(g){function c(h,y,L){var m=this;if(h!=="SHA-224"&&h!=="SHA-256")throw new Error(o);var T=L||{};return(m=g.call(this,h,y,L)||this).F=m.Y,m.g=!0,m.C=-1,m.p=e(m.t,m.i,m.C),m.R=fl,m.B=function(M){return M.slice()},m.L=bl,m.K=function(M,O,G,$){return function(U,K,st,N,ht){for(var ut,gt=15+(K+65>>>9<<4),St=K+st;U.length<=gt;)U.push(0);for(U[K>>>5]|=128<<24-K%32,U[gt]=4294967295&St,U[gt-1]=St/4294967296|0,ut=0;ut<U.length;ut+=16)N=fl(U.slice(ut,ut+16),N);return ht==="SHA-224"?[N[0],N[1],N[2],N[3],N[4],N[5],N[6]]:N}(M,O,G,$,h)},m.m=bl(h),m.S=512,m.U=h==="SHA-224"?224:256,m.T=!1,T.hmacKey&&m.k(I("hmacKey",T.hmacKey,m.C)),m}return Q(c,g),c}(k),w=function(g,c){this.N=g,this.I=c};function Ll(g,c){var h;return c>32?(h=64-c,new w(g.I<<c|g.N>>>h,g.N<<c|g.I>>>h)):c!==0?(h=32-c,new w(g.N<<c|g.I>>>h,g.I<<c|g.N>>>h)):g}function be(g,c){var h;return c<32?(h=32-c,new w(g.N>>>c|g.I<<h,g.I>>>c|g.N<<h)):(h=64-c,new w(g.I>>>c|g.N<<h,g.N>>>c|g.I<<h))}function _l(g,c){return new w(g.N>>>c,g.I>>>c|g.N<<32-c)}function wc(g,c,h){return new w(g.N&c.N^~g.N&h.N,g.I&c.I^~g.I&h.I)}function Ic(g,c,h){return new w(g.N&c.N^g.N&h.N^c.N&h.N,g.I&c.I^g.I&h.I^c.I&h.I)}function Sc(g){var c=be(g,28),h=be(g,34),y=be(g,39);return new w(c.N^h.N^y.N,c.I^h.I^y.I)}function le(g,c){var h,y;h=(65535&g.I)+(65535&c.I);var L=(65535&(y=(g.I>>>16)+(c.I>>>16)+(h>>>16)))<<16|65535&h;return h=(65535&g.N)+(65535&c.N)+(y>>>16),y=(g.N>>>16)+(c.N>>>16)+(h>>>16),new w((65535&y)<<16|65535&h,L)}function Ec(g,c,h,y){var L,m;L=(65535&g.I)+(65535&c.I)+(65535&h.I)+(65535&y.I);var T=(65535&(m=(g.I>>>16)+(c.I>>>16)+(h.I>>>16)+(y.I>>>16)+(L>>>16)))<<16|65535&L;return L=(65535&g.N)+(65535&c.N)+(65535&h.N)+(65535&y.N)+(m>>>16),m=(g.N>>>16)+(c.N>>>16)+(h.N>>>16)+(y.N>>>16)+(L>>>16),new w((65535&m)<<16|65535&L,T)}function Tc(g,c,h,y,L){var m,T;m=(65535&g.I)+(65535&c.I)+(65535&h.I)+(65535&y.I)+(65535&L.I);var M=(65535&(T=(g.I>>>16)+(c.I>>>16)+(h.I>>>16)+(y.I>>>16)+(L.I>>>16)+(m>>>16)))<<16|65535&m;return m=(65535&g.N)+(65535&c.N)+(65535&h.N)+(65535&y.N)+(65535&L.N)+(T>>>16),T=(g.N>>>16)+(c.N>>>16)+(h.N>>>16)+(y.N>>>16)+(L.N>>>16)+(m>>>16),new w((65535&T)<<16|65535&m,M)}function fi(g,c){return new w(g.N^c.N,g.I^c.I)}function Dc(g){var c=be(g,1),h=be(g,8),y=_l(g,7);return new w(c.N^h.N^y.N,c.I^h.I^y.I)}function Cc(g){var c=be(g,14),h=be(g,18),y=be(g,41);return new w(c.N^h.N^y.N,c.I^h.I^y.I)}var Mc=[new w(a[0],3609767458),new w(a[1],602891725),new w(a[2],3964484399),new w(a[3],2173295548),new w(a[4],4081628472),new w(a[5],3053834265),new w(a[6],2937671579),new w(a[7],3664609560),new w(a[8],2734883394),new w(a[9],1164996542),new w(a[10],1323610764),new w(a[11],3590304994),new w(a[12],4068182383),new w(a[13],991336113),new w(a[14],633803317),new w(a[15],3479774868),new w(a[16],2666613458),new w(a[17],944711139),new w(a[18],2341262773),new w(a[19],2007800933),new w(a[20],1495990901),new w(a[21],1856431235),new w(a[22],3175218132),new w(a[23],2198950837),new w(a[24],3999719339),new w(a[25],766784016),new w(a[26],2566594879),new w(a[27],3203337956),new w(a[28],1034457026),new w(a[29],2466948901),new w(a[30],3758326383),new w(a[31],168717936),new w(a[32],1188179964),new w(a[33],1546045734),new w(a[34],1522805485),new w(a[35],2643833823),new w(a[36],2343527390),new w(a[37],1014477480),new w(a[38],1206759142),new w(a[39],344077627),new w(a[40],1290863460),new w(a[41],3158454273),new w(a[42],3505952657),new w(a[43],106217008),new w(a[44],3606008344),new w(a[45],1432725776),new w(a[46],1467031594),new w(a[47],851169720),new w(a[48],3100823752),new w(a[49],1363258195),new w(a[50],3750685593),new w(a[51],3785050280),new w(a[52],3318307427),new w(a[53],3812723403),new w(a[54],2003034995),new w(a[55],3602036899),new w(a[56],1575990012),new w(a[57],1125592928),new w(a[58],2716904306),new w(a[59],442776044),new w(a[60],593698344),new w(a[61],3733110249),new w(a[62],2999351573),new w(a[63],3815920427),new w(3391569614,3928383900),new w(3515267271,566280711),new w(3940187606,3454069534),new w(4118630271,4000239992),new w(116418474,1914138554),new w(174292421,2731055270),new w(289380356,3203993006),new w(460393269,320620315),new w(685471733,587496836),new w(852142971,1086792851),new w(1017036298,365543100),new w(1126000580,2618297676),new w(1288033470,3409855158),new w(1501505948,4234509866),new w(1607167915,987167468),new w(1816402316,1246189591)];function vl(g){return g==="SHA-384"?[new w(3418070365,n[0]),new w(1654270250,n[1]),new w(2438529370,n[2]),new w(355462360,n[3]),new w(1731405415,n[4]),new w(41048885895,n[5]),new w(3675008525,n[6]),new w(1203062813,n[7])]:[new w(r[0],4089235720),new w(r[1],2227873595),new w(r[2],4271175723),new w(r[3],1595750129),new w(r[4],2917565137),new w(r[5],725511199),new w(r[6],4215389547),new w(r[7],327033209)]}function wl(g,c){var h,y,L,m,T,M,O,G,$,U,K,st,N,ht,ut,gt,St=[];for(h=c[0],y=c[1],L=c[2],m=c[3],T=c[4],M=c[5],O=c[6],G=c[7],K=0;K<80;K+=1)K<16?(st=2*K,St[K]=new w(g[st],g[st+1])):St[K]=Ec((N=St[K-2],ht=void 0,ut=void 0,gt=void 0,ht=be(N,19),ut=be(N,61),gt=_l(N,6),new w(ht.N^ut.N^gt.N,ht.I^ut.I^gt.I)),St[K-7],Dc(St[K-15]),St[K-16]),$=Tc(G,Cc(T),wc(T,M,O),Mc[K],St[K]),U=le(Sc(h),Ic(h,y,L)),G=O,O=M,M=T,T=le(m,$),m=L,L=y,y=h,h=le($,U);return c[0]=le(h,c[0]),c[1]=le(y,c[1]),c[2]=le(L,c[2]),c[3]=le(m,c[3]),c[4]=le(T,c[4]),c[5]=le(M,c[5]),c[6]=le(O,c[6]),c[7]=le(G,c[7]),c}var xc=function(g){function c(h,y,L){var m=this;if(h!=="SHA-384"&&h!=="SHA-512")throw new Error(o);var T=L||{};return(m=g.call(this,h,y,L)||this).F=m.Y,m.g=!0,m.C=-1,m.p=e(m.t,m.i,m.C),m.R=wl,m.B=function(M){return M.slice()},m.L=vl,m.K=function(M,O,G,$){return function(U,K,st,N,ht){for(var ut,gt=31+(K+129>>>10<<5),St=K+st;U.length<=gt;)U.push(0);for(U[K>>>5]|=128<<24-K%32,U[gt]=4294967295&St,U[gt-1]=St/4294967296|0,ut=0;ut<U.length;ut+=32)N=wl(U.slice(ut,ut+32),N);return ht==="SHA-384"?[(N=N)[0].N,N[0].I,N[1].N,N[1].I,N[2].N,N[2].I,N[3].N,N[3].I,N[4].N,N[4].I,N[5].N,N[5].I]:[N[0].N,N[0].I,N[1].N,N[1].I,N[2].N,N[2].I,N[3].N,N[3].I,N[4].N,N[4].I,N[5].N,N[5].I,N[6].N,N[6].I,N[7].N,N[7].I]}(M,O,G,$,h)},m.m=vl(h),m.S=1024,m.U=h==="SHA-384"?384:512,m.T=!1,T.hmacKey&&m.k(I("hmacKey",T.hmacKey,m.C)),m}return Q(c,g),c}(k),Ac=[new w(0,1),new w(0,32898),new w(2147483648,32906),new w(2147483648,2147516416),new w(0,32907),new w(0,2147483649),new w(2147483648,2147516545),new w(2147483648,32777),new w(0,138),new w(0,136),new w(0,2147516425),new w(0,2147483658),new w(0,2147516555),new w(2147483648,139),new w(2147483648,32905),new w(2147483648,32771),new w(2147483648,32770),new w(2147483648,128),new w(0,32778),new w(2147483648,2147483658),new w(2147483648,2147516545),new w(2147483648,32896),new w(0,2147483649),new w(2147483648,2147516424)],Rc=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function fo(g){var c,h=[];for(c=0;c<5;c+=1)h[c]=[new w(0,0),new w(0,0),new w(0,0),new w(0,0),new w(0,0)];return h}function kc(g){var c,h=[];for(c=0;c<5;c+=1)h[c]=g[c].slice();return h}function Pa(g,c){var h,y,L,m,T,M,O,G,$,U=[],K=[];if(g!==null)for(y=0;y<g.length;y+=2)c[(y>>>1)%5][(y>>>1)/5|0]=fi(c[(y>>>1)%5][(y>>>1)/5|0],new w(g[y+1],g[y]));for(h=0;h<24;h+=1){for(m=fo(),y=0;y<5;y+=1)U[y]=(T=c[y][0],M=c[y][1],O=c[y][2],G=c[y][3],$=c[y][4],new w(T.N^M.N^O.N^G.N^$.N,T.I^M.I^O.I^G.I^$.I));for(y=0;y<5;y+=1)K[y]=fi(U[(y+4)%5],Ll(U[(y+1)%5],1));for(y=0;y<5;y+=1)for(L=0;L<5;L+=1)c[y][L]=fi(c[y][L],K[y]);for(y=0;y<5;y+=1)for(L=0;L<5;L+=1)m[L][(2*y+3*L)%5]=Ll(c[y][L],Rc[y][L]);for(y=0;y<5;y+=1)for(L=0;L<5;L+=1)c[y][L]=fi(m[y][L],new w(~m[(y+1)%5][L].N&m[(y+2)%5][L].N,~m[(y+1)%5][L].I&m[(y+2)%5][L].I));c[0][0]=fi(c[0][0],Ac[h])}return c}function Il(g){var c,h,y=0,L=[0,0],m=[4294967295&g,g/4294967296&2097151];for(c=6;c>=0;c--)(h=m[c>>2]>>>8*c&255)===0&&y===0||(L[y+1>>2]|=h<<8*(y+1),y+=1);return y=y!==0?y:1,L[0]|=y,{value:y+1>4?L:[L[0]],binLen:8+8*y}}function Lo(g){return l(Il(g.binLen),g)}function Sl(g,c){var h,y=Il(c),L=c>>>2,m=(L-(y=l(y,g)).value.length%L)%L;for(h=0;h<m;h++)y.value.push(0);return y.value}var Oc=function(g){function c(h,y,L){var m=this,T=6,M=0,O=L||{};if((m=g.call(this,h,y,L)||this).numRounds!==1){if(O.kmacKey||O.hmacKey)throw new Error("Cannot set numRounds with MAC");if(m.o==="CSHAKE128"||m.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(m.C=1,m.p=e(m.t,m.i,m.C),m.R=Pa,m.B=kc,m.L=fo,m.m=fo(),m.T=!1,h){case"SHA3-224":m.S=M=1152,m.U=224,m.g=!0,m.F=m.Y;break;case"SHA3-256":m.S=M=1088,m.U=256,m.g=!0,m.F=m.Y;break;case"SHA3-384":m.S=M=832,m.U=384,m.g=!0,m.F=m.Y;break;case"SHA3-512":m.S=M=576,m.U=512,m.g=!0,m.F=m.Y;break;case"SHAKE128":T=31,m.S=M=1344,m.U=-1,m.T=!0,m.g=!1,m.F=null;break;case"SHAKE256":T=31,m.S=M=1088,m.U=-1,m.T=!0,m.g=!1,m.F=null;break;case"KMAC128":T=4,m.S=M=1344,m.M(L),m.U=-1,m.T=!0,m.g=!1,m.F=m.X;break;case"KMAC256":T=4,m.S=M=1088,m.M(L),m.U=-1,m.T=!0,m.g=!1,m.F=m.X;break;case"CSHAKE128":m.S=M=1344,T=m.O(L),m.U=-1,m.T=!0,m.g=!1,m.F=null;break;case"CSHAKE256":m.S=M=1088,T=m.O(L),m.U=-1,m.T=!0,m.g=!1,m.F=null;break;default:throw new Error(o)}return m.K=function(G,$,U,K,st){return function(N,ht,ut,gt,St,Ie,Jt){var ce,_o,Na=0,Li=[],Ba=St>>>5,Pc=ht>>>5;for(ce=0;ce<Pc&&ht>=St;ce+=Ba)gt=Pa(N.slice(ce,ce+Ba),gt),ht-=St;for(N=N.slice(ce),ht%=St;N.length<Ba;)N.push(0);for(N[(ce=ht>>>3)>>2]^=Ie<<ce%4*8,N[Ba-1]^=2147483648,gt=Pa(N,gt);32*Li.length<Jt&&(_o=gt[Na%5][Na/5|0],Li.push(_o.I),!(32*Li.length>=Jt));)Li.push(_o.N),64*(Na+=1)%St==0&&(Pa(null,gt),Na=0);return Li}(G,$,0,K,M,T,st)},O.hmacKey&&m.k(I("hmacKey",O.hmacKey,m.C)),m}return Q(c,g),c.prototype.O=function(h,y){var L=function(O){var G=O||{};return{funcName:I("funcName",G.funcName,1,{value:[],binLen:0}),customization:I("Customization",G.customization,1,{value:[],binLen:0})}}(h||{});y&&(L.funcName=y);var m=l(Lo(L.funcName),Lo(L.customization));if(L.customization.binLen!==0||L.funcName.binLen!==0){for(var T=Sl(m,this.S>>>3),M=0;M<T.length;M+=this.S>>>5)this.m=this.R(T.slice(M,M+(this.S>>>5)),this.m),this.v+=this.S;return 4}return 31},c.prototype.M=function(h){var y=function(T){var M=T||{};return{kmacKey:I("kmacKey",M.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:I("Customization",M.customization,1,{value:[],binLen:0})}}(h||{});this.O(h,y.funcName);for(var L=Sl(Lo(y.kmacKey),this.S>>>3),m=0;m<L.length;m+=this.S>>>5)this.m=this.R(L.slice(m,m+(this.S>>>5)),this.m),this.v+=this.S;this.A=!0},c.prototype.X=function(h){var y=l({value:this.u.slice(),binLen:this.s},function(L){var m,T,M=0,O=[0,0],G=[4294967295&L,L/4294967296&2097151];for(m=6;m>=0;m--)(T=G[m>>2]>>>8*m&255)==0&&M===0||(O[M>>2]|=T<<8*M,M+=1);return O[(M=M!==0?M:1)>>2]|=M<<8*M,{value:M+1>4?O:[O[0]],binLen:8+8*M}}(h.outputLen));return this.K(y.value,y.binLen,this.v,this.B(this.m),h.outputLen)},c}(k);return function(){function g(c,h,y){if(c=="SHA-1")this.j=new _c(c,h,y);else if(c=="SHA-224"||c=="SHA-256")this.j=new vc(c,h,y);else if(c=="SHA-384"||c=="SHA-512")this.j=new xc(c,h,y);else{if(c!="SHA3-224"&&c!="SHA3-256"&&c!="SHA3-384"&&c!="SHA3-512"&&c!="SHAKE128"&&c!="SHAKE256"&&c!="CSHAKE128"&&c!="CSHAKE256"&&c!="KMAC128"&&c!="KMAC256")throw new Error(o);this.j=new Oc(c,h,y)}}return g.prototype.update=function(c){this.j.update(c)},g.prototype.getHash=function(c,h){return this.j.getHash(c,h)},g.prototype.setHMACKey=function(c,h,y){this.j.setHMACKey(c,h,y)},g.prototype.getHMAC=function(c,h){return this.j.getHMAC(c,h)},g}()})});var Ha=class extends Laya.Scene{};var{regClass:Kc,property:sm}=Laya,vi=class extends Ha{constructor(){super()}onEnable(){console.log("IndexRT onEnable"),this.uiBtn.on(Laya.Event.CLICK,this,()=>{console.log("uiBtn"),Laya.Scene.open("scenes/UiMain.ls")}),this.phyBtn.on(Laya.Event.CLICK,this,()=>{console.log("phyBtn"),Laya.Scene.open("scenes/PhysicsGameMain.ls")}),this.d3Btn.on(Laya.Event.CLICK,this,()=>{console.log("d3Btn"),Laya.Scene.open("scenes/D3Main.ls")})}onDestroy(){}};vi=u([Kc("wtSVevJMRPCBIPp2HPhqpw")],vi);var Ua=class extends Laya.Scene{};var{regClass:Wc,property:Yc}=Laya,wi=class extends Ua{constructor(){super();this.text=""}get dataSource(){return super.dataSource}set dataSource(e){if(super.dataSource=e,!!e){if(e.avatar){let i=this.getChildByName("avatar").getChildByName("redHot");i.visible=e.avatar.redHot.visible}if(e.flag){let i=this.getChildByName("flag").getChildByName("flagText");i.text=e.flag.flagText.text}}}};u([Yc({type:"string"})],wi.prototype,"text",2),wi=u([Wc("c-3Sonu7RWOm5ETy2TrBcg")],wi);var Va=class extends Laya.Scene{};var pt=class{constructor(){this._keys=[];this.THIS_ID="id"}init(t){for(let e in t){this._keys.push(e);let i=t[e];t[e]instanceof String&&String(t[e]).indexOf("[[")>=0&&(i=JSON.parse(t[e])),this[e]=i}}checkItems(){}};var Ii=class extends pt{};var F=class{constructor(){this._values=[];this._keys=[];this.SERIALIZATION_NUM=new Date().getTime()}get values(){return this._values}get keys(){return this._keys}set(t,e){let i=this.indexOf(t);if(i>=0){this._values[i]=e;return}this._keys.push(t),this._values.push(e)}unshift(t,e){let i=this.indexOf(t);if(i>=0){this._values[i]=e;return}this._keys.unshift(t),this._values.unshift(e)}indexOf(t){let e=this._keys.indexOf(t);return e>=0?e:(t=t instanceof String?Number(t):t instanceof Number?t.toString():t,this._keys.indexOf(t))}get(t){let e=this.indexOf(t);return e<0?null:this._values[e]}remove(t){let e=this.indexOf(t);return e>=0?(this._keys.splice(e,1),this._values.splice(e,1),!0):!1}clear(){this._values.length=0,this._keys.length=0}};var Y=class Y{constructor(){}static get LoginType(){return Y._LoginType}static set LoginType(t){Y._LoginType=t,Y._LoginType&&Y._LoginType!=""&&Laya.LocalStorage.setItem(Y.COOKIE_CF_LoginType,Y._LoginType)}static get isWhiteList(){return!0}static get intance(){return Y._instance||(Y._instance=new Y),Y._instance}init(){}static get server(){return getServer()}static get requestTime(){return 0}static get loginTime(){return 0}static set m_iTimeFrame(t){if(t>1500){let e=function(){Y._m_iTimeFrame=0};Y._m_iTimeFrame=t,Laya.timer.clear(Laya.timer,e),Laya.timer.once(500,Laya.timer,e)}}static get m_iTimeFrame(){return Y._m_iTimeFrame}};Y.P_APP="app",Y.P_WEB_GW="gw",Y.P_WEB_FB="fb",Y.P_WEB_INSTANT="fbinstantgame",Y.PLATFORM=Y.P_APP,Y.IsRelease=!1,Y.m_bInstantGame=!1,Y.useWebVersion=!1,Y.m_strVersionEX="V003",Y.m_bIsMobWeb=!1,Y.m_strWebTag="",Y.Js_Version="1",Y.Game_Version="20231227_01",Y.App_Version="1.0.0",Y.SDK_Version="1.0.0",Y.M_strCountry="1",Y.M_bAppData=!1,Y.M_strTarget="",Y.UseGuide=!1,Y.m_mobileSameWb=!1,Y.ignoreLang=!1,Y.ignoreSheetNo=!1,Y.m_bIsIphoneX=!1,Y.Debug=0,Y.Res=0,Y.isTest=!0,Y.Server_URL="",Y.IP_User="",Y.Plantform_APPID="17",Y.ServerId=22310001,Y.Login_UID="-1",Y._LoginType="gamecenter",Y.Login_Token="96a3d1daf3b49735ed031c929c98d163",Y.Login_UDID="81BC19A8-B49B-47CC-BEFE-193E723B521A",Y.Device_Info="",Y.FCM_Token="",Y.APP_IsRelease=!0,Y.User_Lan="en",Y.UserAgent="",Y.Login_UserName="",Y.UserBanding=[],Y.APP_RES="",Y.COOKIE_CF_LAN="COOKIE_GG_LAN",Y.COOKIE_CF_LoginType="COOKIE_CF_LoginType",Y.IPHONEX_SCARE=1.22,Y.IPHONEX_TOP=44,Y.IPHONEX_BUTTOM=34,Y.DESIGN_WIDTH=1334,Y.DESIGN_HEIGHT=750,Y._m_iTimeFrame=0,Y.isStopPhysics=!1,Y.isDown=!1;var X=Y;var f=class s{constructor(){this._lanTypesById=new F,this._lanTypesByType=new F,this._configData=new F}static get instance(){return s._instance||(s._instance=new s),s._instance}initLanTypes(t){this._lanTypesById=new F,this._lanTypesByType=new F;for(let e in t){let i=new Ii;if(i.init(t[e]),parseInt(i.if_open)!=1)continue;let a=i.ID,n=i.type;this._lanTypesById.set(a,i),n&&n!=""&&this._lanTypesByType.set(n,i)}}getLanTypes(){return this._lanTypesById}getLanIdByType(t){if(this._lanTypesByType){let e=this._lanTypesByType.get(t);if(e)return parseInt(e.ID.toString())}return 1}getLanTypeById(t){if(this._lanTypesById){let e=this._lanTypesById.get(t);if(e)return e.type}return"en"}initConfigLan(t){this._configData=t}initUILan(t){Laya.Text.langPacks={};let e;for(e in t){let i=t[e].value;Laya.Text.langPacks[e]=i}}changeBrToN(t){let e=/<br>/g;for(;t.indexOf("<br>")!=-1;)t=t.replace(e,`
`);return t}replacePlaceholder(t,e){if(t=="")return"";let i=/{(\d+)}/g;return e.length>0&&(t=t.replace(i,function(){return e[arguments[1]]})),this.replaceLanByBR(t)}replaceLanByBR(t){return t+""}getLanguage(t,...e){return console.log("languageId: "+t),this.getLanguage2(t,e)}getLanguage2(t,e){if(this._configData&&this._configData[t]){let i=this._configData[t].value;if(i&&i!="")return this.replacePlaceholder(i,e)}return this.replacePlaceholder(t+"",e)}getUILang(t,e=null,i=null,a=null,n=null){if(t=Laya.Text.langPacks&&Laya.Text.langPacks[t]?Laya.Text.langPacks[t]:t,arguments.length>1)for(let r=0,o=arguments.length;r<o;r++)t=t.replace("{"+r+"}",arguments[r+1]);return t}FGM_GetLanguage(){let t=function(i){console.log("initGame->-----------------------------FGM_GetLanguage:=="+i),i&&(i=i.substring(0,2),X.User_Lan=i)},e=Laya.LocalStorage.getItem(X.COOKIE_CF_LAN);!e||e==""?t(this.language):t(e)}get language(){let t,e=Laya.Browser.window.navigator.appName;return e=="Netscape"?t=Laya.Browser.window.navigator.language:t=Laya.Browser.window.navigator.userLanguage,console.log("laya---------lang:"+t+"	type:"+e),t}FGM_SetLanguage(t){t&&t!=""&&Laya.LocalStorage.setItem(X.COOKIE_CF_LAN,t)}dispose(){}};var Qe=class extends pt{constructor(){super()}};var Je=class{constructor(t,e){this._valuesObject={};this.sheetObject=t,this.BaseItemClass=e}get keys(){if(this._keys)return this._keys;this._keys=[];let t;for(let e in this.sheetObject)!e||e==""||this._keys.push(e);return this._keys}get values(){if(this._values)return this._values;this._values=[];let t;for(let e in this.sheetObject)this._valuesObject[e]?t=this._valuesObject[e]:(t=new this.BaseItemClass,t.init(this.sheetObject[e]),this._valuesObject[e]=t),this._values.push(t);return this._values}get(t){if(this._valuesObject[t])return this._valuesObject[t];let e=this.sheetObject[t];if(e)return e;let i;this.BaseItemClass&&(i=new this.BaseItemClass,i.init==null&&console.log("ERROR :<BaseItem> SheetDataManager -->initConfig()  class : "+this.BaseItemClass),i.init(e)),this._valuesObject;let a=i||e;return this._valuesObject[t]=a,a}indexOf(t){let e=this._keys.indexOf(t);return e>=0?e:(t=t instanceof String?Number(t):t instanceof Number?t.toString():t,this._keys.indexOf(t))}clear(){this.sheetObject=null}};var Ze=class s{constructor(){}static get instance(){return s._instance||(s._instance=new s),s._instance}initSpotCfgData(){if(this.spotDic==null){let t=R.instance.getResByURL("config/spot.json");this.spotDic=new Je(t.data,Qe)}}getSpotById(t){return this.initSpotCfgData(),this.spotDic.get(t)}get getSpotDic(){return this.initSpotCfgData(),this.spotDic}};var mt=class s{constructor(){}registerCommCallBack(t=null){Laya.LayaEnv.isConch}static get instance(){return s._instance||(s._instance=new s),s._instance}sendCustumEvent(t,e=null,i=null){let a;if(i?a=i:a=Ze.instance.getSpotById(t),!a||!a.Event)return;let n,r=new Object;r.id=a.ID,r.eventKey=a.Event,r.type=a.type,this.sendWebEvent(r)}sendWebEvent(t){}dispose(){}reload(){Laya.Browser.window.location.reload()}testEvnt(){}};var Ga=class{constructor(){this.effectMap=new F}loadEffect(t){this.urls=t;for(let e=0;e<this.urls.length;e++){let i=this.urls[e].hasOwnProperty("url")?this.urls[e].url:this.urls[e];i&&!R.instance.hasFormatEffectUrl(i)&&(this.urls[e]==""&&(this.urls[e]={}),this.urls[e].url=R.instance.getEffectUrl(i),this.urls[e].type=Laya.Loader.ATLAS)}Laya.loader.load(this.urls,Laya.Handler.create(this,this.loadAssets))}getEffectByUrl(t){return R.instance.hasFormatEffectUrl(t)||(t=R.instance.getEffectUrl(t)),this.effectMap.get(t)}copyEffectByUrl(t){R.instance.hasFormatEffectUrl(t)||(t=R.instance.getEffectUrl(t));let e=this.effectMap.get(t),i=new Laya.Animation;i.source=t,i.stop();let a=t+"_2";return this.urls.push(a),this.effectMap.set(a,i),i}loadAssets(){if(!this.effectMap)return;let t;for(let e=0;e<this.urls.length;e++)this.effectMap.get(this.urls[e].url)||(t=new Laya.Animation,t.loadAtlas(this.urls[e].url),t.interval=100,t.stop(),this.effectMap.set(this.urls[e].url,t));this.callBak&&this.callBak.run()}destory(){if(this.urls)for(let t=0;t<this.urls.length;t++)this.removeUrlEffect(this.urls[t]);this.effectMap&&this.effectMap.clear(),this.effectMap=null,this.callBak&&(this.callBak.clear(),this.callBak=null)}removeUrlEffect(t){if(t.hasOwnProperty("url")&&(t=t.url),this.effectMap){let e=this.effectMap.get(t)}if(this.effect){this.effect.destroy(),Laya.Loader.clearRes(t),this.effect=null,this.effectMap.remove(t),t=Laya.URL.formatURL(t);let e=Laya.Loader.loadedMap[t];e&&(console.log("clear Res: "+t),e instanceof Laya.Texture&&e.bitmap&&new Laya.Texture(e).destroy(!0),delete Laya.Loader.loadedMap[t])}}};var B=class s{constructor(){this._isLoading=!1;this.AniConfPath="effect/load/load0.json"}static get instance(){return s._instance||(s._instance=new s),s._instance}get isLoading(){return this._isLoading}init(){this.effectManager==null&&(this.effectManager=new Ga),this.loadingMc||this.loadAsset()}loadBgImg(){Laya.loader.load([R.instance.getGuangImg("guang")],Laya.Handler.create(this,this.loadImgAssets))}loadImgAssets(){}loadAsset(){Laya.loader.load(this.AniConfPath,Laya.Loader.ATLAS).then(()=>{this.createAnimation()})}createAnimation(t=null){this.loadingMc=new Laya.Animation,this.loadingMc.loadAtlas(this.AniConfPath),this.loadingMc.interval=30,this.loadingMc.index=1,this.loadingMc.play();var e=this.loadingMc.getGraphicBounds();this.loadingMc.pivot(e.width/2,e.height/2),this.loadingMc.pos(Laya.stage.width/2,Laya.stage.height/2),this.loadingMc.stop()}showLoading(t=!1){if(console.log("showLoading..."),this.loadingMc)t?(this._isLoading=!0,this.showMaskLoading(),this.showLazyLoading(),this._isLoading=!1):(this._isLoading=!0,this.showMaskLoading(),Laya.timer.once(3e3,this,this.showLazyLoading)),this.m_txtLabel&&(this.m_txtLabel.visible=!1);else return}showLoadingByInfo(t=""){if(this.loadingMc)this.showMaskLoading(),this.showLazyLoading(),this.m_txtLabel||(this.m_txtLabel=new Laya.Label),this.m_txtLabel.fontSize=18,this.m_txtLabel.color="#ffffff",this.m_txtLabel.strokeColor="#000000",this.m_txtLabel.stroke=2,this.m_txtLabel.width=150,this.m_txtLabel.y=(Laya.stage.height-this.m_txtLabel.height>>1)+100,Laya.stage.addChild(this.m_txtLabel);else return;this.m_txtLabel.text=t;let e;this.m_txtLabel.textField&&(e=this.m_txtLabel.textField.textWidth),this.m_txtLabel.x=Laya.stage.width-e>>1,this.m_txtLabel.visible=!0}playBg(){this.bgImg&&(this.bgImg.parent?this.bgImg.visible=!0:(Laya.stage.addChild(this.bgImg),this.bgImg.x=Laya.stage.width/2,this.bgImg.y=Laya.stage.height/2),Laya.timer.loop(100,this,this.loopFrame))}stopBg(){this.bgImg&&(this.bgImg.visible=!1,this.bgImg.rotation=0,Laya.timer.clear(this,this.loopFrame))}loopFrame(){this.bgImg.rotation+=3}showMaskLoading(){this._isLoading&&(this._backLayer||(this._backLayer=new Laya.Sprite,this._backLayer.mouseEnabled=!0,this._backLayer.alpha=0,this._backLayer.visible=!1,Laya.stage.addChild(this._backLayer)),this._backLayer.graphics.clear(),this._backLayer.graphics.drawRect(0,0,Laya.stage.width+200,Laya.stage.height,"#000000"),this._backLayer.width=Laya.stage.width,this._backLayer.height=Laya.stage.height,this._backLayer.x=Math.round(Laya.stage.width-this._backLayer.width>>1),this._backLayer.y=Math.round(Laya.stage.height-this._backLayer.height>>1),this._backLayer.visible=!0)}showLazyLoading(){this._isLoading&&(Laya.stage.addChild(this.loadingMc),this._backLayer.alpha=.24,this.loadingMc.x=Laya.stage.width/2,this.loadingMc.y=Laya.stage.height/2,this.loadingMc.play(),this.loadingMc.visible=!0,this.playBg()),Laya.timer.clear(this,this.showLazyLoading)}hideLoading(){if(console.log("hideLoading..."),this._isLoading=!1,this.loadingMc)this.loadingMc.stop(),this.loadingMc.visible=!1,this._backLayer&&(this._backLayer.visible=!1),this.m_txtLabel&&(this.m_txtLabel.visible=!1);else return;this.stopBg()}dispose(){this.loadingMc&&(this.loadingMc.destroy(),this.loadingMc.removeSelf(),this.loadingMc=null),this._backLayer&&(this._backLayer.destroy(),this._backLayer.removeSelf(),this._backLayer=null)}};var P=class P{constructor(){this._touchEnabled=!0;if(P._instance)throw new Error("LayerManager是单例,不可new.");P._instance=this}get m_sprPanelLayer(){return this._m_sprPanelLayer}set m_sprPanelLayer(t){this._m_sprPanelLayer=t}get m_sprMainUILayer(){return this._m_sprMainUILayer}set m_sprMainUILayer(t){this._m_sprMainUILayer=t}get m_sprTipLayer(){return this._m_sprTipLayer}set m_sprTipLayer(t){this._m_sprTipLayer=t}static get instence(){return P._instance||(P._instance=new P),P._instance}init(){this.m_sprSceneLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprSceneLayer),this.m_sprMainUILayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprMainUILayer),this.m_sprPanelLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprPanelLayer),this.m_sprPopLayer=new Laya.Sprite,this.m_sprPopLayer.mouseThrough=!0,Laya.stage.addChild(this.m_sprPopLayer),this.m_sprTipLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprTipLayer),this.m_sprGuideLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprGuideLayer),this.m_sprTopLayer=new Laya.Sprite,Laya.stage.addChild(this.m_sprTopLayer)}get touchEnabled(){return this._touchEnabled}set touchEnabled(t){this._touchEnabled!=t&&(this._touchEnabled=t,this.m_sprSceneLayer.mouseEnabled=this._touchEnabled,this.m_sprMainUILayer.mouseEnabled=this._touchEnabled,this.m_sprPanelLayer.mouseEnabled=this._touchEnabled,this.m_sprPopLayer.mouseEnabled=this._touchEnabled,this.m_sprTipLayer.mouseEnabled=this._touchEnabled,this.m_sprGuideLayer.mouseEnabled=this._touchEnabled,this.m_sprTopLayer.mouseEnabled=this._touchEnabled)}addToLayerAndSet(t,e=P.M_PANEL,i=P.CENTER){this.addToLayer(t,e),this.setPosition(t,i)}getLayerIndex(t,e=P.M_PANEL){let i;switch(e){case P.M_SCENE:i=this.m_sprSceneLayer.getChildIndex(t);break;case P.M_MAINUI:i=this.m_sprMainUILayer.getChildIndex(t);break;case P.M_PANEL:i=this.m_sprPanelLayer.getChildIndex(t);break;case P.M_POP:i=this.m_sprPopLayer.getChildIndex(t);break;case P.M_TIP:i=this.m_sprTipLayer.getChildIndex(t);break;case P.M_GUIDE:i=this.m_sprGuideLayer.getChildIndex(t);break;case P.M_TOP:i=this.m_sprTopLayer.getChildIndex(t);break}return i}addToLayerAt(t,e=P.M_PANEL,i=0){switch(e){case P.M_SCENE:this.m_sprSceneLayer.addChildAt(t,i);break;case P.M_MAINUI:this.m_sprMainUILayer.addChildAt(t,i);break;case P.M_PANEL:this.m_sprPanelLayer.addChildAt(t,i);break;case P.M_POP:this.m_sprPopLayer.addChildAt(t,i);break;case P.M_TIP:this.m_sprTipLayer.addChildAt(t,i);break;case P.M_GUIDE:this.m_sprGuideLayer.addChildAt(t,i);break;case P.M_TOP:this.m_sprTopLayer.addChildAt(t,i);break}}addToLayer(t,e=P.M_PANEL){switch(e){case P.M_SCENE:this.m_sprSceneLayer.addChild(t);break;case P.M_MAINUI:this.m_sprMainUILayer.addChild(t);break;case P.M_PANEL:this.m_sprPanelLayer.addChild(t);break;case P.M_POP:this.m_sprPopLayer.addChild(t);break;case P.M_TIP:this.m_sprTipLayer.addChild(t);break;case P.M_GUIDE:this.m_sprGuideLayer.addChild(t);break;case P.M_TOP:this.m_sprTopLayer.addChild(t);break}}removeFromLayer(t,e){switch(e){case P.M_SCENE:this.m_sprSceneLayer.removeChild(t);break;case P.M_MAINUI:this.m_sprMainUILayer.removeChild(t);break;case P.M_PANEL:this.m_sprPanelLayer.removeChild(t);break;case P.M_POP:this.m_sprPopLayer.removeChild(t);break;case P.M_GUIDE:this.m_sprGuideLayer.removeChild(t);break;case P.M_TOP:this.m_sprTopLayer.removeChild(t);break}}clearLayer(t){switch(t){case P.M_SCENE:this.m_sprSceneLayer.removeChildren();break;case P.M_MAINUI:this.m_sprSceneLayer.removeChildren();break;case P.M_PANEL:this.m_sprSceneLayer.removeChildren();break;case P.M_POP:this.m_sprSceneLayer.removeChildren();break;case P.M_TOP:this.m_sprSceneLayer.removeChildren();break}}get stageWidth(){let t;return t=Laya.stage.width,t}get stageHeight(){let t;return t=Laya.stage.height,t}setPosition(t,e,i=0,a=0,n=!1,r=!1){let o=Laya.stage.width,l=Laya.stage.height;switch(this.m_iStageWidth=o,this.m_iStageHeight=l,e){case P.UP:t.x=n?o/2:(o-t.width*t.scaleX)/2,t.y=0;break;case P.DOWN:t.x=n?o/2:(o-t.width*t.scaleX)/2,t.y=l-t.height*t.scaleY;break;case P.LEFT:t.x=0,t.y=r?l/2:(l-t.height*t.scaleY)/2;break;case P.RIGHT:t.x=o-t.width*t.scaleX,t.y=r?l/2:(l-t.height*t.scaleY)/2;break;case P.LEFTUP:t.x=0,t.y=0;break;case P.RIGHTUP:t.x=o-t.width*t.scaleX,t.y=0;break;case P.LEFTDOWN:t.x=0,t.y=l-t.height*t.scaleY;break;case P.RIGHTDOWN:t.x=o-t.width*t.scaleX,t.y=l-t.height*t.scaleY;break;case P.CENTERLEFT:t.x=o/2-t.width*t.scaleX,t.y=r?l/2:(l-t.height*t.scaleY)/2;break;case P.CENTERRIGHT:t.x=o/2,t.y=r?l/2:(l-t.height*t.scaleY)/2;break;case P.CENTER:t.x=n?o/2:(o-t.width*t.scaleX)/2,t.y=r?l/2:(l-t.height*t.scaleY)/2;break;default:break}t.x+=i,t.y+=a}setLayer(t,e,i){if(!t||!e||t.parent!=e.parent)return;let a=t.parent.getChildIndex(t),n=e.parent.getChildIndex(e);i?a>n&&(t.parent.setChildIndex(t,n),t.parent.setChildIndex(e,a)):a<n&&(t.parent.setChildIndex(t,n),t.parent.setChildIndex(e,a))}};P.M_SCENE=1,P.M_MAINUI=2,P.M_PANEL=3,P.M_POP=4,P.M_TIP=5,P.M_GUIDE=7,P.M_TOP=6,P.UP=1,P.DOWN=16,P.LEFT=256,P.RIGHT=4096,P.CENTER=65536,P.LEFTUP=P.LEFT|P.UP,P.RIGHTUP=P.RIGHT|P.UP,P.LEFTDOWN=P.LEFT|P.DOWN,P.RIGHTDOWN=P.RIGHT|P.DOWN,P.CENTERLEFT=P.CENTER|P.LEFT,P.CENTERRIGHT=P.CENTER|P.RIGHT,P.MOVE=-1;var x=P;var rt=class rt{constructor(){this._m_bPlayMusic=!0;this._m_bPlayeSound=!0}static get instance(){return rt._instance||(rt._instance=new rt),rt._instance}get m_bPlayMusic(){return this._m_bPlayMusic}set m_bPlayMusic(t){this._m_bPlayMusic=t,t?this.m_strMusicURL!=null&&this.playMusicByURL(this.m_strMusicURL):this.musicChannel&&this.musicChannel.stop()}init(){Laya.SoundManager.autoStopMusic=!1;let t=Laya.LocalStorage.getItem(rt.COOKIE_CF_MUSIC);t!=null&&t!=""&&(rt.instance.m_bPlayMusic=parseInt(t)==1);let e=Laya.LocalStorage.getItem(rt.COOKIE_CF_SOUND);e!=null&&e!=""&&(rt.instance.m_bPlayeSound=parseInt(e)==1)}get m_bPlayeSound(){return this._m_bPlayeSound}set m_bPlayeSound(t){this._m_bPlayeSound=t}playMusicByURL(t){this.m_bPlayMusic&&(this.m_strMusicURL,this.m_strMusicURL==t&&this.musicChannel,this.m_strMusicURL=t,Laya.SoundManager.stopMusic(),this.musicChannel=Laya.SoundManager.playMusic(t,0,new Laya.Handler(this,this.onComplete)))}playMusicByName(t,e=".ogg"){let i=R.instance.getSoundURL(t,e);this.playMusicByURL(i)}playSound(t,e=1){this.m_bPlayeSound&&Laya.SoundManager.playSound(t,e,new Laya.Handler(this,this.onComplete))}playSoundByName(t,e=1){let i=R.instance.getSoundURLogg(t);this.playSound(i,e)}stopSoundByName(t){let e=R.instance.getSoundURLogg(t);Laya.SoundManager.stopSound(e)}switchMusic(t){let e=t?1:0;rt.instance.m_bPlayMusic=t,Laya.LocalStorage.setItem(rt.COOKIE_CF_MUSIC,e.toString())}switchSound(t){let e=t?1:0;rt.instance.m_bPlayeSound=t,Laya.LocalStorage.setItem(rt.COOKIE_CF_SOUND,e.toString())}onComplete(){}};rt.COOKIE_CF_MUSIC="COOKIE_CF_MUSIC",rt.COOKIE_CF_SOUND="COOKIE_CF_SOUND",rt.soundName_bg="bgm",rt.soundName1="ui01.ogg",rt.soundName2="ui02.ogg",rt.soundName3="ui03.ogg",rt.soundName4="hit.wav",rt.soundName30_1="ui30_1.ogg",rt.soundName28_1_star="ui28_1_star.ogg",rt.soundName28_2_star="ui28_2_stars.ogg",rt.soundName28_3_star="ui28_3_stars.ogg",rt.soundName28_bar="ui28_bar_rise.ogg",rt.soundName32="ui32.ogg",rt.soundName33="ui33.ogg",rt.soundName34="ui34.ogg",rt.soundName35="ui35.ogg",rt.soundName36="ui36.ogg",rt.soundName37="ui37.ogg",rt.soundName38="ui38.ogg",rt.soundName39="ui39.ogg",rt.soundName41="ui41.ogg",rt.soundName42="ui42.ogg",rt.soundName43="ui43.ogg",rt.soundName44="ui44.ogg",rt.soundName45="ui45.ogg",rt.soundNameUi40_1="ui40_1.ogg",rt.soundNameUi40_2="ui40_2.ogg",rt.soundNameUi40_3="ui40_3.ogg",rt.soundNameDressing="dressing_score_sfx.ogg",rt.soundNameAnswer="answer_bonus_points.ogg";var bt=rt;var p=class{};p.FindView="FindView",p.FindEndView="FindEndView",p.FindAskDialog="FindAskDialog",p.FindRankUpDialog="FindRankUpDialog",p.QuickTipDialog="QuickTipDialog",p.QuickEndView="QuickEndView",p.QuickShareView="QuickShareView",p.QuickOperatorDialog="QuickOperatorDialog",p.MainView="MainView",p.RoleDialog="RoleDialog",p.QuickRechargeDialog="QuickRechargeDialog",p.CreateNameDialog="CreateNameDialog",p.DailyTaskDialog="DailyTaskDialog",p.ActivityTaskDialog="ActivityTaskDialog",p.ShareDialog="ShareDialog",p.InvitationCenterDialog="InvitationCenterDialog",p.DailyTaskDrawDialog="DailyTaskDrawDialog",p.GuideView="GuideView",p.GuideDialogView="GuideDialogView",p.ShareView="ShareView",p.MainTopView="MainTopView",p.GetMoreDialog="GetMoreDialog",p.ShopView="ShopView",p.ItemGetDialog="ItemGetDialog",p.GetTitleDialog="GetTitleDialog",p.NewFunUnLockDialog="NewFunUnLockDialog",p.DialogView="DialogView",p.MallView="MallView",p.MallCardView="MallCardView",p.MallBuyDialog="MallBuyDialog",p.FittingUiView="FittingUiView",p.TaskDialog="TaskDialog",p.CommentDialog="CommentDialog",p.PotraitChangDialog="PotraitChangDialog",p.ClothespressView="ClothespressView",p.ItemSellDialog="ItemSellDialog",p.ItemInfoDialog="ItemInfoDialog",p.OnlineAward="OnlineAward",p.MaillView="MailView",p.MailSendView="MailSendView",p.GameSettingDialog="GameSettingDialog",p.GamesettingSoundView="GamesettingSoundView",p.GameSettingLanguageDialog="GameSettingLanguageDialog",p.GameSettingVersionDialog="GameSettingVersionDialog",p.FriendMainView="FriendMainView",p.FriendSearchView="FriendSearchView",p.FriendGetRewardDialog="FriendGetRewardDialog",p.FriendRewardDialog="FriendRewardDialog",p.PreLoadingView="PreLoadingView",p.HelpDialog="HelpDialog",p.RechargeDialog="RechargeDialog",p.FirstRechargeDialog="FirstRechargeDialog",p.FirstWeekRechargeView="FirstWeekRechargeView",p.ClientErrView="ClientErrView",p.RoleUpgradeView="RoleUpgradeView",p.ActiveRechargeView="ActiveRechargeView",p.SmallSaleView="SmallSaleView",p.RechargeSelectDialog="RechargeSelectDialog",p.FBLikeView="FBLikeView",p.TurnSuitPreView="TurnSuitPreView",p.SlotMachineView="SlotMachineView",p.SlotMachineRewardPreDialog="SlotMachineRewardPreDialog",p.SlotMachineResultDialog="SlotMachineResultDialog",p.GashaponView="GashaponView",p.GashaponRewardView="GashaponRewardView",p.ActivityRankRewardView="ActivityRankRewardView",p.AddRechargeView="AddRechargeView",p.CupMatchStartDialog="CupMatchStartDialog",p.CupMatchEndDialog="CupMatchEndDialog",p.CreateLoginView="CreateLoginView",p.SelectHeadDialog="SelectHeadDialog",p.RoleInfoDialog="RoleInfoDialog",p.SelectHeroDialog="SelectHeroDialog",p.FriendMemberDialog="FriendMemberDialog",p.FriendMemberMoreDialog="FriendMemberMoreDialog",p.FriendAddDialog="FriendAddDialog",p.FriendApplyBackDialog="FriendApplyBackDialog",p.FriendApplyDialog="FriendApplyDialog",p.WalletDialog="WalletDialog",p.WalletTransferDialog="WalletTransferDialog",p.UnionApplyDialog="UnionApplyDialog",p.GuildEntranceView="GuildEntranceView",p.UnionApplyDialogView="UnionApplyDialogView",p.UnionApplyMemberDialog="UnionApplyMemberDialog",p.CreateNoticeDialog="CreateNoticeDialog",p.UnionNoticeView="UnionNoticeView",p.GuildInfoDialog="GuildInfoDialog",p.CreateUnionDialog="CreateUnionDialog",p.UnionInfoView="UnionInfoView",p.UnionEarningView="UnionEarningView",p.UnionRevenueDetailDialog="UnionRevenueDetailDialog",p.UnionSetRevenueDialog="UnionSetRevenueDialog",p.UnionBattleRecordDialog="UnionBattleRecordDialog",p.UnionRevenueRecordDialog="UnionRevenueRecordDialog",p.RankUnionView="RankUnionView",p.UnionWarView="UnionWarView",p.UnionWarTipDialog="UnionWarTipDialog",p.UnionWarSuccessDialog="UnionWarSuccessDialog",p.UnionWarFailDialog="UnionWarFailDialog",p.GamesettingView="GamesettingView",p.GameSettingGameAccountView="GameSettingGameAccountView",p.GuildMessageView="GuildMessageView",p.GuildMessageEditorView="GuildMessageEditorView",p.UnionMemberView="UnionMemberView",p.SelectUnionHeadDialog="SelectUnionHeadDialog",p.GuildBuildInfoView="GuildBuildInfoView",p.GuildChiefPrivilegeView="GuildChiefPrivilegeView",p.GuildDonationView="GuildDonationView",p.DigView="DigView",p.DigTipDialog="DigTipDialog",p.LuckdrawView="LuckdrawView",p.LoadDialog="LoadDialog",p.ChangeHeadDialog="ChangeHeadDialog",p.CreateRoomDialog="CreateRoomDialog",p.EnterRoomView="EnterRoomView",p.MatchEndRankView="MatchEndRankView",p.MatchReadyView="MatchReadyView",p.MatchEndView="MatchEndView",p.HeroGetDialog="HeroGetDialog",p.InputPwdDialog="InputPwdDialog",p.MailDialog="MailDialog",p.UnionAttrView="UnionAttrView",p.UnionAttrLvUpDialog="UnionAttrLvUpDialog",p.UnionAttributeDetailsDialog="UnionAttributeDetailsDialog",p.NoServerView="NoServerView",p.UnionMemberMoreDialog="UnionMemberMoreDialog",p.HeroUpgradeDialog="HeroUpgradeDialog",p.HeroDetailDialog="HeroDetailDialog",p.SkillTipDialog="SkillTipDialog",p.AFKView="AFKView",p.AFKBagDialog="AFKBagDialog",p.AFKDropDetailDialog="AFKDropDetailDialog",p.AFKMapView="AFKMapView",p.AFKSelectLevelDialog="AFKSelectLevelDialog",p.Knapsack="Knapsack",p.KnapsackTipDialog="KnapsackTipDialog",p.HeroFormationDialog="HeroFormationDialog",p.SignInDialog="SignInDialog",p.InviteRewardDialog="InviteRewardDialog",p.ChallengLoseDialog="ChallengLoseDialog",p.ChallengWinDialog="ChallengWinDialog",p.ChallengBossDialog="ChallengBossDialog",p.ThirbleDropDialog="ThirbleDropDialog",p.LevelDropDialog="LevelDropDialog",p.UseCardDialog="UseCardDialog",p.ArenaView="ArenaView",p.ArenaLoseDialog="ArenaLoseDialog",p.ArenaBattleDialog="ArenaBattleDialog",p.ArenaWinDialog="ArenaWinDialog",p.ArenaWarNotesView="ArenaWarNotesView",p.ArenaRuleDialog="ArenaRuleDialog",p.EquipSelectDialog="EquipSelectDialog",p.EquipDetailDialog="EquipDetailDialog";var b=class{};b.MOUSE_HOLDON="MOUSE_HOLDON",b.EVENT_OPEN_MODULE="EVENT_OPEN_MODULE",b.EVENT_MODULE_ADDED="EVENT_MODULE_ADDED",b.EVENT_CLOSE_MODULE="EVENT_CLOSE_MODULE",b.EVENT_CHECK_REMAIN="EVENT_CHECK_REMAIN",b.EVENT_LOADED_COMPLETE="EVENT_LOAD_COMPLETE",b.EVENT_LOADED_SCENE_BG_COM="EVENT_LOADED_SCENE_BG_COM",b.EVENT_LOAD_SKIN_COMPLETE="EVENT_LOAD_SKIN_COMPLETE",b.EVENT_LOAD_HEAD_SKIN_COMPLETE="EVENT_LOAD_HEAD_SKIN_COMPLETE",b.EVENT_LOADING_SUC="EVENT_LOADING_SUC",b.EVENT_BACK_TO_LOGIN="EVENT_BACK_TO_LOGIN",b.EVENT_LOGIN_GAME_END="EVENT_LOGIN_GAME_END",b.EVENT_ENTER_MAIN="EVENT_ENTER_MAIN",b.EVENT_CHANGE_HEAD="EVENT_CHANGE_HEAD",b.EVENT_MODIFY_HEAD="EVENT_MODIFY_HEAD",b.EVENT_ITEM_UPDATE="EVENT_ITEM_UPDATE",b.EVENT_ROLE_UPDATE="EVENT_ROLE_UPDATE",b.STAGE_ON_BLUR="STAGE_ON_BLUR",b.STAGE_ON_FOCUS="STAGE_ON_FOCUS",b.ACCOUNTVO_UPDATE="ACCOUNTVO_UPDATE",b.EVENT_CHECK_ICON_SELECT="EVENT_CHECK_ICON_SELECT",b.PACKAGE_UPDATE_ITEM="PACKAGE_UPDATE_ITEM",b.IMPROVE_SUCESS_EVENT="IMPROVE_SUCESS_EVENT",b.CHANG_POTRAIT="CHANG_POTRAIT",b.ROLE_INFO_CHANGE="ROLE_INFO_CHANGE",b.UPDATE_ASSETS="UPDATE_ASSETS",b.REFRESH_MAIN_TASK="REFRESH_MAIN_TASK",b.RECIVE_SUCESS_SERVICE="RECIVE_SUCESS_SERVICE",b.SCENE_ROLE_COMPELTE="SCENE_ROLE_COMPELTE",b.FITTING_CLOTH_BTN="FITTING_CLOTH_BTN",b.STORE_CLICKBG_EVENT="STORE_CLICKBG_EVENT",b.CLOSE_BG_VIEW="CLOSE_BG_VIEW",b.EVENT_UPDATE_ONLINE="EVENT_UPDATE_ONLINE",b.VIP_INFO_CHANGE="VIP_INFO_CHANGE",b.EVENT_FUNCTION_OPEN_UPDATE="EVENT_FUNCTION_OPEN_UPDATE",b.EVENT_ADD_ACTIVITY="EVENT_ADD_ACTIVITY",b.EVENT_REMOVE_ACTIVITY="EVENT_REMOVE_ACTIVITY",b.UPDATE_CHAO_PIAO="UPDATE_CHAO_PIAO",b.UPDATE_EXCHANGE_INFO="UPDATE_EXCHANGE_INFO",b.UPDATE_RED_STATE_EVENT="UPDATE_RED_STATE_EVENT",b.SYSTEM_OPEN_TIME_INITED="SYSTEM_OPEN_TIME_INITED",b.EVENT_OPEN_SHARE="EVENT_OPEN_SHARE",b.CHANGE_SCENE_BASE_ROLE_LAYER="CHANGE_SCENE_BASE_ROLE_LAYER",b.EVENT_CLICK_NUM="EVENT_CLICK_NUM",b.EVENT_HERO_DRAW_BACK="EVENT_HERO_DRAW_BACK",b.EVENT_ENTER_MATCH_ROOM="EVENT_ENTER_MATCH_ROOM",b.UPDATE_KILL_NUM="UPDATE_KILL_NUM",b.EVENT_RESTORE_DATA="EVENT_RESTORE_DATA",b.EVENT_FirstBlood="EVENT_FirstBlood",b.EVENT_MutiKill="EVENT_MutiKill",b.EVENT_GameScene_Gray="EVENT_GameScene_Gray",b.EVENT_UPDATE_GLOBAL_COOL="EVENT_UPDATE_GLOBAL_COOL";var d=class s extends Laya.EventDispatcher{static get intance(){return s._instance||(s._instance=new s),s._instance}};var Yt=class extends Laya.Script{constructor(){super();this.m_ioffsetX=0;this.m_ioffsetY=0}onAdded(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.CENTER,this.m_canTouch_all=!1,this.selfMaskAlpha=.8,this.m_arrMapEvent=[],this.canClickMask=!0,this.maskLayer=new Laya.Sprite,this.useShowAnimation=!0,this.useHideAnimation=!0,this.isAutoRealseRes=!0,this.m_strSound=bt.soundName3}onClickMask(e){this.canClickMask&&this.maskClose()}maskClose(){this.close()}onStageResize(){}onEnable(){this._view=this.owner,this._view.addChild(this.maskLayer),this.createUI(),this.createUIEnd(),this.initializeLater()}createUI(){}createUIEnd(){}initializeLater(){this._addEvent(),this.initData(),this.useShowAnimation?(this._view.visible=!1,this.showAnimationEnd=!1,Laya.timer.frameOnce(5,this,this.popTimeOut,[this._view])):this.showAnimationEnd=!0}popTimeOut(e){Laya.timer.clear(this,this.popTimeOut),e.scale(.5,.5),e.visible=!0,Laya.Tween.to(e,{scaleX:1,scaleY:1,ease:Laya.Ease.backOut},300,null,Laya.Handler.create(this,this.onShowAnimationEnd),2),bt.instance.playSoundByName(this.m_strSound),this._view.event(Laya.Event.OPEN)}onShowAnimationEnd(){this.showAnimationEnd=!0}_addEvent(){this.maskLayer.on(Laya.Event.CLICK,this,this.onClickMask),Laya.stage.on(Laya.Event.RESIZE,this,this.onStageResize),this.btn_com_back&&this.btn_com_back.on(Laya.Event.CLICK,this,this.onBack),this.btn_com_help&&this.btn_com_help.on(Laya.Event.CLICK,this,this.onHelp),this.addEvent()}addEvent(){}initData(){}_removeEvent(){this.maskLayer.offAll(),Laya.stage.off(Laya.Event.RESIZE,this,this.onStageResize),this.removeEvent()}removeEvent(){}addMapEvent(e,i,a,n,r=null){e.on(i,a,n,r),this.m_arrMapEvent.push(e)}removeAllMapEvent(){if(this.m_arrMapEvent){for(let e=0;e<this.m_arrMapEvent.length;e++)this.m_arrMapEvent[e].offAll();this.m_arrMapEvent.splice(0,this.m_arrMapEvent.length)}}dispose(){if(this.newRoleSpr){for(;this.newRoleSpr.numChildren>0;)this.newRoleSpr.removeChildAt(0);this.newRoleSpr=null}this.isDispose=!0,V.intance.removeViewFromModuleManger(this),this.m_strName=null,this.m_strSound=null,this._removeEvent(),this.removeAllMapEvent(),Laya.Tween.clearAll(this._view),this.m_arrMapEvent=null,this.btn_com_back&&this.btn_com_back.offAll(),this.btn_com_help&&this.btn_com_help.offAll(),this.maskLayer&&(Laya.timer.clearAll(this.maskLayer),Laya.Tween.clearAll(this.maskLayer),this.maskLayer.offAll(),this.maskLayer.graphics.destroy(),this.maskLayer.removeSelf(),this.maskLayer.destroy(!0)),this.isAutoRealseRes&&R.instance.clearModuleUrl(this.m_strName),this._view&&(Laya.timer.clearAll(this._view),Laya.Tween.clearAll(this._view),this._view.offAll(),this._view.graphics.destroy(),this._view.removeSelf(),this._view.destroy(!0),this._view=null),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),d.intance.event(b.EVENT_CLOSE_MODULE)}sendData(e,i=null){i==null&&(i=[])}close(e=null){this.useHideAnimation&&this._view?Laya.Tween.to(this._view,{scaleX:.5,scaleY:.5,ease:Laya.Ease.backIn},200,null,Laya.Handler.create(this,this.dispose,null),2):this.dispose()}static closeAll(){V.intance.closeAll()}backToPreScene(){let e=ot.intance.getPreSceneData();ot.intance.setCurrentScene(e[0],e[1],e[2],e[3],!1)}get btn_com_back(){return this._view?this._view.getChildByName("btn_com_back"):null}get btn_com_help(){return this._view?this._view.getChildByName("btn_com_help"):null}onHelp(){this.m_helpId&&V.intance.openModule(p.HelpDialog,this.m_helpId)}onBack(){this.close()}};var V=class s extends Laya.DialogManager{constructor(){super();this.views=new F;this.m_arrLoadingArr=[];if(s._instance)throw new Error("LayerManager是单例,不可new.");s._instance=this,Laya.Dialog.manager=this}static get intance(){return s._instance||(s._instance=new s),s._instance}openModule(e,i=null){d.intance.event(b.EVENT_OPEN_MODULE,[e,i])}hasOpenView(e){return this.views.get(e)!=null}getOpenView(e){return this.views.get(e)}disposeView(e){if(this.getOpenView(e)){let i=this.getOpenView(e);if(i instanceof Array)for(let a=0;a<i.length;a++)i[a].close();else i.close()}}init(){d.intance.on(b.EVENT_OPEN_MODULE,this,this.onModulePanel),d.intance.on(b.EVENT_CLOSE_MODULE,this,this.disposeView)}initMainView(){}onModulePanel(e,i=null){console.log("ModuleManager.onModulePanel moudleName:"+e),this.m_arrLoadingArr.indexOf(e)==-1&&(this.getOpenView(e)||(B.instance.showLoading(!1),this.m_arrLoadingArr.push(e),R.instance.loadModuleUrl(e,Laya.Handler.create(this,this.onLoaded,[e,i]))))}onLoaded(e,i=null){let a=this.m_arrLoadingArr.indexOf(e);a!=-1&&this.m_arrLoadingArr.splice(a,1);let n;var r=R.instance.m_objModuleViews[e];Laya.loader.load(r).then(o=>{if(n=o.create(),i&&n.setOpenData(i),n.m_strName=e,n instanceof Laya.Box)x.instence.addToLayer(n,n.m_iLayerType),x.instence.setPosition(n,n.m_iPositionType,n.m_ioffsetX,n.m_ioffsetY),this.addViewToModuleManger(n);else if(n instanceof Laya.Dialog){let l=n;l.m_iLayerType==x.M_POP?(l.isModal=!0,l.isShowEffect=!0,this.open(l,!1,!0)):(l.isShowEffect=!1,this.open(l)),this.addViewToModuleManger(l)}n&&d.intance.event(b.EVENT_MODULE_ADDED,n),n.hideLoadingBySelf||B.instance.hideLoading()})}addViewToModuleManger(e){let i=e.m_strName;this.views.get(i)?this.views.get(i)instanceof Array?this.views.get(i).push(e):this.views.set(i,[this.views.get(i),e]):this.views.set(i,e),this.on(Laya.Event.CLOSE,this,this.removeViewFromModuleManger)}removeViewFromModuleManger(e){if(!e||!this.views)return;let i=e.m_strName;console.log("removeViewFromModuleManger viewName: "+i),e.off(Laya.Event.CLOSE,this,this.removeViewFromModuleManger);let a=this.views.get(i);if(a instanceof Array){let n=a.indexOf(e);n!=-1&&(a.splice(n,1),a.length==0&&this.views.remove(i))}else this.views.remove(i)}closeAll(){let e=[];for(let i of this.views.values)if(i instanceof Array)for(let a=0;a<i.length;a++){let n=i[a];n instanceof Yt&&e.push(n)}else i instanceof Yt&&e.push(i);for(let i=0;i<e.length;i++)e[i].dispose();e=[],super.closeAll()}doClose(e){super.doClose(e),this.event(Laya.Event.CLOSE,e)}};var Si=class s{constructor(){this._mapUrl="";this._mapWidth=0;this._mapHeight=0;this._gridWidth=0;this._gridHeight=0;this._xPics=0;this._yPics=0;this._fuzzyName=""}static get instance(){return s._instance||(s._instance=new s),s._instance}loadScene(t,e,i,a,n,r,o){this._fuzzyName!=""&&this._fuzzyName!=r&&this.dispose(),this._mapWidth=t,this._mapHeight=e,this._gridWidth=i,this._gridHeight=a,this._fuzzySprite=n,this._xPics=Math.floor(this._mapWidth/i),this._yPics=Math.floor(this._mapHeight/a),this._fuzzyName=r,this._fuzzyCallBack=o;let l=R.instance.setResURL("scene/subScene/test1/"+r+".json");Laya.loader.load([{url:l,type:Laya.Loader.ATLAS}],Laya.Handler.create(this,this.loadSceneComplete),Laya.Handler.create(this,this.loadProcess,null,!1),null,0,!0,null,!0)}loadProcess(){}loadSceneComplete(){let t=Laya.Loader.getAtlas(R.instance.setResURL("scene/subScene/test1/"+this._fuzzyName+".json"));if(this._fuzzySprite){this._fuzzySprite.graphics.clear();let e=0,i=new Laya.Sprite;i.name="mapSprite",this._fuzzySprite.addChildAt(i,0);for(let a=0;a<this._yPics;a++)for(let n=0;n<this._xPics;n++){let r=Laya.loader.getRes(t[e]),o=new Laya.Image;i.addChild(o),o.texture=r,o.size(r.width,r.height),o.pos(n*this._gridWidth,a*this._gridHeight),e++}}this._fuzzyCallBack!=null&&this._fuzzyCallBack.run()}dispose(){this._fuzzyCallBack=null,this._fuzzyName&&this._fuzzyName!=""&&Laya.loader.clearRes(R.instance.setResURL("atlas/"+this._fuzzyName+".json"))}};var J=class{};J.M_SCENE_MAIN="M_SCENE_MAIN",J.M_SCENE_SHOP="M_SCENE_SHOP",J.M_SCENE_HERO="M_SCENE_HERO",J.M_SCENE_PRE_LOAD="M_SCENE_PRE_LOAD",J.M_SCENE_MATCH_READY="M_SCENE_MATCH_READY",J.M_SCENE_MATCH="M_SCENE_MATCH",J.M_SCENE_AFKBATTLE="M_SCENE_AFKBATTLE",J.M_SCENE_GUILD="M_SCENE_GUILD",J.M_SCENE_RANK="M_SCENE_RANK",J.M_SCENE_UNIONWAR="M_SCENE_UNIONWAR",J.M_SCENE_DIG="M_SCENE_DIG",J.M_SCENE_MAIL="M_SCENE_MAIL",J.M_SCENE_KNAPSACK="M_SCENE_KNAPSACK",J.M_SCENE_UNION="M_SCENE_UNION",J.M_SCENE_ARENA="M_SCENE_ARENA";var Pe=class Pe{constructor(){this._list=[];this._isNoticing=!1;this._isListener=!1}static get instance(){return Pe._instance||(Pe._instance=new Pe),Pe._instance}notice(t){this._isNoticing?this._isListener||(this._isListener=!0,this._list.push(t),Laya.timer.loop(Pe.Tip_Interval,this,this.onInterVal)):(this._list.push(t),this.noticeOne())}noticeOne(){var t=R.instance.m_objModuleViews.TxtNoticeView;let e;Laya.loader.load(t).then(i=>{if(!i){console.log("noticeOne : "+t+"  res is null");return}e=Laya.Pool.getItemByCreateFun("myPrefab",i.create,i);let a=this._list.shift();e.notice(a),Laya.stage.addChild(e),e.x=x.instence.stageWidth*.5-e.width*.5,e.y=x.instence.stageHeight*.5-e.height*.5,Laya.Tween.to(e,{y:e.y-50,alpha:0},2e3,null,Laya.Handler.create(this,this.onFinish,[e]))})}onFinish(t){t&&(t.visible=!1,t.removeSelf())}onInterVal(){this._list.length>=1?this.noticeOne():(this._isNoticing=!1,this._isListener=!1,Laya.timer.clear(this,this.onInterVal))}};Pe.Tip_Interval=1e3;var at=Pe;var vt=class s{constructor(){this._curErrTxt=""}static get instance(){return s._instance||(s._instance=new s),s._instance}initErrData(t){this.errData=t}get(t){return this.errData[t]?this.errData[t].words:(console.warn("服务端错误码语言包未配表 错误码："+t),t)}showErrorWord(t,e=999999){this.errData[t]&&this.errData[t].hasOwnProperty("words")?(this._curErrTxt=this.errData[t].words,e!=999999&&(this._curErrTxt=f.instance.replacePlaceholder(this._curErrTxt,[e]))):this._curErrTxt=""+t,at.instance.notice(this._curErrTxt)}showErrByString(t,e="#ff0000"){this._curErrTxt=t;let i=new Laya.Label(this._curErrTxt);i.width=500,i.align="center",i.height=40,i.fontSize=26,i.color=e,i.mouseEnabled=!1,i.strokeColor="#000000",i.stroke=.5,Laya.stage.addChild(i),i.x=(Laya.stage.width-i.width)/2,i.y=(Laya.stage.height-i.height)/2,Laya.Tween.to(i,{y:i.y-100,alpha:0},500,null,Laya.Handler.create(this,this.completeHandler,[i]),1e3)}completeHandler(t){t&&t.parent&&t.parent.removeChild(t)}dispose(){this.errData=null}};var yt=class{};yt.FUNID_MALL="1004",yt.FUN_ID_TAGGARDEN="2005",yt.FunID_WORK="1006",yt.FUN_ID_BARGAIN_SHOP="1007",yt.TRAVEL_HARD="1012",yt.TRAVEL_REWARD="3006",yt.FUNID_TUJIAN="2105",yt.FUN_ID_PARTY="7003",yt.FUN_ID_FB="9010",yt.FUN_ID_PET="9004",yt.FUN_ID_TURNTABLE="9001",yt.FUN_ID_GASHPOEN="9012",yt.FUN_ID_SHOPEXCHANGE="2104",yt.FUN_ID_TIME_STAGE="9014",yt.FUN_ID_DRAWCARD_PVP="1008613",yt.FUN_ID_PHONE="2004",yt.FUN_ID_DS="9017",yt.FUN_ID_BUY_PS="9030",yt.FUN_ID_DESTINY="3020",yt.FUN_ID_ACTIVITY_SHOP="9026",yt.FUN_ID_WORKSHOP_RECYCLE="3002",yt.FUN_ID_WORKSHOP_COLOR="3004",yt.FUN_ID_WORKSHOP_UPGRADE="3003",yt.FUN_ID_GUILD="1010",yt.FUN_ID_VIP="9022",yt.FUN_ID_MONTHCARD="9100";var Fa=class{constructor(){this.bafflesInfo=[[330,740,9],[294,113.95,1],[712.95-80,343.45,3],[1251.35,125.95,7]];this.redHotStateMap=new F;this.openSystem=new F;this.m_dicSystemInfoCfg=new F,this._openTypeList=new F,this.parseJson()}hasRedState(t){let e=this.redHotStateMap.get(t+"");return e&&e.redState>0?e.redState:0}initSystemOpen(t){this.openSystem=new F;for(let e=0;e<t.length;e++)this.openSystem.set(t[e],!0),t[e]+""==yt.FUN_ID_PHONE.toString()}parseJson(){let t=R.instance.getResByURL("config/system_open.json"),e;for(let i in t)if(e=t[i],e){this.m_dicSystemInfoCfg.set(e.functionID,e);let a=this._openTypeList.get(e.open_type);a||(a=[],this._openTypeList.set(e.open_type,a)),a.push(e)}}getSystemsByType(t){let e=[];for(let i=0;i<this.m_dicSystemInfoCfg.values.length;i++){let a=this.m_dicSystemInfoCfg.values[i];a.positionID==t&&e.push(a)}return e}getLockFun(t,e){let i=this._openTypeList.get(t);for(let a of i)if(a.parameter1+""==e+"")return a;return null}getBuildSystem(){}isOpen(t){return X.buildClickState?!0:(t instanceof String&&(t=parseInt(t+"")),this.openSystem.get(t)!=null)}};var Ka=class{constructor(){this._vipLv=0}isReceive(t){for(let e of this.isRewards)if(e+""==t.toString())return!0;return!1}addIsReceive(t){this.isReceive(t)||this.isRewards.push(t)}get vipLv(){return this._vipLv}set vipLv(t){this._vipLv!=t&&(this._vipLv=t)}};var jt=class{constructor(){this._color=1;this.isLvUp=!1;this.newAddCnt=0}get simgurl(){return R.instance.getHeroHeadRes(this.heroItem.serialId,this.color)}get sk(){return R.instance.getHeroSkRes(this.heroItem.serialId,this.color)}get id(){return this._id}set id(t){this._id=t,this.heroItem=j.intance.m_dicHeros.get(t+"")}get name(){return f.instance.getLanguage(this.heroItem.name)}set name(t){this._name=t}get color(){return this._color}set color(t){t&&(this._color=t)}get m_iNum(){return this._m_iNum}set m_iNum(t){this._m_iNum=t}};var ue=class s{constructor(t=0){this._m_iLevel=0;this._m_arrDisc=[];this.newAddCnt=0;this.isLvUp=!1;this.needTip=!0;this.m_bSalon=!1;this.m_bIsSetId=!1;t!=0&&(this.m_iId=t)}get m_sIcon(){return this._m_sIcon}set m_sIcon(t){this._m_sIcon=t}get m_iLevel(){return this._m_iLevel>0?this._m_iLevel:1}set m_iLevel(t){this._m_iLevel=t||0}get m_iNum(){return this._m_iNum}set m_iNum(t){this._m_iNum=t}copyItem(){let t=new s;return t.m_iId=this.m_iId,t.m_iOriginalId=this.m_iOriginalId,t}get m_bTry(){return this.m_iId==this.m_iOriginalId?this._m_bSet=!1:this._m_bSet=!0,this._m_bSet}get m_strName(){return f.instance.getLanguage(this.itemItem.name)}set m_bTry(t){this._m_bSet=t}get m_iId(){return this._m_iId}set m_iId(t){this._m_iId=t,this.m_bIsSetId||(this.m_bIsSetId=!0,this.m_iOriginalId=t),this.setConfigData()}initDataByArr(t){this.m_iId=t.id,this.m_iNum=t.count}setConfigData(){if(this.m_iId!=0){if(this.itemItem=j.intance.m_dicItems.get(this.m_iId.toString()),!this.itemItem){console.log("[          <items> find out id:"+this.m_iId+"             ]");return}if(this.subType=parseInt(this.itemItem.subType+""),this.type=parseInt(this.itemItem.type+""),this.m_sIcon=this.itemItem.icon,this.itemItem.buy_price){this.m_iPrice=this.itemItem.buy_price[0][1];let t=this.itemItem.buy_price[0][0],e=j.intance.m_dicItems.get(t);e&&(this.m_strBuyIcon=R.instance.getItemIcon(e.icon))}this.itemItem.sell_price&&(this.m_iSellPrice=parseFloat(this.itemItem.sell_price[0][1])),this.m_iQuality=this.itemItem.quality,this.setQualityData()}}setQualityData(){this.m_arrQualityData=this.itemItem.starArr}get getIconURL(){return R.instance.getItemIcon(this.itemItem.icon)}copy(){let t=new s(this.m_iId);return t.m_iLevel=this.m_iLevel,t}compareName(){return f.instance.getLanguage(this.itemItem.name)}compareQuality(){return parseFloat(this.m_iQuality+"")}compareSellPrice(){return parseFloat(this.itemItem.sell_price[1]+"")}compareNum(){return parseFloat(this.m_iNum+"")}compareLevel(){return parseFloat(this.m_iLevel+"")}compareFragment(){let t=this.itemItem.id;return 0}compareTypeId(){return parseInt(this.m_iId+"")}};var Zt=class s{constructor(){this._isPop=!1;d.intance.on(b.EVENT_CHECK_REMAIN,this,this.onCheckRemain)}static get instance(){return s._instance||(s._instance=new s),s._instance}get model(){return ft.instance}get isPop(){return this._isPop}startShow(){console.log("startShow");var t=this.model.hasRemain();!this._isPop&&t&&(this._isPop=!0,t instanceof jt?d.intance.event(b.EVENT_OPEN_MODULE,p.HeroGetDialog):d.intance.event(b.EVENT_OPEN_MODULE,p.ItemGetDialog))}onCheckRemain(t){if(t==p.ItemGetDialog||t==p.HeroGetDialog){var e=this.model.hasRemain();e?e instanceof jt?d.intance.event(b.EVENT_OPEN_MODULE,p.HeroGetDialog):d.intance.event(b.EVENT_OPEN_MODULE,p.ItemGetDialog):this._isPop=!1}}};var ft=class s{constructor(t){this._list=[];this.needPop=!0;this.autoPop=!0}static get instance(){return s._instance||(s._instance=new s(new wo)),s._instance}get service(){return Zt.instance}addItem(t,e=!1){let i=new ue;i.m_iId=t.m_iId,i.newAddCnt=t.newAddCnt,i.m_iLevel=t.m_iLevel,i.isLvUp=t.isLvUp,i.m_bNew=t.m_bNew,this._list.push(i),e&&this.service.startShow()}addHeroItem(t,e=!1){let i=new jt;i.id=t.id,i.newAddCnt=t.newAddCnt,i.lv=t.lv,i.isLvUp=t.isLvUp,i.m_bNew=t.m_bNew,this._list.push(i),e&&this.service.startShow()}addItems(t,e=!1){this._list=this._list.concat(t),e&&this.service.startShow()}hasRemain(){return this._list.length>0?this._list[0]:null}get needListener(){return this._list.length>=2}addConsumeByServer(t){this._list.push(t)}addConsume(t,e){this._list.push([t,e])}getNextItem(){return this._list.length>0?this._list[0]:null}getOneItem(){return this._list.length>0?this._list.shift():null}},wo=class{};var Et=class{};Et.TYPE_EXP=3003,Et.TYPE_GOLD=3005,Et.TYPE_TOX=3001,Et.TYPE_USDT=3004,Et.TYPE_BTC=3006,Et.TYPE_ETH=3007;var pe=class{constructor(){}};pe.Item_Type_Cloths=1,pe.Item_Type_Items=2,pe.Item_Type_Materials=3,pe.Item_Type_Designs=4,pe.Item_Type_FacialFeatures=5,pe.Item_Type_Fragment=6,pe.Item_Type_ModelOwner=7;var ct=class ct{static getIsPetType(t){return t.toString()==ct.PET.toString()||t.toString()==ct.PET_FOOD.toString()||t.toString()==ct.PET_THIRSTY.toString()||t.toString()==ct.PET_PLAY.toString()||t.toString()==ct.PET_Bracelet.toString()||t.toString()=="39"||t.toString()=="40"||t.toString()==ct.PET_NECKLACE.toString()}static getPetClothsChild(){return[ct.PET_Bracelet,ct.PET_NECKLACE]}static getVipOpenKeyName(t){let e="";return t.toString()==ct.EYE_ZHU.toString()?e="unlock_contact":t.toString()==ct.FACE_TYPE.toString()?e="unlock_faceshape":t.toString()==ct.Eyebrow.toString()?e="unlock_brows":t.toString()==ct.Eye.toString()?e="unlock_eyes":t.toString()==ct.Nose.toString()?e="unlock_nose":t.toString()==ct.Mouse.toString()&&(e="unlock_mouth"),e}};ct.Eye=18,ct.Nose=19,ct.Mouse=20,ct.Eyebrow=21,ct.SkinColor=26,ct.Hair=23,ct.FACE_TYPE=22,ct.EYE_ZHU=27,ct.MODEL=28,ct.SCENE_STORE_BG=29,ct.SCENE_HOME_BG=32,ct.PET=33,ct.PET_FOOD=34,ct.PET_THIRSTY=35,ct.PET_PLAY=36,ct.PET_Bracelet=37,ct.PET_NECKLACE=38,ct.FRAGRANCE=204,ct.COMBINE_SCORE=99,ct.MATERIAL=101,ct.STAR_FACE=9;var Rt=ct;var Ut=class{constructor(){this.m_dicItemList=new F,this.m_dicTypeList=new F,this.m_dicSubTypeList=new F}initData(t){this.m_dicItemList=new F,this.m_dicTypeList=new F,this.m_dicSubTypeList=new F;let e;for(let i=0;i<t.length;i++)e=new ue,e.initDataByArr(t[i]),this.pushItem(e);console.log("@@@@@@@@@@@@@@@@@@-----------------------------------------packVo: ")}updateData(t,e){console.dir("更新道具："+t),this.updataItemVoByArr(t,e)}getCountById(t,e=!0){return Et.isConsumeType(t)?S.instance.getConsumeValue(t):j.intance.m_dicItems.get(t)==null?0:this.getItemCountById(t,e)}pushItem(t){this.m_dicItemList.set(t.m_iId,t),this.m_dicTypeList.get(t.type)==null&&this.m_dicTypeList.set(t.type,new F),this.m_dicSubTypeList.get(t.subType)==null&&this.m_dicSubTypeList.set(t.subType,new F),this.m_dicTypeList.get(t.type).set(t.m_iId,t),this.m_dicSubTypeList.get(t.subType).set(t.m_iId,t)}removeItem(t){this.m_dicItemList.remove(t.m_iId),this.m_dicTypeList.get(t.type).remove(t.m_iId),this.m_dicSubTypeList.get(t.subType).remove(t.m_iId)}updataItemVoByArr(t,e=!1){let i=[],a=!1,n;for(let r=0;r<t.length;r++){n=t[r];let o=this.m_dicItemList.get(n.id);if(o==null&&(o=new ue(n.id),this.pushItem(o),o.m_bNew=!0),e?(o.newAddCnt=n.count-o.m_iNum,o.m_iNum=n.count):(o.newAddCnt=n.count,o.m_iNum=n.count+n.count),o.initDataByArr(n),i.push(o.m_iId),o.m_iNum<=0&&this.removeItem(o),o.newAddCnt>0&&ft.instance.needPop){if(o.itemItem.subType.toString()==Rt.PET.toString()&&o.itemItem.type.toString()==pe.Item_Type_Items.toString())return;ft.instance.addItem(o),a=!0}}a&&ft.instance.needPop&&ft.instance.autoPop&&Zt.instance.startShow(),i.length>0&&d.intance.event(b.PACKAGE_UPDATE_ITEM,[i])}getItemById(t){return this.m_dicItemList.get(t)}getItemsBySubType(t){let e=this.m_dicSubTypeList.get(t);return e==null&&(e=[]),e}getListByType(t){let e=[];return this.m_dicTypeList.get(t)&&(e=this.m_dicTypeList.get(t).values.slice()),e.sort(this.sortOnQa),e}getListBySubType(t){let e=[];return this.m_dicSubTypeList.get(t)&&(e=this.m_dicSubTypeList.get(t).values.slice()),e.sort(this.sortOnQa),e}sortOnQa(t,e){let i=t.itemItem.quality,a=e.itemItem.quality;return i<a?1:i>a?-1:0}getItemCountById(t,e=!0){let i=this.getItemById(t);return i?i.m_iNum:0}};Ut.TYPE_Consumption=1,Ut.TYPE_Equipment=2,Ut.TYPE_Currency=3,Ut.TYPE_Hero=4;var Wa=class s{constructor(t){this._addNewFList=[];this.delayShowNewFun=!1}static get instance(){return s._instace==null&&(s._instace=new s(new Io)),s._instace}addNewOpenFun(t){this._addNewFList=this._addNewFList.concat(t),this.delayShowNewFun||this.showNewFun()}setDelayShowFun(t){this.delayShowNewFun!=t&&(this.delayShowNewFun=t,t||this.showNewFun())}showNewFun(){if(this._addNewFList.length>0){let t=this._addNewFList.pop(),e=S.instance.systemOpenModel.m_dicSystemInfoCfg.get(t.toString());e?e.if_open.toString()=="1"||e.if_pop.toString()!="1"?this.showNewFun():this.swithToNewFun(t):this.showNewFun()}}swithToNewFun(t,e=!1){let i=S.instance.systemOpenModel.m_dicSystemInfoCfg.get(t);if(i){if(i.if_open.toString()=="1"){at.instance.notice("system_open.json-->funId:"+i.functionID+"is close");return}(i.if_pop.toString()=="1"||e)&&d.intance.event(b.EVENT_OPEN_MODULE,[p.NewFunUnLockDialog,t])}}hasUnlockFunction(t,e=!0){let i=S.instance.systemOpenModel.m_dicSystemInfoCfg.get(t+""),a=S.instance.systemOpenModel.isOpen(parseInt(t));return!a&&e&&at.instance.notice(f.instance.getLanguage(i.lock_word)),a}popOutTip(t){t.toString()==Et.TYPE_ENDURANCE.toString()&&d.intance.event("open_buy",2)}},Io=class{};var it=class{constructor(){}};it.YES=1,it.NO=2,it.SURE=4,it.CANCEL=8,it.CLOSE=16,it.RETURN_YES=1,it.RETURN_NO=2,it.RETURN_NONE=3,it.BASEALERTVIEW="BaseAlertDialog",it.BUYCONFIRMVIEW="BuyConfirmView",it.EnduranceOutTipView="EnduranceOutTipView",it.GUILDQUITVIEW="GuildQuitView",it.BuyItemConfirmView="BuyItemConfirmView",it.DOWNLOADALERT="DownLoadAlert";var me=class s{constructor(){}static instance(){return s._instance||(s._instance=new s),s._instance}AlertByType(t,e=null,i=0,a=null,n=null,r=!1,o=null){i==0&&(i=it.YES|it.NO),this.onLoaded(i,t,e,a,n,r,o)}onLoaded(t,e,i,a=null,n=null,r=!1,o=null){V.intance.openModule(e,{flag:t,okHandler:a,cancelHandler:n,data:i,destroyDoCancel:r,initHandler:o})}};var nt=class nt{static getColorText(t,e="#FFFF00"){return'<font color="'+e+'">'+t+"</font>"}static getChildByName(t,e,i="name"){if(t&&t.hasOwnProperty(i)&&t[i]==e)return t;let a=t;if(a){let n=a.numChildren,r;for(let o=0;o<n;++o)if(r=a.getChildAt(o),r instanceof Laya.Sprite&&(r=nt.getChildByName(r,e,i)),r&&r.hasOwnProperty(i)&&r[i]==e)return r}return null}static getChildByAttri(t,e){if(t&&t.hasOwnProperty(e)&&t[e])return t[e];let i=t;if(i){let a=i.numChildren,n;for(let r=0;r<a;++r)if(n=i.getChildAt(r),n instanceof Laya.Sprite){if(n=nt.getChildByAttri(n,e),n)return n}else if(n&&n.hasOwnProperty(e)&&n[e])return n[e]}return null}static logs(t,e=0,i=!0,a=16777215){if(t=nt.GetLogTime+" "+t,i)switch(e){case 0:a=16777215;break;case 1:a=16777215;break;case 2:a=16711680;break;case 3:a=16777215;break;case 4:a=13434777;break;case 5:a=16742399;break}}static get GetLogTime(){let t=new Date;return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+":"+t.getMilliseconds()}static get GRAY(){return nt._GRAY||(nt._GRAY=new Laya.ColorFilter([.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0])),nt._GRAY}static get GRAY1(){if(!nt._GRAY1){let t=[.3086,.16094,.082,0,0,.2086,.26094,.082,0,0,.1086,.36094,.082,0,0,0,0,0,1,0];nt._GRAY1=new Laya.ColorFilter(t)}return nt._GRAY1}static get GLOW(){return nt._GLOW||(nt._GLOW=new Laya.GlowFilter("#ffffff",12,0,0)),nt._GLOW}static get BLUR(){if(!nt._BLUR){let t=new Laya.BlurFilter;t.strength=5,nt._BLUR=[t]}return nt._BLUR}static share(t=1001,e=2,i=null,a=null,n=0,r=0,o=null){}static get isParseWWhiteUser(){return nt._isParseWWhiteUser}static get isWhiteName(){return X.isWhiteList}static itemListHandler(t,e){let i=t.dataSource,a=i[0],n=i[1],r=2,o=t.skin;o&&(o.indexOf("xinSmall")!=-1?r=1:o.indexOf("xinBig")!=-1&&(r=3));let l;r==1?l="common/common_clip/clip_xinSmall"+n+".png":r==3?l="common/common_clip/clip_xinBig"+n+".png":l="common/common_clip/clip_xinMiddle"+n+".png",t.skin=l,t.dataSource=a}static setStarList(t,e){t.renderHandler=new Laya.Handler(nt,nt.itemListHandler),t.dataSource=e}static get BLACK(){return nt._BLACK||(nt._BLACK=new Laya.ColorFilter,nt._BLACK.setColor("#000000")),nt._BLACK}static get YELLOW(){return nt._YELLOW||(nt._YELLOW=new Laya.ColorFilter,nt._YELLOW.setColor("#ffe64b")),nt._YELLOW}static get YELLOW1(){return nt._YELLOW1||(nt._YELLOW1=new Laya.ColorFilter,nt._YELLOW1.setColor("#fee14e")),nt._YELLOW1}static get RED1(){return nt._RED1||(nt._RED1=new Laya.ColorFilter,nt._RED1.setColor("#ff4537")),nt._RED1}static get BLUE(){return nt._BLUE||(nt._BLUE=new Laya.ColorFilter,nt._BLUE.setColor("#2f72a7")),nt._BLUE}static setColor(t="#13e2cf"){let e=new Laya.ColorFilter;return e.setColor(t),e}static heroNotEnought(){me.instance().AlertByType(it.BASEALERTVIEW,f.instance.getLanguage(1059),it.CANCEL,Laya.Handler.create(this,this.onGetHero))}static onGetHero(){ot.intance.setCurrentScene(J.M_SCENE_SHOP,1)}static titickNotEnought(){me.instance().AlertByType(it.BASEALERTVIEW,f.instance.getLanguage(1060),it.CANCEL,Laya.Handler.create(this,this.onGetTitck))}static onGetTitck(){ot.intance.setCurrentScene(J.M_SCENE_SHOP,2)}static moneyNotEnought(){me.instance().AlertByType(it.BASEALERTVIEW,[f.instance.getLanguage(6047),f.instance.getLanguage(6048)],it.CANCEL,Laya.Handler.create(this,this.onGetMoney))}static onGetMoney(){window.location.href="https://pancakeswap.finance/swap?inputCurrency=BNB&outputCurrency=0x8ff22201d69583b3f081e49e16caf86f3cb708f7"}static openSquidGame(){me.instance().AlertByType(it.BASEALERTVIEW,f.instance.getLanguage(6056),it.CANCEL,Laya.Handler.create(this,this.onOpenSquidGame))}static onOpenSquidGame(){window.location.href="https://squidgamefi.io/?invitationCode=2oi"}static otherLogin(){me.instance().AlertByType(it.BASEALERTVIEW,f.instance.getLanguage(6054),it.YES,Laya.Handler.create(this,mt.instance.reload))}static errorCodeTip(t){me.instance().AlertByType(it.BASEALERTVIEW,t,it.YES)}static shakeSprs(t,e=2,i=4,a=32){if(nt.isShake)return;nt.isShake=!0;let n=t.length,r=[];for(let I=0;I<n;I++){let k=t[I];r.push([k.x,k.y])}let o=[0,0],l=0,v=function(){o[l%2]=l++%4<2?0:i,l>e*4+1&&(Laya.timer.clear(Laya.stage,v),l=0,nt.isShake=!1);for(let I=0;I<n;I++){let k=t[I];k.x=o[0]+r[I][0],k.y=o[1]+r[I][1]}};Laya.timer.loop(a,Laya.stage,v)}static shake(t,e=2,i=4,a=32){if(nt.isShake)return;nt.isShake=!0;let n=new Laya.Point(t.x,t.y),r=[0,0],o=0,l=function(){r[o%2]=o++%4<2?0:i,o>e*4+1&&(Laya.timer.clear(Laya.stage,l),o=0,nt.isShake=!1),t.x=r[0]+n.x,t.y=r[1]+n.y};Laya.timer.loop(a,Laya.stage,l)}};nt._isParseWWhiteUser=!1,nt.isWWhiteUser=!1,nt.isShake=!1;var _t=nt;var Ne=class{constructor(){}ReadShort(t){let e=new Uint8Array(t.buffer),i=e[t.pos]<<8,a=e[t.pos+1],n=i|a;return t.pos+=2,n}ReadInt(t){let e=new Uint8Array(t.buffer),i=e[t.pos]<<24|e[t.pos+1]<<16|e[t.pos+2]<<8|e[t.pos+3];return t.pos+=4,i}ReadByte(t){return t.getByte()}ReadString(t){let e=this.ReadShort(t);return e==0?"":t.getUTFBytes(e)}ReadBytes(t,e){let i=t.buffer.slice(t.pos,e);return new Laya.Byte(i)}dispose(){}};var Ya=class{constructor(){this.writeByt=new Laya.Byte}writeByte(){}writeShort(t){this.writeByt.writeByte(t>>8),this.writeByt.writeByte(t)}writeInt(t){this.writeByt.writeByte(t>>24),this.writeByt.writeByte(t>>16),this.writeByt.writeByte(t>>8),this.writeByt.writeByte(t)}writeString(t){if(t.length==0){this.writeShort(0);return}let i=new Laya.Byte;i.writeUTFBytes(t),this.writeShort(i.length),this.writeByt.writeUTFBytes(t)}dispose(){}};var $e=class s{constructor(){this.cookie="####1.0.0#0#";this.encryptKey="FFIYD#^3LB954JB90fzj*(d)sO7";this._curSendIndex=-1}static get instance(){return s._instance||(s._instance=new s),s._instance}setLoginCookie(){this.cookie="####1.0.0#"+X.Login_UDID+"#"+X.UserAgent}parseCookie(t,e,i,a="1.0.0"){let n=this.encryptKey+e+t,r=jc(n);a=S.instance.M_S_VersionServer;let o=r+"#"+t+"#"+e+"#"+i+"#"+a+"#"+this._curSendIndex+"#1#"+X.Login_UDID+"#"+X.UserAgent;this.cookie=o}reflashCookie(){this.parseCookie(this.m_time,this.m_roleID,this.m_accout)}analyClient(t,e){let i=new Ya;i.writeString(this.cookie),i.writeShort(t);let a=this.analyData[t];return a&&a.length>0&&this.writeByt(a,e,i),i.writeByt}writeByt(t,e,i){for(let a in t){let n=e[a];if(t[a].indexOf("7/")!=-1){i.writeShort(n.length);let r=this.analyData[String(t[a]).split("7/")[1]];if(r)for(let o in n)this.writeByt(r,n[o],i)}else if(t[a]=="1")i.writeInt(n);else if(t[a]=="2")i.writeShort(n);else if(t[a]=="3")i.writeString(n);else if(t[a]=="4"||t[a]=="5"||t[a]=="6"){i.writeShort(n.length);for(let r in n)t[a]=="4"?i.writeInt(n[r]):t[a]=="5"?i.writeShort(n[r]):t[a]=="6"&&i.writeString(n[r])}}}analyServer(t){let e=new Ne,i=e.ReadShort(t),a=[i],n=this.analyData[i];return n&&n.length>0&&(a=a.concat(this.readByt(n,t,e))),a}analyCookie(t=""){console.log("RECE_COOKIE: "+t,1);let e=t.split("#");this.m_time=e[0],this.m_roleID=e[1],this.m_accout=e[2];let i=e[3];this._curSendIndex=i,this._curSendIndex++,console.log("cookie:_time:"+this.m_time+"  _roleID："+this.m_roleID+"	  _accout："+this.m_accout),this.parseCookie(this.m_time,this.m_roleID,this.m_accout),S.instance.timeStamp=parseFloat(this.m_time)}readByt(t,e,i){let a=[];for(let n in t)if(t[n].indexOf("7/")!=-1){let r=i.ReadShort(e),o=this.analyData[String(t[n]).split("7/")[1]],l=[];if(o&&r>0)for(let v=0;v<r;v++)l.push(this.readByt(o,e,i));a.push(l)}else if(t[n]=="1")a.push(i.ReadInt(e));else if(t[n]=="2")a.push(i.ReadShort(e));else if(t[n]=="3")a.push(i.ReadString(e));else if(t[n]=="4"||t[n]=="5"||t[n]=="6"){let r=i.ReadShort(e),o=[];for(let l=0;l<r;l++)t[n]=="4"?o.push(i.ReadInt(e)):t[n]=="5"?o.push(i.ReadShort(e)):t[n]=="6"&&o.push(i.ReadString(e));a.push(o)}return a}dispose(){}};function jc(s){throw new Error("Function not implemented.")}var W=class s{constructor(){this._inited=!1;this.stopAll=!1;this.heroReadyDic=new F;this.init()}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){this._inited||(this._inited=!0)}get matchDto(){return this._matchDto}set matchDto(t){this._matchDto=t,t&&t.startTime-t.nowTime>0?this.stopAll=!0:this.stopAll=!1}setMatchRes(){this.heroReadyDic=new F;var t=this.roomDto.members.length,e=[],i=this.currArenaItem.mapid;if(this.heroReadyDic.get("map_"+i)==null){var i=s.instance.currArenaItem.mapid,a=R.instance.getMapImg(i);e.push(a);var n=R.instance.getMapPrefab(i);e.push(n),this.heroReadyDic.set("map_"+i,!0)}for(var r=0;r<t;r++){var o=this.roomDto.members[r];if(this.heroReadyDic.get(o.heroId+"_"+o.heroColor)==null){var l=j.intance.m_dicHeros.get(o.heroId),v=R.instance.getHeroSkRes(l.serialId,o.heroColor);e.push({url:v,type:Laya.Loader.SPINE}),this.heroReadyDic.set(o.heroId+"_"+o.heroColor,!0)}}e.length>0&&Laya.loader.load(e,null,Laya.Handler.create(this,this.onPreAssetPress1,null,!1)).then(()=>{})}onPreAssetPress1(t){}clearData(){this.roomDto=null,this.matchDto=null,this.reward=null,this.heroReadyDic=null,this.currArenaItem=null,A.instance.clearData()}};var Ei=class Ei{constructor(){this.targetId=0;this.type=0;this.skillId=0;this.param=new Map}protocolId(){return Ei.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeStringStringMap(e.param),t.writeInt(e.skillId),t.writeLong(e.targetId),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new Ei,i=t.readStringStringMap();e.param=i;let a=t.readInt();e.skillId=a;let n=t.readLong();e.targetId=n;let r=t.readInt();return e.type=r,e}};Ei.PROTOCOL_ID=1031;var So=Ei,ja=So;var Ti=class Ti{constructor(){this.targetId=0;this.attackType=0;this.skillId=0}protocolId(){return Ti.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.attackType),t.writeInt(e.skillId),t.writeLong(e.targetId))}static read(t){if(!t.readBoolean())return null;let e=new Ti,i=t.readInt();e.attackType=i;let a=t.readInt();e.skillId=a;let n=t.readLong();return e.targetId=n,e}};Ti.PROTOCOL_ID=1021;var Eo=Ti,Xa=Eo;var Di=class Di{protocolId(){return Di.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new Di:null}};Di.PROTOCOL_ID=1025;var To=Di,qa=To;var Ci=class Ci{constructor(){this.x=0;this.y=0;this.speed=0;this.dire=0;this.time=0;this.area=0}protocolId(){return Ci.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeInt(e.dire),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new Ci,i=t.readInt();e.area=i;let a=t.readInt();e.dire=a;let n=t.readInt();e.speed=n;let r=t.readLong();e.time=r;let o=t.readInt();e.x=o;let l=t.readInt();return e.y=l,e}};Ci.PROTOCOL_ID=1013;var Do=Ci,za=Do;var Mi=class Mi{constructor(){this.targetId=0;this.targetX=0;this.targetY=0;this.skillId=0;this.sourceId=0;this.time=0}protocolId(){return Mi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.skillId),t.writeLong(e.sourceId),t.writeLong(e.targetId),t.writeInt(e.targetX),t.writeInt(e.targetY),t.writeLong(e.time))}static read(t){if(!t.readBoolean())return null;let e=new Mi,i=t.readInt();e.skillId=i;let a=t.readLong();e.sourceId=a;let n=t.readLong();e.targetId=n;let r=t.readInt();e.targetX=r;let o=t.readInt();e.targetY=o;let l=t.readLong();return e.time=l,e}};Mi.PROTOCOL_ID=1035;var Co=Mi,Qa=Co;var Xt=class Xt{constructor(){this.validEnemyList=[];this.gameWindowX=0;this.gameWindowY=0;this.isControl=!1}get gameMap(){return this._gameMap}set gameMap(t){this._gameMap=t}clearData(){this.gameMap=null,this.box_players=null,this.myHeroSpr=null,this.matchHeroSprDic=null,this.matchHeroSprs=null,this.matchHeroDic=null,this.myPlayer=null}static get instance(){return Xt._instance==null&&(Xt._instance=new Xt),Xt._instance}init(){this.validEnemyList=[]}insertValidList(t){this.isFInd(t,this.validEnemyList)||this.validEnemyList.push(t)}isFInd(t,e){var i=!1;(!t||!e||e.length<=0)&&(i=!1);for(let a=0;a<e.length;a++)if(e[a]==t)return!0;return i}isFIndIndex(t,e){var i=-1;(!t||!e||e.length<=0)&&(i=-1);for(let a=0;a<e.length;a++)e[a]==t&&(i=a);return i}removeValidListByValue(t){if(!(!t||!this.validEnemyList||this.validEnemyList.length<=0)){var e=this.isFIndIndex(t,this.validEnemyList);e!=-1&&this.validEnemyList.splice(e,1)}}initMatch(t,e){Laya.loader.load("scenes/match/MatchHeroSpr.lh").then(i=>{this.roleAniPrefab=i,this.createPlayers(),e&&e(t)})}updateMatch(t,e){this.updatePlayers(),e&&e(t)}createPlayers(){this.matchHeroDic=new F,this.matchHeroSprDic=new F,this.matchHeroSprs=[];let t=W.instance.matchDto.members.length;for(var e=0;e<t;e++){var i=W.instance.matchDto.members[e];let a=this.roleAniPrefab.create();a.dataSource=i,S.instance.playerDto.pid==i.id&&(this.myPlayer=i,this.setCurrentHero(a)),this.matchHeroDic.set(i.id,i),this.box_players.addChild(a),this.matchHeroSprs.push(a),this.matchHeroSprDic.set(i.id,a)}}updatePlayers(){this.matchHeroSprs=[];let t=W.instance.matchDto.members.length;for(var e=0;e<t;e++){var i=W.instance.matchDto.members[e];let a=this.matchHeroSprDic.get(i.id);a.dataSource=i,S.instance.playerDto.pid==i.id&&(this.myPlayer=i,this.setCurrentHero(a)),this.matchHeroDic.set(i.id,i),this.matchHeroSprs.push(a)}}addPlayer(t){if(t.type==1){if(this.matchHeroSprs){if(S.instance.playerDto.pid==t.member.id){console.log("自己不处理 :"+t.member.id);return}let e=this.getRoleById(t.member.id);if(e)e.dataSource=t.member,e.alpha=1;else{let i=this.roleAniPrefab.create();i.dataSource=t.member,this.box_players.addChild(i),this.matchHeroSprs.push(i)}}}else this.removeRoleById(t.member.id)}onSendMove(t,e,i,a,n,r,o){if(S.instance.playerDto.pid==e){let l=new za;l.time=t,l.speed=i,l.dire=a,l.x=n,l.y=r,l.area=o,It.instance.sendData(l)}}onSendTargetMove(t,e,i,a,n,r=0){if(S.instance.playerDto.pid==e){let o=new Qa;o.time=t,o.targetId=i,o.targetX=a,o.targetY=n,o.skillId=r,o.sourceId=e,It.instance.sendData(o)}}onSendAnimation(t,e,i=-1,a=-1,n=-1){let r=new ja;r.skillId=t,r.type=e,r.targetId=i,r.param.set("newX",`${a}`),r.param.set("newY",`${n}`),It.instance.sendData(r)}onRevAnimationPush(t){var e=Xt.instance.getRoleById(t.attId);t.attId!=S.instance.playerDto.pid&&e.attack(t.skillId,!1,t.param)}onSendAttack(t,e,i){let a=new Xa;a.targetId=t,a.attackType=e,a.skillId=i,It.instance.sendData(a)}onRevMovePush(t){if(t.pid!=S.instance.playerDto.pid){var e=Xt.instance.getRoleById(t.pid);e?e.onPushMoveData(t.time,t.speed,t.dire,t.x,t.y,t.area):console.log(t.pid+" sprite is null")}}onRevTargetMovePush(t){if(t.sourceId!=S.instance.playerDto.pid){var e=Xt.instance.getRoleById(t.targetId);e?e.onPushTargetMoveData(t.time,t.targetX,t.targetY):console.log(t.targetId+" sprite is null")}}onRevAttackPush(t){var e=Xt.instance.getRoleById(t.attPid);if(t.attPid!=S.instance.playerDto.pid){var i=j.intance.m_dicSkills.get(t.skill);i.type!=5&&e.attack(t.skill,!1)}var a=Xt.instance.getRoleById(t.defPid);a.takeDamage(t,e);var n=this.matchHeroDic.get(t.attPid),r=this.matchHeroDic.get(t.defPid);if(n.score=t.attScore,r.score=t.defScore,t.defHp<=0){var n=this.matchHeroDic.get(t.attPid);n.kill++}d.intance.event(b.UPDATE_KILL_NUM)}sendRestoreData(){let t=new qa;It.instance.sendData(t)}onRevRestorePush(t){W.instance.matchDto=t,d.intance.event(b.EVENT_RESTORE_DATA)}getRoleById(t){let e;return this.matchHeroSprs&&this.matchHeroSprs.forEach(i=>{if(i.roomPlayerDto.id==t){e=i;return}}),e}removeRoleById(t){var e;this.matchHeroSprs&&this.matchHeroSprs.forEach(i=>{if(i.roomPlayerDto.id==t){e=i,i.speed=0,i.alpha=.3;return}})}onGoMatchEndRank(t){V.intance.openModule(p.MatchEndRankView,t)}getValidList(){return this.validEnemyList}playMusic(){bt.instance.playMusicByURL("mp3/battle.mp3")}playSound(t){var e="";t==1?e="resources/music/pugong":t==2?e="resources/music/enemyHit":t==3&&(e="resources/music/dazhao"),bt.instance.playSound(e+".wav",1)}setCurrentHero(t){t.isMe=!0;var e=this.myHeroSpr==null;this.myHeroSpr=t,Xt.instance.moveGameWindow(!0),this.myHeroSpr.initBirth(e)}getAttackTarget(t){console.log("getAttackTarget");var e=t.distance,i=t.targetsType;if(i==2){let a,n=1e4;return this.matchHeroSprs&&this.matchHeroSprs.forEach(r=>{if(!r._isDead&&!r.isMe){var o=this.isEnemyInRange(r,e);o<=e&&o<n&&this.canAttack(this.myHeroSpr,r)&&(a=r,n=o)}}),a}return null}isEnemyInRange(t,e){return Math.sqrt(Math.pow(t.x-this.myHeroSpr.x,2)+Math.pow(t.y-this.myHeroSpr.y,2))}canAttack(t,e){let i=new Laya.Vector2;i.x=e.x-t.x,i.y=e.y-t.y;let a=new Laya.Vector2(1,0);switch(t.roleDirection){case 1:a=new Laya.Vector2(0,-1);break;case 2:a=new Laya.Vector2(1,-1);break;case 3:a=new Laya.Vector2(1,0);break;case 4:a=new Laya.Vector2(1,1);break;case 5:a=new Laya.Vector2(0,1);break;case 6:a=new Laya.Vector2(-1,1);break;case 7:a=new Laya.Vector2(-1,0);break;case 8:a=new Laya.Vector2(-1,-1);break}let n=Math.atan2(i.y,i.x)-Math.atan2(a.y,a.x);n<0&&(n+=2*Math.PI),n=n*180/Math.PI,console.log("angle 2: "+n);let r=45;return n<r||n>360-r}canTui(t,e){let i=new Laya.Vector2;i.x=e.x-t.x,i.y=e.y-t.y;let a=new Laya.Vector2(1,0);switch(t.roleDirection){case 1:a=new Laya.Vector2(0,-1);break;case 2:a=new Laya.Vector2(1,-1);break;case 3:a=new Laya.Vector2(1,0);break;case 4:a=new Laya.Vector2(1,1);break;case 5:a=new Laya.Vector2(0,1);break;case 6:a=new Laya.Vector2(-1,1);break;case 7:a=new Laya.Vector2(-1,0);break;case 8:a=new Laya.Vector2(-1,-1);break}let n=Math.atan2(i.y,i.x)-Math.atan2(a.y,a.x);n<0&&(n+=2*Math.PI),n=n*180/Math.PI,console.log("angle 2: "+n);let r=45;return n<r||n>360-r}setMyHeroDirection(t){this.myHeroSpr&&(t!=-4?(this.myHeroSpr.myRoleDirection=t,this.myHeroSpr.speed=this.myHeroSpr.moveSpeed,this.myHeroSpr.inControl=!0,this.isControl=!0,console.log("this.myHeroSpr.inControl: "+this.myHeroSpr.inControl)):(this.myHeroSpr.speed=0,this.myHeroSpr.inControl=!1,this.isControl=!1,console.log("this.myHeroSpr.inControl: "+this.myHeroSpr.inControl)))}moveGameWindow(t=!1){if(this.myHeroSpr){this.gameWindowX=this.myHeroSpr.x-Laya.stage.width/2,this.gameWindowY=this.myHeroSpr.y-Laya.stage.height/2;var e=-this.gameWindowX,i=-this.gameWindowY,a=Laya.stage.width-this.gameMap.width,n=Laya.stage.height-this.gameMap.height;e>0?e=0:e<a?e=a:e=e,i>0?i=0:i<n?i=n:i=i,t?this.gameMap.pos(e,i,!0):Laya.Tween.to(this.gameMap,{x:e,y:i},500)}}};Xt._instance=null;var A=Xt;function Mo(){typeof web3!="undefined"&&(web3=new Web3(web3.currentProvider))}var he=class s{constructor(){this.walletDic=new F}static get instance(){return s._instance||(s._instance=new s),s._instance}getEthValue(t){return s.instance.walletDic.get(t)?s.instance.walletDic.get(t).ethValue:0}getValue(t){return s.instance.walletDic.get(t)?s.instance.walletDic.get(t).value:0}};var Se=class Se{constructor(t,e){this._lineIndex=0;this._isShow=!1;this._alpha=.6;this.isInit=!1;this._isRelease=!0;this._count=0;this.maxCount=1e3;this.prevX=0;this.prevY=0;this._stage=t,this._isRelease=e,this._actionLineList=[],this._time=new Date().getTime();let i,a,n,r,o=function(I){i=I.stageX,a=I.stageY,n=i,r=a},l=function(I){n=I.stageX,r=I.stageY},v=function(I){let k=Laya.stage.width-(n-i)<160,q=Laya.stage.height-(r-a)<160;k&&q&&$t.debugger&&(Laya.Browser.window.console.log=$t.addConsoleLog,$t.debugger.showOrHide())};Laya.stage.on(Laya.Event.MOUSE_DOWN,this,o),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,l),Laya.stage.on(Laya.Event.MOUSE_UP,this,v)}initDebugView(){if(!this.isInit){this.totalW=Laya.stage.width,this.totalH=Laya.stage.height/2,this.bigContainer=new Laya.Sprite,this.bgContainer=new Laya.Sprite,this._bgSp=new Laya.Sprite,this._bgSp.alpha=this._alpha,this._bgSp.graphics.drawRect(0,0,this.totalW,this.totalH,"#000000"),this._bgSp.mouseEnabled=!1,this._debugInfoTf=new Laya.Text,this._debugInfoTf.color="#ffffff",this._debugInfoTf.width=this.totalW-10,this._debugInfoTf.height=this.totalH-10,this._debugInfoTf.overflow="scroll",this._debugInfoTf.wordWrap=!0;let t="[LOADINFO - DEBUGGER]";this.appendText("加载调试信息 "+t,0,!1),this._closeTf=new Laya.Label,this._closeTf.color="#ff0000",this._closeTf.valign="middle",this._closeTf.width=55,this._closeTf.height=55,this._closeTf.borderColor=Se.DEFAULT_COLOR,this._closeTf.text="关闭",this._autoScrollTf=new Laya.Label,this._autoScrollTf.color="#ff0000",this._autoScrollTf.valign="middle",this._autoScrollTf.width=55,this._autoScrollTf.height=55,this._autoScrollTf.borderColor=Se.DEFAULT_COLOR,this._autoScrollTf.text="自动卷屏",this._bgAlpha0=new Laya.Label,this._bgAlpha0.color="#ff0000",this._bgAlpha0.valign="middle",this._bgAlpha0.width=55,this._bgAlpha0.height=55,this._bgAlpha0.borderColor=Se.DEFAULT_COLOR,this._bgAlpha0.text="背景-",this._bgAlpha1=new Laya.Label,this._bgAlpha1.color="#ff0000",this._bgAlpha1.valign="middle",this._bgAlpha1.width=55,this._bgAlpha1.height=55,this._bgAlpha1.borderColor=Se.DEFAULT_COLOR,this._bgAlpha1.text="背景+",this._clearTf=new Laya.Label,this._clearTf.color="#ff0000",this._clearTf.valign="middle",this._clearTf.width=55,this._clearTf.height=55,this._clearTf.borderColor=Se.DEFAULT_COLOR,this._clearTf.text="清理",this._testTf=new Laya.Label,this._testTf.color="#ff0000",this._testTf.width=55,this._testTf.height=55,this._testTf.borderColor=Se.DEFAULT_COLOR,this._testTf.text="点穿",this.bgContainer.x=5,this.bgContainer.y=5,this._debugInfoTf.x=5,this._debugInfoTf.y=5,this.bgContainer.addChild(this._bgSp),this.bgContainer.addChild(this._debugInfoTf),this._closeTf.x=this.totalW-60,this._closeTf.y=5,this.bgContainer.addChild(this._closeTf),this._autoScrollTf.x=this.totalW-60,this._autoScrollTf.y=105,this.bgContainer.addChild(this._autoScrollTf),this._bgAlpha0.x=this.totalW-60,this._bgAlpha0.y=205,this.bgContainer.addChild(this._bgAlpha0),this._bgAlpha1.x=this.totalW-60,this._bgAlpha1.y=305,this.bgContainer.addChild(this._bgAlpha1),this._clearTf.x=this.totalW-60,this._clearTf.y=405,this.bgContainer.addChild(this._clearTf),this._testTf.x=this.totalW-60,this._testTf.y=505,this.bigContainer.addChild(this.bgContainer),this.bigContainer.addChild(this._testTf),this._autoScroll=!0,this._hide=!0,this._debugInfoTf.on(Laya.Event.MOUSE_DOWN,this,this.startScrollText),this._closeTf.on(Laya.Event.CLICK,this,this.onCloseTfClick),this._autoScrollTf.on(Laya.Event.CLICK,this,this.onAutoScrollTfClick),this._bgAlpha0.on(Laya.Event.CLICK,this,this.onBgAlpha0),this._bgAlpha1.on(Laya.Event.CLICK,this,this.onBgAlpha1),this._clearTf.on(Laya.Event.CLICK,this,this.onClearTfClick),this._testTf.on(Laya.Event.CLICK,this,this.onTestTfClick),this.isInit=!0}}show(){this.initDebugView(),this._stage.addChild(this.bigContainer),this._isShow=!0,this.updateView()}hide(){this.initDebugView(),this.bigContainer.parent&&this.bigContainer.parent.removeChild(this.bigContainer),this._isShow=!1,this.updateView()}showOrHide(){this._isShow=!this._isShow,this._isShow?this.show():this.hide()}appendText(t,e=0,i=!0){if(i){let a=new Date().getTime()-this._time;t+="  ["+(a/1e3).toFixed(3)+"]"}this._actionLineList.push([t+`
`,e]),this._lineIndex>=200&&(this._actionLineList.splice(0,20),this._lineIndex-=20),this._count++,this._count>this.maxCount&&(this._count=0,this._debugInfoTf&&(this._debugInfoTf.text="")),this._isShow&&(this._currentLine=this._actionLineList[this._lineIndex++],this._debugInfoTf&&(this._debugInfoTf.text+=this._currentLine[0]),this._autoScroll&&this._debugInfoTf&&(this._debugInfoTf.scrollY=this._debugInfoTf.maxScrollY))}updateView(){if(this._isShow){this._count=0,this._debugInfoTf.text="";let t=this._actionLineList.length;for(this._lineIndex=0;this._lineIndex<t;++this._lineIndex)this._currentLine=this._actionLineList[this._lineIndex],this._debugInfoTf.text+=this._currentLine[0],this._count++,this._count>this.maxCount&&(this._count=0,this._debugInfoTf.text="");this._autoScroll&&(this._debugInfoTf.scrollY=this._debugInfoTf.maxScrollY)}else this._debugInfoTf.text=""}onCloseTfClick(t){this.hide()}onAutoScrollTfClick(t){this._autoScroll=!this._autoScroll,this._autoScroll?this._autoScrollTf.text="自动卷屏":this._autoScrollTf.text="手动卷屏"}onBgAlpha0(t){this._alpha-=.1,this._alpha<=0&&(this._alpha=0),this._bgSp.alpha=this._alpha}onBgAlpha1(t){this._alpha+=.1,this._alpha>=1&&(this._alpha=1),this._bgSp.alpha=this._alpha}onClearTfClick(t){this._debugInfoTf.text="",this._actionLineList.length=0,this._lineIndex=0}onTestTfClick(t){this.bgContainer.mouseEnabled=!this.bgContainer.mouseEnabled}set testFun(t){this._testFun=t}get bgSp(){return this._bgSp}startScrollText(t){this.prevX=this._debugInfoTf.mouseX,this.prevY=this._debugInfoTf.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.finishScrollText)}finishScrollText(t){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.finishScrollText)}scrollText(t){let e=this._debugInfoTf.mouseX,i=this._debugInfoTf.mouseY;this._debugInfoTf.scrollX+=this.prevX-e,this._debugInfoTf.scrollY+=this.prevY-i,this.prevX=e,this.prevY=i}};Se.DEFAULT_COLOR="#ffffff";var Ja=Se;var $t=class s{static Initialize(t,e){s.isRelease=e,this.debugger==null&&(this.debugger=new Ja(t,e))}static log(t,e=0,i=0){var a=_t.GetLogTime+" "+t;e&&s.addLog(a,e,i)}static addLog(t,e=0,i=0){this.debugger&&this.debugger.appendText(t,i),console.log(t)}static addConsoleLog(...t){s.debugger&&s.debugger.appendText(t,0)}};var Tl=Laya.HttpRequest,te=class te{static requestGet(t,e,i=!1,a=!0){return new Promise((n,r)=>{var o=Laya.Pool.getItem("HttpRequest");o||(o=new Tl),o.http.timeout=2e3,o.on(Laya.Event.COMPLETE,null,q),o.on(Laya.Event.ERROR,null,Q),o.http.onreadystatechange=()=>{if(o.http.readyState===XMLHttpRequest.DONE){var Z=o.http.status;Z>=200&&Z<400||(r(),H())}};let l=localStorage.getItem("TOX-COOKIE"+z.instance.walletAddress),v=["Content-Type","application/json"];l&&(v=[...v,"Authorization",l]);let I=te.httpRoot+"/"+t+k(e);te.httpRoot!="https://api.cybertron.world"&&$t.log("REQUEST_GET "+I,1),o.send(I,null,"get","json",v);function k(Z){if(typeof Z=="string")return Z;let Dt="";for(let Gt in Z)Dt+="&"+Gt+"="+Z[Gt];return Dt}function q(Z){Z.code==="0"?n(Z.data):(vt.instance.showErrorWord(parseInt(Z.code)),r(Z.code)),H()}function Q(Z,Dt){debugger;r(Z),H()}function H(){o.off(Laya.Event.COMPLETE,null,q),o.off(Laya.Event.ERROR,null,Q),Laya.Pool.recover("HttpRequest",o)}})}static startHeart(){Laya.timer.loop(1e3,this,this.onHeart)}static onHeart(){return _(this,null,function*(){var t=yield this.requestPost("wxgame/sys/ping",{},!0,!0),e=t.time;S.instance.m_serverTime=e;var i=t.resChange,a=t.itemChange;i&&i.length>0&&S.instance.moneyInfoHander(i),a&&a.length>0&&S.instance.itemsDataUpdataHandler(a,!0)})}static requestPost(t,e,i=!1,a=!0){let n=localStorage.getItem("TOX-COOKIE"+z.instance.walletAddress);return i&&!n?[]:new Promise((r,o)=>{var l=Laya.Pool.getItem("HttpRequest");l||(l=new Tl),l.http.timeout=1e4,l.once(Laya.Event.COMPLETE,null,k),l.once(Laya.Event.ERROR,null,q);let v=[];n&&a&&(v=[...v,"Authorization",n]);var I=te.seq+1;te.seq=I,te.httpRoot!="https://api.cybertron.world"&&t!="wxgame/sys/ping"&&console.log(_t.GetLogTime+" "+I+" >>> HTTP_POST "+te.httpRoot+"/"+t+" "+JSON.stringify(e),n),l.send(te.httpRoot+"/"+t,e,"post","json",v);function k(H){return _(this,null,function*(){if(te.httpRoot!="https://api.cybertron.world"&&(X.Debug>0||t!="wxgame/sys/ping")&&console.log(_t.GetLogTime+" "+I+" <<< hTTP_RCV data: "+JSON.stringify(H),1),H.errorCode==0||H.errorCode==="0")r(H);else{if(H.errorCode===10)_t.heroNotEnought();else if(H.errorCode===18)_t.titickNotEnought();else if(H.errorCode===5)if(X.Debug==0){localStorage.setItem("TOX-COOKIE"+z.instance.walletAddress,"");var Z=yield z.instance.refreshToken();Z&&te.requestPost(t,e,i,a)}else localStorage.setItem("TOX-COOKIE"+z.instance.walletAddress,""),vt.instance.showErrorWord(parseInt(H.errorCode));else H.errorCode===17?X.Debug==0?(localStorage.setItem("TOX-COOKIE"+z.instance.walletAddress,""),z.instance.signAndLogin()):(localStorage.setItem("TOX-COOKIE"+z.instance.walletAddress,""),vt.instance.showErrorWord(parseInt(H.errorCode))):vt.instance.showErrorWord(parseInt(H.errorCode));o(H.errorCode)}Q()})}function q(H,Z){console.log("errorHandler data: "+H,1),vt.instance.showErrorWord(500),o(H),Q()}function Q(){l.off(Laya.Event.COMPLETE,null,k),l.off(Laya.Event.ERROR,null,q),Laya.Pool.recover("HttpRequest",l)}})}};te.httpRoot=getServer(),te.seq=0;var tt=te;var qt=class{};qt.ASSETS_TOX=1e4,qt.ASSETS_ARCANITE=10001,qt.ASSETS_CRYSTAL=10002,qt.ASSETS_MITHRIL=10003,qt.ASSETS_REDSTONE=10004,qt.ASSETS_TRUEIRON=10005;var C=class{static initConfig(t){this.configDic=new F;for(let e of t){let i=e.sstringvalue;e.sadditional==="JSON"&&(i=JSON.parse(i)),this.configDic.set(e.skey2,i),this[e.skey2]=i}j.intance.resetTokenData()}};C.ADDRESS0="0x0000000000000000000000000000000000000000",C.TOX_ADDRESS="0xA7b194Fb8f9b5A3a92bD5e99E2028C922727c770",C.TOKEN_ERC20ABI=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"miner",type:"address"}],name:"addMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"burn",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_delMinter",type:"address"}],name:"delMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"idx",type:"uint256"}],name:"getMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMinterLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isMinter",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C.ACCOUNT_ADDRESS="0x5ff2123b0Aa4bD97eeF5F6388EFCB56cd29D6835",C.ACCOUNT_ABI=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"nickName",type:"string"},{indexed:!1,internalType:"string",name:"avatar",type:"string"},{indexed:!1,internalType:"uint256",name:"level",type:"uint256"},{indexed:!1,internalType:"uint256",name:"birthHeight",type:"uint256"},{indexed:!1,internalType:"uint256",name:"birthPlace",type:"uint256"},{indexed:!1,internalType:"uint256",name:"gender",type:"uint256"},{indexed:!1,internalType:"uint256",name:"influence",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"_avatar",type:"string"}],name:"changeAvatar",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_gender",type:"uint256"}],name:"changeGender",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_influence",type:"uint256"}],name:"changeInfluence",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_level",type:"uint256"}],name:"changeLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"_nickname",type:"string"}],name:"changeNickName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"_nickname",type:"string"},{internalType:"string",name:"_avatar",type:"string"},{internalType:"uint256",name:"_level",type:"uint256"},{internalType:"uint256",name:"_birthHeight",type:"uint256"},{internalType:"uint256",name:"_birthPlace",type:"uint256"},{internalType:"uint256",name:"_gender",type:"uint256"},{internalType:"uint256",name:"_influence",type:"uint256"}],name:"createAccount",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getAccountInfo",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"nickName",type:"string"},{internalType:"string",name:"avatar",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"birthHeight",type:"uint256"},{internalType:"uint256",name:"birthPlace",type:"uint256"},{internalType:"uint256",name:"gender",type:"uint256"},{internalType:"uint256",name:"influence",type:"uint256"}],internalType:"struct AccountInfo",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newBaseURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"newTokenURI",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C.CREATE_ACCOUNT_ADDRESS="0x1f17861277281Fc2A97Ef59F15dE994D4e658e8b",C.CREATE_ACCOUNT_ABI=[{inputs:[{internalType:"address",name:"_accountContract",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"uint256[]",name:"_place",type:"uint256[]"}],name:"addBirthPlace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountInfo",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"nickName",type:"string"},{internalType:"string",name:"avatar",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"birthHeight",type:"uint256"},{internalType:"uint256",name:"birthPlace",type:"uint256"},{internalType:"uint256",name:"gender",type:"uint256"},{internalType:"uint256",name:"influence",type:"uint256"}],internalType:"struct AccountInfo",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBirthPlace",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWebSit",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"hasCanRegister",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"hasRegistered",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"nickName",type:"string"},{internalType:"uint256",name:"gender",type:"uint256"},{internalType:"string",name:"_avatar",type:"string"}],name:"registerAccount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_canRegister",type:"bool"}],name:"setCanRegister",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_websit",type:"string"}],name:"setWebsit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C.EDIT_ACCOUNT_ADDRESS="0xaa1B8FA74Ed295123a6336C2D3a88cB973160dfa",C.EDIT_ACCOUNT_ABI=[{inputs:[{internalType:"address",name:"_accountContract",type:"address"},{internalType:"string",name:"_website",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPirce",outputs:[{components:[{internalType:"address",name:"exchangeToken",type:"address"},{internalType:"uint256",name:"rate",type:"uint256"}],internalType:"struct UpdateProfile.Price",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWebsite",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_exchangeToken",type:"address"},{internalType:"uint256",name:"_rate",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_website",type:"string"}],name:"setWebsite",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"nickName",type:"string"},{internalType:"string",name:"avatar",type:"string"}],name:"updateProfile",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],C.STAKING_ARCANITE_ADDRESS="0xc305D92dCAaa73BacB7AADe5a4EB433d3AffFF6f",C.STAKING_CRYSTAL_ADDRESS="0xfE9fCfAA3D434A51dCC9E46C4C7fe26932cbB2C9",C.STAKING_MITHRIL_ADDRESS="0x7E36042672b5302311A9Fd92Ea994422B673C30d",C.STAKING_REDSTONE_ADDRESS="0x4E5C8a36c7CCB5d388ef045505e590B5265e2637",C.STAKING_TRUEIRON_ADDRESS="0xAF88Ff4BfAF5D28adB1a3D9521F5232b59CFC5E2",C.STAKING_POOL_ABI=[{inputs:[{internalType:"uint256",name:"_poolPlace",type:"uint256"},{internalType:"address",name:"_stakeToken",type:"address"},{internalType:"address",name:"_accountContract",type:"address"},{internalType:"address",name:"_rewardsContract",type:"address"},{internalType:"address",name:"_empowerContract",type:"address"},{internalType:"uint256",name:"_dailyRewards",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"rewards",type:"uint256"}],name:"RewardAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"rewards",type:"uint256"}],name:"RewardPaid",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"calcCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"calcPerSecondsRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"capacityOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_dailyRewards",type:"uint256"}],name:"changeDailyRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimAllReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"claimReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"earnedAll",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"estimatePerSecondsRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAccountContractAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAccountTokensNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDailyRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getEmpowerContractAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastUpdateTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLimitTokensNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolPlace",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRewardsContractAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRewardsPerUnitStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRewardsRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getStakeTokenAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTokenIdleStatus",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTokenMiningStatus",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"isAccountStakeToken",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_empowerContract",type:"address"}],name:"setEmpowerContract",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_limitTokensNumber",type:"uint256"}],name:"setLimitTokensNumber",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_idleStatus",type:"uint256"}],name:"setTokenIdleStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_miningStatus",type:"uint256"}],name:"setTokenMiningStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"stake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"withdrawAllAndClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"withdrawAndClaim",outputs:[],stateMutability:"nonpayable",type:"function"}],C.STAKING_HERO_POWERCALC_ABI=[{inputs:[{internalType:"uint256",name:"_constantValue",type:"uint256"},{internalType:"uint256",name:"_linearCoefficient",type:"uint256"},{internalType:"uint256",name:"_quadraticCoefficient",type:"uint256"},{internalType:"uint256",name:"_percentage",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenLevel",type:"uint256"},{internalType:"bool",name:"isMatchProfession",type:"bool"}],name:"calcCapacity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getFormulaParams",outputs:[{components:[{internalType:"uint256",name:"constantValue",type:"uint256"},{internalType:"uint256",name:"linearCoefficient",type:"uint256"},{internalType:"uint256",name:"quadraticCoefficient",type:"uint256"},{internalType:"uint256",name:"percentage",type:"uint256"}],internalType:"struct EmpowerCalcFormula.FormulaParams",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_constantValue",type:"uint256"},{internalType:"uint256",name:"_linearCoefficient",type:"uint256"},{internalType:"uint256",name:"_quadraticCoefficient",type:"uint256"},{internalType:"uint256",name:"_percentage",type:"uint256"}],name:"setFormulaParams",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C.BLINDBOX_ADDRESS="0xaf8d3eb0f0e0a454Ec9B3Fb7207dD70Ba302d653",C.BLINDBOX_ABI=[{inputs:[{internalType:"address",name:"_heroAddress",type:"address"},{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"},{internalType:"string",name:"_baseName",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"accountIsInWhiteList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_races",type:"uint256[]"}],name:"addRaces",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getBaseName",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getIsOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPirce",outputs:[{components:[{internalType:"address",name:"exchangeToken",type:"address"},{internalType:"uint256",name:"price",type:"uint256"}],internalType:"struct HeroMallV1.Price",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRaces",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getReceiverAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWhiteListContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"recruit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"setBaseName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxBuyTimes",type:"uint256"}],name:"setMaxBuyTimes",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"}],name:"setMaxTotalSupply",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_exchangeToken",type:"address"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiverAddress",type:"address"}],name:"setReceiverAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_whiteListContract",type:"address"}],name:"setWhiteListContract",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C.BLINDBOX_ADDRESS_V2="0xaf8d3eb0f0e0a454Ec9B3Fb7207dD70Ba302d653",C.BLINDBOX_ABI_V2=[{inputs:[{internalType:"address",name:"_heroAddress",type:"address"},{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"},{internalType:"string",name:"_baseName",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"accountIsInWhiteList",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_races",type:"uint256[]"}],name:"addRaces",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getBaseName",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getIsOpen",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxBuyTimes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMaxTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPirce",outputs:[{components:[{internalType:"address",name:"exchangeToken",type:"address"},{internalType:"uint256",name:"price",type:"uint256"}],internalType:"struct HeroMallV1.Price",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRaces",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getReceiverAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWhiteListContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"recruit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"setBaseName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxBuyTimes",type:"uint256"}],name:"setMaxBuyTimes",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxTotalSupply",type:"uint256"}],name:"setMaxTotalSupply",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_isOpen",type:"bool"}],name:"setOpen",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_exchangeToken",type:"address"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiverAddress",type:"address"}],name:"setReceiverAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_whiteListContract",type:"address"}],name:"setWhiteListContract",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C.HERO_ADDRESS="0xCC0A4E3Bd1D49D7Ef9C431C0aD87D36B0B342018",C.HERO_ABI=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"},{indexed:!1,internalType:"uint256",name:"level",type:"uint256"},{indexed:!1,internalType:"uint256",name:"rarity",type:"uint256"},{indexed:!1,internalType:"uint256",name:"series",type:"uint256"},{indexed:!1,internalType:"uint256",name:"race",type:"uint256"},{indexed:!1,internalType:"uint256",name:"mineralLevel",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"level",type:"uint256"}],name:"UpdateLevel",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"mineralLevel",type:"uint256"}],name:"UpdateMineralLevel",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"string",name:"name",type:"string"}],name:"UpdateName",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"race",type:"uint256"}],name:"UpdateRace",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"rarity",type:"uint256"}],name:"UpdateRatity",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"series",type:"uint256"}],name:"UpdateSeries",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"status",type:"uint256"}],name:"UpdateStatus",type:"event"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"addGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"government",type:"address"}],name:"deletedGovernment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getGovernment",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getGovernmentLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getNFTParams",outputs:[{components:[{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"level",type:"uint256"},{internalType:"uint256",name:"rarity",type:"uint256"},{internalType:"uint256",name:"series",type:"uint256"},{internalType:"uint256",name:"race",type:"uint256"},{internalType:"uint256",name:"mineralLevel",type:"uint256"}],internalType:"struct Parmas",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getStatus",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"isGovernment",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"_name",type:"string"},{internalType:"uint256",name:"_level",type:"uint256"},{internalType:"uint256",name:"_rarity",type:"uint256"},{internalType:"uint256",name:"_series",type:"uint256"},{internalType:"uint256",name:"_race",type:"uint256"},{internalType:"uint256",name:"_mineralLevel",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"newBaseURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"newTokenURI",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_level",type:"uint256"}],name:"updateLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_mineralLevel",type:"uint256"}],name:"updateMineralLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"_name",type:"string"}],name:"updateName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"race",type:"uint256"}],name:"updateRace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_rarity",type:"uint256"}],name:"updateRatity",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"_series",type:"uint256"}],name:"updateSeries",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"status",type:"uint256"}],name:"updateStatus",outputs:[],stateMutability:"nonpayable",type:"function"}],C.ASSETS_ARCANITE_ADDRESS="0x9973Fe783b5A1923dEE41E4115AD888573E3f2B5",C.ASSETS_CRYSTAL_ADDRESS="0x362d1C7CfE094fc4B6619Dc0486f0DadAee923A5",C.ASSETS_MITHRIL_ADDRESS="0x3f623e7d2fb52d1f8E718fb94bf82d80F1985ebf",C.ASSETS_REDSTONE_ADDRESS="0x891008aF9d77467f1c48845EAB210F951A8e9e4F",C.ASSETS_TRUEIRON_ADDRESS="0x93C52C6ee7c814f83983Ac20cDe369DA9EFc984a",C.CREATE_UNION_ADDRESS="0xcd62E6a07072Bed38F4126ba5C9361901c71846e",C.CREATE_UNION_ABI="",C.UNION_NUMBER_SYS_ADDRESS="0x45F0de10fA3982c4d18AbaE89a5F0663123f955c",C.UNION_NUMBER_SYS_ABI="",C.UPGRADE_UNION_ADDRESS="0x18320fD38F3806C0A9fb2B41202Ed0bD3f826894",C.UPGRADE_UNION_ABI="",C.UNION_DISTRIBUTE_ADDRESS="0x0f6b4bBa8b01B6ee2CC3232ea963ac702CaDCe04",C.UNION_WAR_ADDRESS="0xF8489Bb617F9DCaBF33bEaeBdA4CCD029E9E247E",C.UNION_DISTRIBUTE_ABI="",C.UNION_WAR_ABI="",C.HERO_TO_TOKEN_POOL_ADDRESS="",C.HERO_TO_TOKEN_POOL_ABI="",C.WITHDRAW_AND_RECHARGE_ADDRESS="",C.WITHDRAW_AND_RECHARGE_ABI="",C.SERIESHEROMALL_ADDRESS="",C.SERIESHEROMALL_ABI="",C.HEROFORMATION_ADDRESS="",C.HEROFORMATION_ABI="",C.HERO_MINT_ADDRESS="",C.HERO_MINT_ABI="";var xi=class{constructor(){this.coins={};this.needTip=!0}};var ti=class s{constructor(){this.create_contract=null;this.edit_account=null;this.account_contract=null;this.tokenId=0}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){typeof window.ethereum!="undefined"&&(this.account_contract=new window.web3.eth.Contract(C.ACCOUNT_ABI,C.ACCOUNT_ADDRESS),this.create_contract=new window.web3.eth.Contract(C.CREATE_ACCOUNT_ABI,C.CREATE_ACCOUNT_ADDRESS),this.edit_account=new window.web3.eth.Contract(C.EDIT_ACCOUNT_ABI,C.EDIT_ACCOUNT_ADDRESS))}getAccountVoFromServer(){return _(this,null,function*(){let t=yield tt.requestPost("cybertron-sys-api/api/v1/account/find",{address:z.instance.walletAddress},!1,!1);if(t){let e=new xi;return Object.assign(e,t),console.log("info========"+JSON.stringify(e)),e}return t})}updateProfile(t,e,i){return _(this,null,function*(){var a=S.instance.playerDto.sex,n=S.instance.playerDto;let r=yield tt.requestPost("wxgame/player/changeInfo",{name:t,sex:a,icon:e,country:i});return r?(n.icon=r.icon,n.country=r.country,n.name=r.name,n.sex=r.sex,n):null})}getTokenId(){return _(this,null,function*(){return this.tokenId?this.tokenId:(this.tokenId=yield this.account_contract.methods.tokenOfOwnerByIndex(z.instance.walletAddress,0).call(),this.tokenId=parseInt(this.tokenId+""),this.tokenId)})}getAccountInfo(){return _(this,null,function*(){this.tokenId||(yield this.getTokenId());let t=yield this.account_contract.methods.getAccountInfo(this.tokenId).call(),e=new xi;return e.pid=t[0],e.name=t[1],e.icon=t[2],e.lv=t[3],e.birthHeight=t[4],e.birthPlace=t[5],e.sex=t[6],e.influence=t[7],console.log("info========"+JSON.stringify(e)),e})}};var ae=class{constructor(){}};ae.UPDATE_LOCAL_WALLET_LIST_EVENT="WalletEvent:UPDATE_LOCAL_WALLET_LIST_EVENT",ae.TRANSFER_LOCAL_WALLET_EVENT="WalletEvent:TRANSFER_LOCAL_WALLET_EVENT";var Ai=class{};var ei=class s{constructor(){this.assets_ary=[[1e4,C.TOX_ADDRESS],[10001,C.ASSETS_ARCANITE_ADDRESS],[10002,C.ASSETS_CRYSTAL_ADDRESS],[10003,C.ASSETS_MITHRIL_ADDRESS],[10004,C.ASSETS_REDSTONE_ADDRESS],[10005,C.ASSETS_TRUEIRON_ADDRESS]];this.assets_contract=null}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){return _(this,null,function*(){typeof window.ethereum!="undefined"&&(this.assets_contract=new window.web3.eth.Contract(C.WITHDRAW_AND_RECHARGE_ABI,C.WITHDRAW_AND_RECHARGE_ADDRESS))})}depositWallet(t,e){return _(this,null,function*(){if(B.instance.showLoading(!0),!(yield z.instance.allowanceAddressByTokenAddress(C.WITHDRAW_AND_RECHARGE_ADDRESS,t))){B.instance.hideLoading(),at.instance.notice(f.instance.getLanguage(15));return}return e=window.web3.utils.toWei(e+""),yield this.assets_contract.methods.recharge(t.toLowerCase(),e).send({from:z.instance.walletAddress},(a,n)=>{if(a)return B.instance.hideLoading(),!1}),!0})}withdrawToken(t){return _(this,null,function*(){return B.instance.showLoading(!0),yield this.assets_contract.methods.withdrawToken(t.tokenAddress,t.to,t.amount,t.timestamp,t.hash,t.r,t.s,t.v).send({from:z.instance.walletAddress},(e,i)=>{if(e)return B.instance.hideLoading(),!1}),!0})}updateAssetsBalance(){return _(this,null,function*(){he.instance.walletDic==null&&(he.instance.walletDic=new F);for(let t of this.assets_ary){let e=t[0],i=t[1],a=yield z.instance.getERC20TokenBalance(i);a=parseInt(a);let n=he.instance.walletDic.get(e);n||(n=new Ai,n.itemId=e,n.value=0,he.instance.walletDic.set(e,n)),n.ethValue=a}d.intance.event(ae.UPDATE_LOCAL_WALLET_LIST_EVENT)})}updateCwt(t){let e=he.instance.walletDic.get(qt.ASSETS_TOX);e||(e=new Ai,e.itemId=qt.ASSETS_TOX,he.instance.walletDic.set(qt.ASSETS_TOX,e)),e.ethValue=t}};var Ro=Fc(Dl());var ee=class{static getInviteUrl(){return window.location.origin+"?invite="+this.encode(z.instance.walletAddress)}static encode(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=e.length,a=e.split(""),n="",r,o,l,v,I=0;I<t.length;I++)r=t.charCodeAt(I),o=r%i,r=(r-o)/i,l=r%i,r=(r-l)/i,v=r%i,n+=a[v]+a[l]+a[o];return window.btoa(n)}static decode(t){t=window.atob(t);var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=e.length,a,n,r,o,l=0,v;v=new Array(Math.floor(t.length/3)),a=v.length;for(var I=0;I<a;I++)n=e.indexOf(t.charAt(l)),l++,r=e.indexOf(t.charAt(l)),l++,o=e.indexOf(t.charAt(l)),l++,v[I]=n*i*i+r*i+o;return a=decodeCharCode(v.join(",")),a}static getQueryString(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return i!=null?i[2]:""}static getInviteWalletAddress(){let t=this.getQueryString("invite");return t&&(t=this.decode(t)),t}static toWei(t,e){let i=t*_i(10,parseInt(e));return window.web3.utils.toBN("0x"+i.toString(16)).toString()}static fromWei(t,e,i=0){if(!t)return 0;let a=t.length-e+i;if(a<=0)return 0;let n=t.toString().slice(0,a);if(i){let r=n.length-i;if(r<=0){let o="0.";for(let l=0;l<Math.abs(r);l++)o+="0";n=o+n}else n=n.slice(0,n.length-i)+"."+n.slice(n.length-i)}return n}static deepClone(t){let e=new F;for(let i in t)typeof t[i]=="function"?e[i]=t[i]:e[i]=JSON.parse(JSON.stringify(t[i]));return e}};var z=class s{constructor(){this.tokenContract=null;this.hero_contract=null}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){return _(this,null,function*(){if(typeof window.ethereum=="undefined"){at.instance.notice(f.instance.getLanguage("130"));return}mt.instance.sendCustumEvent(10),Mo(),this.tokenContract=new window.web3.eth.Contract(C.TOKEN_ERC20ABI,C.TOX_ADDRESS),this.hero_contract=new window.web3.eth.Contract(C.HERO_ABI,C.HERO_ADDRESS),mt.instance.sendCustumEvent(12),this.registerProxy(),mt.instance.sendCustumEvent(17)})}registerProxy(){return _(this,null,function*(){ti.instance.init()})}getWalletAddress(){return _(this,null,function*(){return this.walletAddress?this.walletAddress:(Mo(),(yield window.ethereum.request({method:"eth_requestAccounts"}))[0])})}dappLogin(){return _(this,null,function*(){console.log("dappLogin this.walletAddress: "+this.walletAddress),mt.instance.sendCustumEvent(13),this.walletAddress=yield this.getWalletAddress(),mt.instance.sendCustumEvent(14),console.log("login to server",1),yield this.signAndLogin(),console.log("login success",1)})}getChainId(){let t="";return typeof window.ethereum=="undefined"&&(t="0x38"),(window.ethereum.chainId+"").indexOf("0x")==-1?t="0x"+window.ethereum.chainId.toString(16):t=window.ethereum.chainId,t!=="0x38"&&t!=="0x61"&&at.instance.notice(f.instance.getLanguage(18)),t}signAndLogin(t=!1){return _(this,null,function*(){console.log("signAndLogin mustSign: "+t);var e=!0;let i=new Date().getTime(),a="",n="",r="",o="";if(X.Debug!=0)e=!1;else if(!t&&localStorage.getItem("TOX-COOKIE"+this.walletAddress)&&X.Debug==0){let k=localStorage.getItem("TOX-COOKIE"+s.instance.walletAddress),q=localStorage.getItem("TOX-COOKIE-CODE"+s.instance.walletAddress);q=ee.decode(q);let Q=q.split("&");i=parseFloat(Q[0]),a=Q[1],n=Q[2],r=Q[3],o=Q[4],k&&i&&a&&n&&r&&o&&(e=!1),console.log("needSign: "+e)}if(e){a=window.web3.utils.randomHex(32),i=new Date().getTime();let k=this.walletAddress+a+i,q=new Ro.default("SHA-256","TEXT",{encoding:"UTF8"});q.update(k);let Q=q.getHash("HEX");console.log("进入签名",1);let H=yield window.web3.eth.personal.sign(Q,this.walletAddress,(Dt,Gt)=>{Dt&&console.log(Dt,1)});console.log("签名结束",1);let Z=H.substring(2);n="0x"+Z.substring(0,64),r="0x"+Z.substring(64,128),o="0x"+Z.substring(128,130)}let l={debug:X.Debug,address:this.walletAddress,time:i,randomHex:a,r:n,s:r,v:o};mt.instance.sendCustumEvent(15);let v=yield tt.requestPost("wxgame/player/login",l,!1,!1);if(v){console.log("服务器登录成功"),mt.instance.sendCustumEvent(16),localStorage.setItem("TOX-COOKIE"+s.instance.walletAddress,v.loginToken);var I=ee.encode(i+"&"+a+"&"+n+"&"+r+"&"+o);localStorage.setItem("TOX-COOKIE-CODE"+s.instance.walletAddress,I)}else V.intance.openModule(p.NoServerView);d.intance.event(b.EVENT_LOGIN_GAME_END,v)})}refreshToken(){return _(this,null,function*(){let t,e=localStorage.getItem("TOX-COOKIE-CODE"+s.instance.walletAddress);e=ee.decode(e);let i=e.split("&"),a=parseFloat(i[0]),n=i[1],r=i[2],o=i[3],l=i[4];if(a&&n&&r&&o&&l){let v={debug:X.Debug,address:this.walletAddress,time:a,randomHex:n,r,s:o,v:l};t=yield tt.requestPost("wxgame/player/getJwt",v,!1,!1).catch(I=>{}),t&&localStorage.setItem("TOX-COOKIE"+s.instance.walletAddress,t.loginToken)}return t})}createAcccount(t,e,i,a){return _(this,null,function*(){console.log("createAcccount");var n=!0;let r=new Date().getTime(),o="",l="",v="",I="";if(X.Debug!=0)n=!1;else{let Q=localStorage.getItem("TOX-COOKIE-CODE"+s.instance.walletAddress);Q=ee.decode(Q);let H=Q.split("&");r=parseFloat(H[0]),o=H[1],l=H[2],v=H[3],I=H[4],r&&o&&l&&v&&I&&(n=!1),console.log("needSign: "+n)}if(n){o=window.web3.utils.randomHex(32),r=new Date().getTime();let Q=this.walletAddress+o+r,H=new Ro.default("SHA-256","TEXT",{encoding:"UTF8"});H.update(Q);let Z=H.getHash("HEX");console.log("进入签名",1);let Dt=yield window.web3.eth.personal.sign(Z,this.walletAddress,(Wt,we)=>{Wt&&console.log(Wt,1)});console.log("签名结束",1);let Gt=Dt.substring(2);l="0x"+Gt.substring(0,64),v="0x"+Gt.substring(64,128),I="0x"+Gt.substring(128,130)}let k,q={name:t,sex:e,icon:i,country:a,debug:X.Debug,address:this.walletAddress,time:r,randomHex:o,r:l,s:v,v:I};if(k=yield tt.requestPost("wxgame/player/create",q,!1,!1).catch(Q=>{}),k){let Q=k.playerDto;return localStorage.setItem("TOX-COOKIE"+s.instance.walletAddress,k.loginToken),Q}return null})}getBalance(){return _(this,null,function*(){return 0})}allowanceAddress(t){return _(this,null,function*(){return(yield this.tokenContract.methods.allowance(this.walletAddress,t).call())=="0"&&(console.log("ERC20 allowance!"),yield this.tokenContract.methods.approve(t,"100000000000000000000000000000000000000000000000").send({from:this.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})),!0})}allowanceAddressByTokenAddress(t,e){return _(this,null,function*(){let i=new window.web3.eth.Contract(C.TOKEN_ERC20ABI,e);return(yield i.methods.allowance(this.walletAddress,t).call())=="0"&&(console.log("ERC20 allowance!"),yield i.methods.approve(t,"100000000000000000000000000000000000000000000000").send({from:this.walletAddress},(n,r)=>{if(n)return B.instance.hideLoading(),!1})),!0})}signature(t){return _(this,null,function*(){return yield window.web3.eth.personal.sign(t,this.walletAddress,(i,a)=>{if(i)return""})})}getERC20TokenBalance(t){return _(this,null,function*(){let i=yield new window.web3.eth.Contract(C.TOKEN_ERC20ABI,t).methods.balanceOf(this.walletAddress).call();return i=window.web3.utils.fromWei(i),i})}getHeroStatus(t){return _(this,null,function*(){return yield this.hero_contract.methods.getStatus(parseInt(t)).call()})}checkHeroIsBuzy(t){return _(this,null,function*(){let e=yield this.getHeroStatus(t);return parseInt(e)?(at.instance.notice(f.instance.getLanguage(19)),!0):!1})}};var Ri=class Ri{constructor(){this.module=0;this.errorCode=0;this.errorMessage=""}protocolId(){return Ri.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeString(e.errorMessage),t.writeInt(e.module))}static read(t){if(!t.readBoolean())return null;let e=new Ri,i=t.readInt();e.errorCode=i;let a=t.readString();e.errorMessage=a;let n=t.readInt();return e.module=n,e}};Ri.PROTOCOL_ID=101;var ko=Ri,ki=ko;var Oi=class Oi{protocolId(){return Oi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new Oi:null}};Oi.PROTOCOL_ID=103;var Oo=Oi,Za=Oo;var Pi=class Pi{constructor(){this.time=0}protocolId(){return Pi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.time)}static read(t){if(!t.readBoolean())return null;let e=new Pi,i=t.readLong();return e.time=i,e}};Pi.PROTOCOL_ID=104;var Po=Pi,Cl=Po;var Ni=class Ni{constructor(){this.pid=0;this.roomId=0;this.loginToken=""}protocolId(){return Ni.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeString(e.loginToken),t.writeLong(e.pid),t.writeLong(e.roomId))}static read(t){if(!t.readBoolean())return null;let e=new Ni,i=t.readString();e.loginToken=i;let a=t.readLong();e.pid=a;let n=t.readLong();return e.roomId=n,e}};Ni.PROTOCOL_ID=1001;var No=Ni,$a=No;var Bi=class Bi{constructor(){this.errorCode=0;this.pid=0;this.matchDto=null}protocolId(){return Bi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writePacket(e.matchDto,25010),t.writeLong(e.pid))}static read(t){if(!t.readBoolean())return null;let e=new Bi,i=t.readInt();e.errorCode=i;let a=t.readPacket(25010);e.matchDto=a;let n=t.readLong();return e.pid=n,e}};Bi.PROTOCOL_ID=1002;var Bo=Bi,tn=Bo;var Hi=class Hi{protocolId(){return Hi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new Hi:null}};Hi.PROTOCOL_ID=1004;var Ho=Hi,en=Ho;var Ui=class Ui{constructor(){this.sequence=0;this.param=""}protocolId(){return Ui.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.sequence),t.writeString(e.param))}static read(t){if(!t.readBoolean())return null;let e=new Ui;if(!t.isReadable())return e;let i=t.readInt();if(e.sequence=i,!t.isReadable())return e;let a=t.readString();return e.param=a,e}};Ui.PROTOCOL_ID=1005;var Uo=Ui,Ml=Uo;var Vi=class Vi{constructor(){this.sequence=0;this.code=0}protocolId(){return Vi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.sequence),t.writeInt(e.code))}static read(t){if(!t.readBoolean())return null;let e=new Vi;if(!t.isReadable())return e;let i=t.readInt();if(e.sequence=i,!t.isReadable())return e;let a=t.readInt();return e.code=a,e}};Vi.PROTOCOL_ID=1006;var Vo=Vi,xl=Vo;var Gi=class Gi{constructor(){this.sequence=0;this.token=""}protocolId(){return Gi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.sequence),t.writeString(e.token))}static read(t){if(!t.readBoolean())return null;let e=new Gi;if(!t.isReadable())return e;let i=t.readInt();if(e.sequence=i,!t.isReadable())return e;let a=t.readString();return e.token=a,e}};Gi.PROTOCOL_ID=1007;var Go=Gi,Al=Go;var Fi=class Fi{constructor(){this.sequence=0;this.errorCode=0}protocolId(){return Fi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.sequence),t.writeInt(e.errorCode))}static read(t){if(!t.readBoolean())return null;let e=new Fi;if(!t.isReadable())return e;let i=t.readInt();if(e.sequence=i,!t.isReadable())return e;let a=t.readInt();return e.errorCode=a,e}};Fi.PROTOCOL_ID=1008;var Fo=Fi,Rl=Fo;var Ki=class Ki{protocolId(){return Ki.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null}static read(t){return t.readBoolean()?new Ki:null}};Ki.PROTOCOL_ID=1010;var Ko=Ki,kl=Ko;var Wi=class Wi{constructor(){this.type=0;this.id=0;this.count=0}protocolId(){return Wi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.type),t.writeInt(e.id),t.writeLong(e.count))}static read(t){if(!t.readBoolean())return null;let e=new Wi;if(!t.isReadable())return e;let i=t.readInt();if(e.type=i,!t.isReadable())return e;let a=t.readInt();if(e.id=a,!t.isReadable())return e;let n=t.readLong();return e.count=n,e}};Wi.PROTOCOL_ID=1012;var Wo=Wi,Ol=Wo;var Yi=class Yi{constructor(){this.x=0;this.y=0;this.speed=0;this.dire=0;this.errorCode=0;this.time=0}protocolId(){return Yi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.dire),t.writeInt(e.errorCode),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new Yi,i=t.readInt();e.dire=i;let a=t.readInt();e.errorCode=a;let n=t.readInt();e.speed=n;let r=t.readLong();e.time=r;let o=t.readInt();e.x=o;let l=t.readInt();return e.y=l,e}};Yi.PROTOCOL_ID=1014;var Yo=Yi,Pl=Yo;var ji=class ji{constructor(){this.type=0;this.member=null}protocolId(){return ji.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writePacket(e.member,25011),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new ji,i=t.readPacket(25011);e.member=i;let a=t.readInt();return e.type=a,e}};ji.PROTOCOL_ID=1016;var jo=ji,an=jo;var Xi=class Xi{constructor(){this.pid=0;this.x=0;this.y=0;this.speed=0;this.dire=0;this.time=0;this.area=0}protocolId(){return Xi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeInt(e.dire),t.writeLong(e.pid),t.writeInt(e.speed),t.writeLong(e.time),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new Xi,i=t.readInt();e.area=i;let a=t.readInt();e.dire=a;let n=t.readLong();e.pid=n;let r=t.readInt();e.speed=r;let o=t.readLong();e.time=o;let l=t.readInt();e.x=l;let v=t.readInt();return e.y=v,e}};Xi.PROTOCOL_ID=1018;var Xo=Xi,nn=Xo;var qi=class qi{constructor(){this.roomId=0;this.rankList=[];this.reward=[]}protocolId(){return qi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writePacketList(e.rankList,25012),t.writePacketList(e.reward,25008),t.writeLong(e.roomId))}static read(t){if(!t.readBoolean())return null;let e=new qi,i=t.readPacketList(25012);e.rankList=i;let a=t.readPacketList(25008);e.reward=a;let n=t.readLong();return e.roomId=n,e}};qi.PROTOCOL_ID=1020;var qo=qi,rn=qo;var zi=class zi{constructor(){this.errorCode=0}protocolId(){return zi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeInt(e.errorCode)}static read(t){if(!t.readBoolean())return null;let e=new zi,i=t.readInt();return e.errorCode=i,e}};zi.PROTOCOL_ID=1022;var zo=zi,Nl=zo;var Qi=class Qi{constructor(){this.attPid=0;this.defPid=0;this.attackValue=[];this.allAtkValue=0;this.bj=!1;this.sb=!1;this.skill=0;this.defHp=0;this.attScore=0;this.defScore=0}protocolId(){return Qi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.allAtkValue),t.writeLong(e.attPid),t.writeLong(e.attScore),t.writeLongList(e.attackValue),t.writeBoolean(e.bj),t.writeLong(e.defHp),t.writeLong(e.defPid),t.writeLong(e.defScore),t.writeBoolean(e.sb),t.writeInt(e.skill))}static read(t){if(!t.readBoolean())return null;let e=new Qi,i=t.readLong();e.allAtkValue=i;let a=t.readLong();e.attPid=a;let n=t.readLong();e.attScore=n;let r=t.readLongList();e.attackValue=r;let o=t.readBoolean();e.bj=o;let l=t.readLong();e.defHp=l;let v=t.readLong();e.defPid=v;let I=t.readLong();e.defScore=I;let k=t.readBoolean();e.sb=k;let q=t.readInt();return e.skill=q,e}};Qi.PROTOCOL_ID=1024;var Qo=Qi,sn=Qo;var Ji=class Ji{constructor(){this.errorCode=0;this.matchDto=null}protocolId(){return Ji.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writePacket(e.matchDto,25010))}static read(t){if(!t.readBoolean())return null;let e=new Ji,i=t.readInt();e.errorCode=i;let a=t.readPacket(25010);return e.matchDto=a,e}};Ji.PROTOCOL_ID=1026;var Jo=Ji,on=Jo;var Zi=class Zi{constructor(){this.pid=0}protocolId(){return Zi.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.pid)}static read(t){if(!t.readBoolean())return null;let e=new Zi,i=t.readLong();return e.pid=i,e}};Zi.PROTOCOL_ID=1028;var Zo=Zi,ln=Zo;var $i=class $i{constructor(){this.pid=0;this.kill=0}protocolId(){return $i.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.kill),t.writeLong(e.pid))}static read(t){if(!t.readBoolean())return null;let e=new $i,i=t.readInt();e.kill=i;let a=t.readLong();return e.pid=a,e}};$i.PROTOCOL_ID=1030;var $o=$i,cn=$o;var ta=class ta{constructor(){this.errorCode=0}protocolId(){return ta.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeInt(e.errorCode)}static read(t){if(!t.readBoolean())return null;let e=new ta,i=t.readInt();return e.errorCode=i,e}};ta.PROTOCOL_ID=1032;var tl=ta,Bl=tl;var ea=class ea{constructor(){this.attId=0;this.defId=0;this.type=0;this.skillId=0;this.param=new Map}protocolId(){return ea.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.attId),t.writeLong(e.defId),t.writeStringStringMap(e.param),t.writeInt(e.skillId),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new ea,i=t.readLong();e.attId=i;let a=t.readLong();e.defId=a;let n=t.readStringStringMap();e.param=n;let r=t.readInt();e.skillId=r;let o=t.readInt();return e.type=o,e}};ea.PROTOCOL_ID=1034;var el=ea,un=el;var ia=class ia{constructor(){this.errorCode=0;this.time=0}protocolId(){return ia.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.errorCode),t.writeLong(e.time))}static read(t){if(!t.readBoolean())return null;let e=new ia,i=t.readInt();e.errorCode=i;let a=t.readLong();return e.time=a,e}};ia.PROTOCOL_ID=1036;var il=ia,Hl=il;var aa=class aa{constructor(){this.targetId=0;this.targetX=0;this.targetY=0;this.sourceId=0;this.skillId=0;this.time=0}protocolId(){return aa.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.skillId),t.writeLong(e.sourceId),t.writeLong(e.targetId),t.writeInt(e.targetX),t.writeInt(e.targetY),t.writeLong(e.time))}static read(t){if(!t.readBoolean())return null;let e=new aa,i=t.readInt();e.skillId=i;let a=t.readLong();e.sourceId=a;let n=t.readLong();e.targetId=n;let r=t.readInt();e.targetX=r;let o=t.readInt();e.targetY=o;let l=t.readLong();return e.time=l,e}};aa.PROTOCOL_ID=1038;var al=aa,pn=al;var na=class na{constructor(){this.time=0}protocolId(){return na.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||t.writeLong(e.time)}static read(t){if(!t.readBoolean())return null;let e=new na,i=t.readLong();return e.time=i,e}};na.PROTOCOL_ID=1040;var nl=na,mn=nl;var ra=class ra{constructor(){this.id=0;this.value=!1}protocolId(){return ra.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.id),t.writeBoolean(e.value))}static read(t){if(!t.readBoolean())return null;let e=new ra,i=t.readInt();e.id=i;let a=t.readBoolean();return e.value=a,e}};ra.PROTOCOL_ID=25007;var rl=ra,Ul=rl;var sa=class sa{constructor(){this.type=0;this.id=0;this.count=0}protocolId(){return sa.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeDouble(e.count),t.writeLong(e.id),t.writeInt(e.type))}static read(t){if(!t.readBoolean())return null;let e=new sa,i=t.readDouble();e.count=i;let a=t.readLong();e.id=a;let n=t.readInt();return e.type=n,e}};sa.PROTOCOL_ID=25008;var sl=sa,Vl=sl;var oa=class oa{constructor(){this.id=0;this.map=0;this.maxX=0;this.maxY=0;this.players=[]}protocolId(){return oa.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.id),t.writeInt(e.map),t.writeInt(e.maxX),t.writeInt(e.maxY),t.writePacketList(e.players,25011))}static read(t){if(!t.readBoolean())return null;let e=new oa,i=t.readLong();e.id=i;let a=t.readInt();e.map=a;let n=t.readInt();e.maxX=n;let r=t.readInt();e.maxY=r;let o=t.readPacketList(25011);return e.players=o,e}};oa.PROTOCOL_ID=25009;var ol=oa,Gl=ol;var la=class la{constructor(){this.arenaId=0;this.coinType=0;this.roomId=0;this.members=[];this.remainderCd=0;this.startTime=0;this.nowTime=0}protocolId(){return la.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.arenaId),t.writeInt(e.coinType),t.writePacketList(e.members,25011),t.writeLong(e.nowTime),t.writeLong(e.remainderCd),t.writeLong(e.roomId),t.writeLong(e.startTime))}static read(t){if(!t.readBoolean())return null;let e=new la,i=t.readInt();e.arenaId=i;let a=t.readInt();e.coinType=a;let n=t.readPacketList(25011);e.members=n;let r=t.readLong();e.nowTime=r;let o=t.readLong();e.remainderCd=o;let l=t.readLong();e.roomId=l;let v=t.readLong();return e.startTime=v,e}};la.PROTOCOL_ID=25010;var ll=la,Fl=ll;var ca=class ca{constructor(){this.id=0;this.x=0;this.y=0;this.dire=0;this.speed=0;this.heroId=0;this.heroColor=0;this.name="";this.icon="";this.leader=0;this.kill=0;this.hp=0;this.maxHp=0;this.atk=0;this.score=0;this.skillCd=new Map;this.commonCd=0;this.area=0}protocolId(){return ca.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeInt(e.area),t.writeLong(e.atk),t.writeLong(e.commonCd),t.writeInt(e.dire),t.writeInt(e.heroColor),t.writeLong(e.heroId),t.writeLong(e.hp),t.writeString(e.icon),t.writeLong(e.id),t.writeInt(e.kill),t.writeInt(e.leader),t.writeLong(e.maxHp),t.writeString(e.name),t.writeLong(e.score),t.writeIntLongMap(e.skillCd),t.writeInt(e.speed),t.writeInt(e.x),t.writeInt(e.y))}static read(t){if(!t.readBoolean())return null;let e=new ca,i=t.readInt();e.area=i;let a=t.readLong();e.atk=a;let n=t.readLong();e.commonCd=n;let r=t.readInt();e.dire=r;let o=t.readInt();e.heroColor=o;let l=t.readLong();e.heroId=l;let v=t.readLong();e.hp=v;let I=t.readString();e.icon=I;let k=t.readLong();e.id=k;let q=t.readInt();e.kill=q;let Q=t.readInt();e.leader=Q;let H=t.readLong();e.maxHp=H;let Z=t.readString();e.name=Z;let Dt=t.readLong();e.score=Dt;let Gt=t.readIntLongMap();e.skillCd=Gt;let Wt=t.readInt();e.speed=Wt;let we=t.readInt();e.x=we;let gi=t.readInt();return e.y=gi,e}};ca.PROTOCOL_ID=25011;var cl=ca,Kl=cl;var ua=class ua{constructor(){this.id=0;this.heroId=0;this.heroColor=0;this.name="";this.icon="";this.leader=0;this.rankNum=0;this.kill=0;this.atk=0;this.score=0;this.die=!1}protocolId(){return ua.PROTOCOL_ID}static write(t,e){t.writePacketFlag(e)||e==null||(t.writeLong(e.atk),t.writeBoolean(e.die),t.writeInt(e.heroColor),t.writeLong(e.heroId),t.writeString(e.icon),t.writeLong(e.id),t.writeInt(e.kill),t.writeInt(e.leader),t.writeString(e.name),t.writeInt(e.rankNum),t.writeLong(e.score))}static read(t){if(!t.readBoolean())return null;let e=new ua,i=t.readLong();e.atk=i;let a=t.readBoolean();e.die=a;let n=t.readInt();e.heroColor=n;let r=t.readLong();e.heroId=r;let o=t.readString();e.icon=o;let l=t.readLong();e.id=l;let v=t.readInt();e.kill=v;let I=t.readInt();e.leader=I;let k=t.readString();e.name=k;let q=t.readInt();e.rankNum=q;let Q=t.readLong();return e.score=Q,e}};ua.PROTOCOL_ID=25012;var ul=ua,Wl=ul;var lt=new Map;lt.set(101,ki);lt.set(103,Za);lt.set(104,Cl);lt.set(1001,$a);lt.set(1002,tn);lt.set(1004,en);lt.set(1005,Ml);lt.set(1006,xl);lt.set(1007,Al);lt.set(1008,Rl);lt.set(1010,kl);lt.set(1012,Ol);lt.set(1013,za);lt.set(1014,Pl);lt.set(1016,an);lt.set(1018,nn);lt.set(1020,rn);lt.set(1021,Xa);lt.set(1022,Nl);lt.set(1024,sn);lt.set(1025,qa);lt.set(1026,on);lt.set(1028,ln);lt.set(1030,cn);lt.set(1031,ja);lt.set(1032,Bl);lt.set(1034,un);lt.set(1035,Qa);lt.set(1036,Hl);lt.set(1038,pn);lt.set(1040,mn);lt.set(25007,Ul);lt.set(25008,Vl);lt.set(25009,Gl);lt.set(25010,Fl);lt.set(25011,Kl);lt.set(25012,Wl);var pl=class s{static getProtocol(t){let e=lt.get(t);if(e===null)throw"[protocolId:"+t+"]协议不存在";return e}static write(t,e){let i=e.protocolId();t.writeInt(i),s.getProtocol(i).write(t,e)}static read(t){let e=t.readInt();return s.getProtocol(e).read(t)}},Kt=pl;var Yl={},jl={},ne;try{ne=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(s){}var E=class E{constructor(t,e,i=!1){this.low=t|0,this.high=e|0,this.unsigned=i}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*ii+(this.low>>>0):this.high*ii+(this.low>>>0)}toString(t=10){if(t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.equals(E.MIN_VALUE)){let n=E.fromNumber(t),r=this.divide(n),o=r.multiply(n).subtract(this);return r.toString(t)+o.toInt().toString(t)}else return"-"+this.negate().toString(t);let e=E.fromNumber(Math.pow(t,6),this.unsigned),i="",a=this;for(;;){let n=a.divide(e),o=(a.subtract(n.multiply(e)).toInt()>>>0).toString(t);if(a=n,a.isZero())return o+i;for(;o.length<6;)o="0"+o;i=""+o+i}}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.equals(E.MIN_VALUE)?64:this.negate().getNumBitsAbs();let t=this.high!=0?this.high:this.low,e;for(e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1}isZero(){return this.high===0&&this.low===0}isNegative(){return!this.unsigned&&this.high<0}isPositive(){return this.unsigned||this.high>=0}isOdd(){return(this.low&1)===1}isEven(){return(this.low&1)===0}equals(t){return t instanceof E||(t=E.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low}notEquals(t){return!this.equals(t)}lessThan(t){return this.compare(t)<0}lessThanOrEqual(t){return this.compare(t)<=0}greaterThan(t){return this.compare(t)>0}greaterThanOrEqual(t){return this.compare(t)>=0}compare(t){if(t instanceof E||(t=E.fromValue(t)),this.equals(t))return 0;let e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.subtract(t).isNegative()?-1:1}negate(){return!this.unsigned&&this.equals(E.MIN_VALUE)?E.MIN_VALUE:this.not().add(E.ONE)}add(t){t instanceof E||(t=E.fromValue(t));let e=this.high>>>16,i=this.high&65535,a=this.low>>>16,n=this.low&65535,r=t.high>>>16,o=t.high&65535,l=t.low>>>16,v=t.low&65535,I=0,k=0,q=0,Q=0;return Q+=n+v,q+=Q>>>16,Q&=65535,q+=a+l,k+=q>>>16,q&=65535,k+=i+o,I+=k>>>16,k&=65535,I+=e+r,I&=65535,E.fromBits(q<<16|Q,I<<16|k,this.unsigned)}subtract(t){return t instanceof E||(t=E.fromValue(t)),this.add(t.negate())}multiply(t){if(this.isZero())return E.ZERO;if(t instanceof E||(t=E.fromValue(t)),ne){let H=ne.mul(this.low,this.high,t.low,t.high);return E.fromBits(H,ne.get_high(),this.unsigned)}if(t.isZero())return E.ZERO;if(this.equals(E.MIN_VALUE))return t.isOdd()?E.MIN_VALUE:E.ZERO;if(t.equals(E.MIN_VALUE))return this.isOdd()?E.MIN_VALUE:E.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(zl)&&t.lessThan(zl))return E.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);let e=this.high>>>16,i=this.high&65535,a=this.low>>>16,n=this.low&65535,r=t.high>>>16,o=t.high&65535,l=t.low>>>16,v=t.low&65535,I=0,k=0,q=0,Q=0;return Q+=n*v,q+=Q>>>16,Q&=65535,q+=a*v,k+=q>>>16,q&=65535,q+=n*l,k+=q>>>16,q&=65535,k+=i*v,I+=k>>>16,k&=65535,k+=a*l,I+=k>>>16,k&=65535,k+=n*o,I+=k>>>16,k&=65535,I+=e*v+i*l+a*o+n*r,I&=65535,E.fromBits(q<<16|Q,I<<16|k,this.unsigned)}divide(t){if(t instanceof E||(t=E.fromValue(t)),t.isZero())throw Error("division by zero");if(ne){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;let n=(this.unsigned?ne.div_u:ne.div_s)(this.low,this.high,t.low,t.high);return E.fromBits(n,ne.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?E.UZERO:E.ZERO;let e,i,a;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.greaterThan(this))return E.UZERO;if(t.greaterThan(this.shiftRightUnsigned(1)))return E.UONE;a=E.UZERO}else{if(this.equals(E.MIN_VALUE))return t.equals(E.ONE)||t.equals(E.NEG_ONE)?E.MIN_VALUE:t.equals(E.MIN_VALUE)?E.ONE:(e=this.shiftRight(1).divide(t).shiftLeft(1),e.equals(E.ZERO)?t.isNegative()?E.ONE:E.NEG_ONE:(i=this.subtract(t.multiply(e)),a=e.add(i.divide(t)),a));if(t.equals(E.MIN_VALUE))return this.unsigned?E.UZERO:E.ZERO;if(this.isNegative())return t.isNegative()?this.negate().divide(t.negate()):this.negate().divide(t).negate();if(t.isNegative())return this.divide(t.negate()).negate();a=E.ZERO}for(i=this;i.greaterThanOrEqual(t);){e=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));let n=Math.ceil(Math.log(e)/Math.LN2),r=n<=48?1:Math.pow(2,n-48),o=E.fromNumber(e),l=o.multiply(t);for(;l.isNegative()||l.greaterThan(i);)e-=r,o=E.fromNumber(e,this.unsigned),l=o.multiply(t);o.isZero()&&(o=E.ONE),a=a.add(o),i=i.subtract(l)}return a}modulo(t){if(t instanceof E||(t=E.fromValue(t)),ne){let e=(this.unsigned?ne.rem_u:ne.rem_s)(this.low,this.high,t.low,t.high);return E.fromBits(e,ne.get_high(),this.unsigned)}return this.subtract(this.divide(t).multiply(t))}not(){return E.fromBits(~this.low,~this.high,this.unsigned)}and(t){return t instanceof E||(t=E.fromValue(t)),E.fromBits(this.low&t.low,this.high&t.high,this.unsigned)}or(t){return t instanceof E||(t=E.fromValue(t)),E.fromBits(this.low|t.low,this.high|t.high,this.unsigned)}xor(t){return t instanceof E||(t=E.fromValue(t)),E.fromBits(this.low^t.low,this.high^t.high,this.unsigned)}shiftLeft(t){if(t instanceof E&&(t=t.toInt()),(t&=63)===0)return this;if(t<32){let e=this.low<<t;return E.fromBits(e,this.high<<t|this.low>>>32-t,this.unsigned)}else return E.fromBits(0,this.low<<t-32,this.unsigned)}shiftRight(t){return t instanceof E&&(t=t.toInt()),(t&=63)===0?this:t<32?E.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):E.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)}shiftRightUnsigned(t){return t instanceof E&&(t=t.toInt()),(t&=63)===0?this:t<32?E.fromBits(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):t===32?E.fromBits(this.high,0,this.unsigned):E.fromBits(this.high>>>t-32,0,this.unsigned)}rotateLeft(t){let e;return t instanceof E&&(t=t.toInt()),(t&=63)===0?this:t===32?E.fromBits(this.high,this.low,this.unsigned):t<32?(e=32-t,E.fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(t-=32,e=32-t,E.fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))}rotateRight(t){let e;return t instanceof E&&(t=t.toInt()),(t&=63)===0?this:t===32?E.fromBits(this.high,this.low,this.unsigned):t<32?(e=32-t,E.fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(t-=32,e=32-t,E.fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))}toSigned(){return this.unsigned?E.fromBits(this.low,this.high,!1):this}toUnsigned(){return this.unsigned?this:E.fromBits(this.low,this.high,!0)}toBytes(t){return t?this.toBytesLE():this.toBytesBE()}toBytesLE(){let t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]}toBytesBE(){let t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]}static fromBytes(t,e,i){return i?E.fromBytesLE(t,e):E.fromBytesBE(t,e)}static fromBytesLE(t,e){return new E(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)}static fromBytesBE(t,e){return new E(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}static fromInt(t,e){let i;if(e){if(t>>>=0,i=0<=t&&t<256){let n=jl[t];if(n)return n}let a=E.fromBits(t,(t|0)<0?-1:0,!0);return i&&(jl[t]=a),a}else{if(t|=0,i=-128<=t&&t<128){let n=Yl[t];if(n)return n}let a=E.fromBits(t,t<0?-1:0,!1);return i&&(Yl[t]=a),a}}static fromNumber(t,e){if(isNaN(t))return e?E.UZERO:E.ZERO;if(e){if(t<0)return E.UZERO;if(t>=Ql)return E.MAX_UNSIGNED_VALUE}else{if(t<=-ql)return E.MIN_VALUE;if(t+1>=ql)return E.MAX_VALUE}return t<0?E.fromNumber(-t,e).negate():E.fromBits(t%ii|0,t/ii|0,e)}static fromBits(t,e,i){return new E(t,e,i)}static fromString(t,e,i){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return E.ZERO;if(typeof e=="number"?(i=e,e=!1):e=!!e,i=i||10,i<2||36<i)throw RangeError("radix");let a;if((a=t.indexOf("-"))>0)throw Error("interior hyphen");if(a===0)return E.fromString(t.substring(1),e,i).negate();let n=E.fromNumber(Math.pow(i,8)),r=E.ZERO;for(let o=0;o<t.length;o+=8){let l=Math.min(8,t.length-o),v=parseInt(t.substring(o,o+l),i);if(l<8){let I=E.fromNumber(Math.pow(i,l));r=r.multiply(I).add(E.fromNumber(v))}else r=r.multiply(n),r=r.add(E.fromNumber(v))}return r.unsigned=e,r}static fromValue(t,e){return typeof t=="number"?E.fromNumber(t,e):typeof t=="string"?E.fromString(t,e):E.fromBits(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}};E.ZERO=E.fromInt(0),E.UZERO=E.fromInt(0,!0),E.ONE=E.fromInt(1),E.UONE=E.fromInt(1,!0),E.NEG_ONE=E.fromInt(-1),E.MAX_VALUE=E.fromBits(-1,2147483647,!1),E.MAX_UNSIGNED_VALUE=E.fromBits(-1,-1,!0),E.MIN_VALUE=E.fromBits(0,-2147483648,!1);var ai=E,Xl=65536,Xc=1<<24,ii=Xl*Xl,Ql=ii*ii,ql=Ql/2,zl=ai.fromInt(Xc);var pa=class s{constructor(t,e){this.lo=t>>>0,this.hi=e>>>0}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}toLong(t){return new ai(this.lo|0,this.hi|0,!!t)}static from(t){return typeof t=="number"?s.fromNumber(t):((typeof t=="string"||t instanceof String)&&(t=ai.fromString(t)),t.low||t.high?new s(t.low>>>0,t.high>>>0):Jl)}static fromNumber(t){if(t===0)return Jl;let e=t<0;e&&(t=-t);let i=t>>>0,a=(t-i)/4294967296>>>0;return e&&(a=~a>>>0,i=~i>>>0,++i>4294967295&&(i=0,++a>4294967295&&(a=0))),new s(i,a)}},Jl=new pa(0,0);function qc(s,t){let e=0;for(;t.hi;)s.writeByte(t.lo&127|128),t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7,e=e+7;for(;t.lo>127;){if(e>=56){s.writeByte(t.lo);return}s.writeByte(t.lo&127|128),t.lo=t.lo>>>7,e=e+7}s.writeByte(t.lo)}function zc(s){let t=new pa(0,0),e=0,i=s.length,a=0;if(i-a>4){for(;e<4;++e)if(t.lo=(t.lo|(s[a]&127)<<e*7)>>>0,s[a++]<128)return t;if(t.lo=(t.lo|(s[a]&127)<<28)>>>0,t.hi=(t.hi|(s[a]&127)>>4)>>>0,s[a++]<128)return t;e=0}else{for(;e<3;++e)if(t.lo=(t.lo|(s[a]&127)<<e*7)>>>0,s[a++]<128)return t;return t.lo=(t.lo|(s[a++]&127)<<e*7)>>>0,t}for(;e<4;++e){if(a===8)return t.hi=(t.hi|s[a]<<e*7+3)>>>0,t;if(t.hi=(t.hi|(s[a]&127)<<e*7+3)>>>0,s[a++]<128)return t}return t}function Zl(s,t){let e=pa.from(t).zzEncode();qc(s,e)}function $l(s){return zc(s).zzDecode().toLong(!1)}var tc="",Qc=128,Jc=655537,Zc=32767,$c=-32768,ec=2147483647,ic=-2147483648,tu=new TextEncoder,eu=new TextDecoder;function iu(s,t){if(s.byteLength>t)throw new Error("newLength is too small");let e=new ArrayBuffer(t);return new Uint8Array(e).set(new Uint8Array(s)),e}function au(s){return s<<1^s>>31}function nu(s){return s>>>1^-(s&1)}var ml=class{constructor(){this.writeOffset=0,this.readOffset=0,this.buffer=new ArrayBuffer(Qc),this.bufferView=new DataView(this.buffer,0,this.buffer.byteLength)}setWriteOffset(t){if(t>this.buffer.byteLength)throw new Error("index out of bounds exception:readerIndex:"+this.readOffset+", writerIndex:"+this.writeOffset+"(expected:0 <= readerIndex <= writerIndex <= capacity:"+this.buffer.byteLength);this.writeOffset=t}setReadOffset(t){if(t>this.writeOffset)throw new Error("index out of bounds exception:readerIndex:"+this.readOffset+", writerIndex:"+this.writeOffset+"(expected:0 <= readerIndex <= writerIndex <= capacity:"+this.buffer.byteLength);this.readOffset=t}getCapacity(){return this.buffer.byteLength-this.writeOffset}ensureCapacity(t){for(;t-this.getCapacity()>0;){let e=this.buffer.byteLength*2;if(e>Jc)throw new Error("out of memory error");this.buffer=iu(this.buffer,e),this.bufferView=new DataView(this.buffer,0,this.buffer.byteLength)}}isReadable(){return this.writeOffset>this.readOffset}writeBytes(t){let e=t.byteLength;this.ensureCapacity(e),new Uint8Array(this.buffer).set(new Uint8Array(t),this.writeOffset),this.writeOffset+=e}toBytes(){let t=new ArrayBuffer(this.writeOffset);return new Uint8Array(t).set(new Uint8Array(this.buffer.slice(0,this.writeOffset))),t}writeBoolean(t){if(!(t===!0||t===!1))throw new Error("value must be true of false");this.ensureCapacity(1),t===!0?this.bufferView.setInt8(this.writeOffset,1):this.bufferView.setInt8(this.writeOffset,0),this.writeOffset++}readBoolean(){let t=this.bufferView.getInt8(this.readOffset);return this.readOffset++,t===1}writeByte(t){this.ensureCapacity(1),this.bufferView.setInt8(this.writeOffset,t),this.writeOffset++}readByte(){let t=this.bufferView.getInt8(this.readOffset);return this.readOffset++,t}writeShort(t){if(!($c<=t&&t<=Zc))throw new Error("value must range between minShort:-32768 and maxShort:32767");this.ensureCapacity(2),this.bufferView.setInt16(this.writeOffset,t),this.writeOffset+=2}readShort(){let t=this.bufferView.getInt16(this.readOffset);return this.readOffset+=2,t}writeRawInt(t){if(!(ic<=t&&t<=ec))throw new Error("value must range between minInt:-2147483648 and maxInt:2147483647");this.ensureCapacity(4),this.bufferView.setInt32(this.writeOffset,t),this.writeOffset+=4}readRawInt(){let t=this.bufferView.getInt32(this.readOffset);return this.readOffset+=4,t}writeInt(t){if(!(ic<=t&&t<=ec))throw new Error("value must range between minInt:-2147483648 and maxInt:2147483647");if(this.ensureCapacity(5),t=au(t),!(t>>>7)){this.writeByte(t);return}if(!(t>>>14)){this.writeByte(t&127|128),this.writeByte(t>>>7);return}if(!(t>>>21)){this.writeByte(t&127|128),this.writeByte(t>>>7|128),this.writeByte(t>>>14);return}if(!(t>>>28)){this.writeByte(t&127|128),this.writeByte(t>>>7|128),this.writeByte(t>>>14|128),this.writeByte(t>>>21);return}this.writeByte(t&127|128),this.writeByte(t>>>7|128),this.writeByte(t>>>14|128),this.writeByte(t>>>21|128),this.writeByte(t>>>28)}readInt(){let t=this.readByte(),e=t&127;return t&128&&(t=this.readByte(),e|=(t&127)<<7,t&128&&(t=this.readByte(),e|=(t&127)<<14,t&128&&(t=this.readByte(),e|=(t&127)<<21,t&128&&(t=this.readByte(),e|=(t&127)<<28)))),nu(e)}writeLong(t){if(t==null)throw new Error("value must not be null");this.ensureCapacity(9),Zl(this,t)}readLong(){let t=new ArrayBuffer(9),e=new DataView(t,0,t.byteLength),i=0,a=this.readByte();return e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a),a&128&&(a=this.readByte(),e.setUint8(i++,a))))))))),$l(new Uint8Array(t.slice(0,i))).toNumber()}writeFloat(t){if(t==null)throw new Error("value must not be null");this.ensureCapacity(4),this.bufferView.setFloat32(this.writeOffset,t),this.writeOffset+=4}readFloat(){let t=this.bufferView.getFloat32(this.readOffset);return this.readOffset+=4,t}writeDouble(t){if(t==null)throw new Error("value must not be null");this.ensureCapacity(8),this.bufferView.setFloat64(this.writeOffset,t),this.writeOffset+=8}readDouble(){let t=this.bufferView.getFloat64(this.readOffset);return this.readOffset+=8,t}writeChar(t){if(t==null||t.length===0){this.writeString(tc);return}this.writeString(t.charAt(0))}readChar(){return this.readString()}writeString(t){if(t==null||t.trim().length===0){this.writeInt(0);return}let e=tu.encode(t);this.ensureCapacity(5+e.length),this.writeInt(e.length),e.forEach(i=>this.writeByte(i))}readString(){let t=this.readInt();if(t<=0)return tc;let e=new Uint8Array(this.buffer.slice(this.readOffset,this.readOffset+t)),i=eu.decode(e);return this.readOffset+=t,i}writePacketFlag(t){let e=t==null;return this.writeBoolean(!e),e}writePacket(t,e){Kt.getProtocol(e).write(this,t)}readPacket(t){return Kt.getProtocol(t).read(this)}writeBooleanArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeBoolean(e)}))}readBooleanArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readBoolean());return t}writeByteArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeByte(e)}))}readByteArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readByte());return t}writeShortArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeShort(e)}))}readShortArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readShort());return t}writeIntArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeInt(e)}))}readIntArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readInt());return t}writeLongArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeLong(e)}))}readLongArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readLong());return t}writeFloatArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeFloat(e)}))}readFloatArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readFloat());return t}writeDoubleArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeDouble(e)}))}readDoubleArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readDouble());return t}writeStringArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeString(e)}))}readStringArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readString());return t}writeCharArray(t){t===null?this.writeInt(0):(this.writeInt(t.length),t.forEach(e=>{this.writeChar(e)}))}readCharArray(){let t=[],e=this.readInt();if(e>0)for(let i=0;i<e;i++)t.push(this.readChar());return t}writePacketArray(t,e){if(t===null)this.writeInt(0);else{let i=Kt.getProtocol(e);this.writeInt(t.length),t.forEach(a=>{i.write(this,a)})}}readPacketArray(t){let e=[],i=this.readInt();if(i>0){let a=Kt.getProtocol(t);for(let n=0;n<i;n++)e.push(a.read(this))}return e}writeBooleanList(t){this.writeBooleanArray(t)}readBooleanList(){return this.readBooleanArray()}writeByteList(t){this.writeByteArray(t)}readByteList(){return this.readByteArray()}writeShortList(t){this.writeShortArray(t)}readShortList(){return this.readShortArray()}writeIntList(t){this.writeIntArray(t)}readIntList(){return this.readIntArray()}writeLongList(t){this.writeLongArray(t)}readLongList(){return this.readLongArray()}writeFloatList(t){this.writeFloatArray(t)}readFloatList(){return this.readFloatArray()}writeDoubleList(t){this.writeDoubleArray(t)}readDoubleList(){return this.readDoubleArray()}writeStringList(t){this.writeStringArray(t)}readStringList(){return this.readStringArray()}writeCharList(t){this.writeCharArray(t)}readCharList(){return this.readCharArray()}writePacketList(t,e){this.writePacketArray(t,e)}readPacketList(t){return this.readPacketArray(t)}writeBooleanSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeBoolean(e)}))}readBooleanSet(){return new Set(this.readBooleanArray())}writeByteSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeByte(e)}))}readByteSet(){return new Set(this.readByteArray())}writeShortSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeShort(e)}))}readShortSet(){return new Set(this.readShortArray())}writeIntSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeInt(e)}))}readIntSet(){return new Set(this.readIntArray())}writeLongSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeLong(e)}))}readLongSet(){return new Set(this.readLongArray())}writeFloatSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeFloat(e)}))}readFloatSet(){return new Set(this.readFloatArray())}writeDoubleSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeDouble(e)}))}readDoubleSet(){return new Set(this.readDoubleArray())}writeStringSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeString(e)}))}readStringSet(){return new Set(this.readStringArray())}writeCharSet(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach(e=>{this.writeChar(e)}))}readCharSet(){return new Set(this.readCharArray())}writePacketSet(t,e){if(t===null)this.writeInt(0);else{let i=Kt.getProtocol(e);this.writeInt(t.size),t.forEach(a=>{i.write(this,a)})}}readPacketSet(t){return new Set(this.readPacketArray(t))}writeIntIntMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeInt(i),this.writeInt(e)}))}readIntIntMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readInt(),n=this.readInt();t.set(a,n)}return t}writeIntLongMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeInt(i),this.writeLong(e)}))}readIntLongMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readInt(),n=this.readLong();t.set(a,n)}return t}writeIntStringMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeInt(i),this.writeString(e)}))}readIntStringMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readInt(),n=this.readString();t.set(a,n)}return t}writeIntPacketMap(t,e){if(t===null)this.writeInt(0);else{let i=Kt.getProtocol(e);this.writeInt(t.size),t.forEach((a,n)=>{this.writeInt(n),i.write(this,a)})}}readIntPacketMap(t){let e=new Map,i=this.readInt();if(i>0){let a=Kt.getProtocol(t);for(let n=0;n<i;n++){let r=this.readInt(),o=a.read(this);e.set(r,o)}}return e}writeLongIntMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeLong(i),this.writeInt(e)}))}readLongIntMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readLong(),n=this.readInt();t.set(a,n)}return t}writeLongLongMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeLong(i),this.writeLong(e)}))}readLongLongMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readLong(),n=this.readLong();t.set(a,n)}return t}writeLongStringMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeLong(i),this.writeString(e)}))}readLongStringMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readLong(),n=this.readString();t.set(a,n)}return t}writeLongPacketMap(t,e){if(t===null)this.writeInt(0);else{let i=Kt.getProtocol(e);this.writeInt(t.size),t.forEach((a,n)=>{this.writeLong(n),i.write(this,a)})}}readLongPacketMap(t){let e=new Map,i=this.readInt();if(i>0){let a=Kt.getProtocol(t);for(let n=0;n<i;n++){let r=this.readLong(),o=a.read(this);e.set(r,o)}}return e}writeStringIntMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeString(i),this.writeInt(e)}))}readStringIntMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readString(),n=this.readInt();t.set(a,n)}return t}writeStringLongMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeString(i),this.writeLong(e)}))}readStringLongMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readString(),n=this.readLong();t.set(a,n)}return t}writeStringStringMap(t){t===null?this.writeInt(0):(this.writeInt(t.size),t.forEach((e,i)=>{this.writeString(i),this.writeString(e)}))}readStringStringMap(){let t=new Map,e=this.readInt();if(e>0)for(let i=0;i<e;i++){let a=this.readString(),n=this.readString();t.set(a,n)}return t}writeStringPacketMap(t,e){if(t===null)this.writeInt(0);else{let i=Kt.getProtocol(e);this.writeInt(t.size),t.forEach((a,n)=>{this.writeString(n),i.write(this,a)})}}readStringPacketMap(t){let e=new Map,i=this.readInt();if(i>0){let a=Kt.getProtocol(t);for(let n=0;n<i;n++){let r=this.readString(),o=a.read(this);e.set(r,o)}}return e}},hl=ml;var Ot=class Ot{constructor(){this.m_iConnectTimes=0;this.m_iMaxTimes=10;this.m_iHeartTime=6e4;this.isMatching=!1;this.m_socket=new Laya.Socket,this.m_socket.on(Laya.Event.OPEN,this,this.onSocketOpen),this.m_socket.on(Laya.Event.CLOSE,this,this.onSocketClose),this.m_socket.on(Laya.Event.MESSAGE,this,this.onMessageReveived),this.m_socket.on(Laya.Event.ERROR,this,this.onConnectError)}static get instance(){return Ot._instance==null&&(Ot._instance=new Ot),Ot._instance}initSocket(){this.isMatching=!0;var t=W.instance.roomDto.connectAddr;Ot.m_strHttpHost=t,this.reconnect()}onSocketOpen(){this.isConnect=!0,this.m_iConnectTimes=0,$t.log("websocket----websocket connected",1),this.onLogin()}onLogin(){let t=new $a;t.roomId=W.instance.roomDto.roomId,t.loginToken=localStorage.getItem("TOX-COOKIE"+z.instance.walletAddress),t.pid=S.instance.playerDto.pid,this.sendData(t)}onSocketClose(t){console.log("websocket----closed"),this.isMatching&&(this.isOtherLogin||(this.isConnect=!1,console.log("websocket----closed m_iConnectTimes:"+this.m_iConnectTimes+", m_iMaxTimes: "+this.m_iMaxTimes),this.m_iConnectTimes<=this.m_iMaxTimes?Laya.timer.once(1500,this,function(){Ot.instance.reconnect(),Ot.instance.m_iConnectTimes++}):B.instance.hideLoading()))}onConnectError(t){console.log("websocket----onConnectError e:"+ +t),this.isMatching&&(this.isOtherLogin||(this.isConnect=!1,this.m_iConnectTimes<=this.m_iMaxTimes?Laya.timer.once(1500,this,function(){Ot.instance.reconnect(),Ot.instance.m_iConnectTimes++}):B.instance.hideLoading()))}reconnect(){console.log("websocket----reconnect: "+Ot.m_strHttpHost),this.isMatching&&(this.m_socket.connectByUrl(Ot.m_strHttpHost),console.log("websocket----connect websocket"))}onSendMessage(){}sendData(t){if(this.isMatching)if(this.isConnect){let e=new hl;e.setWriteOffset(4),Kt.write(e,t),e.writeBoolean(!1);let i=e.writeOffset;e.setWriteOffset(0),e.writeRawInt(i-4),e.setWriteOffset(i),this.m_socket.send(e.buffer),console.log(_t.GetLogTime+" websocket ------>>>>>>>> send message PROTOCOL_ID:"+t.protocolId()+"，内容："+JSON.stringify(t))}else $t.log("socket send error： "+JSON.stringify(t))}onMessageReveived(t){return _(this,null,function*(){let e=t,i=new hl;i.writeBytes(e),i.setReadOffset(4);let a=Kt.read(i),n=a.protocolId();console.log(_t.GetLogTime+" websocket ------<<<<<<<< recv PROTOCOL_ID: "+n+"，内容："+JSON.stringify(a));let r=a.errorCode;if(r&&r>0){console.warn("errorCode "+r+", errorMessage： "+vt.instance.get(r)),r==9&&(d.intance.event(b.EVENT_CLOSE_MODULE,p.EnterRoomView),ot.intance.currSceneName!=J.M_SCENE_MATCH&&ot.intance.setCurrentScene(J.M_SCENE_MAIN),_t.errorCodeTip(vt.instance.get(r)));return}switch(d.intance.event("msg_"+n,[e]),n){case tn.PROTOCOL_ID:console.log("收到了登录返回");let o=a;W.instance.matchDto=o.matchDto,ot.intance.setCurrentScene(J.M_SCENE_MATCH);break;case mn.PROTOCOL_ID:console.log("收到比赛开始数据");let l=a;V.intance.disposeView(p.MatchReadyView),W.instance.stopAll=!1;break;case nn.PROTOCOL_ID:console.log("收到移动数据");let v=a;A.instance.onRevMovePush(v);break;case pn.PROTOCOL_ID:console.log("收到推人移动数据");let I=a;A.instance.onRevTargetMovePush(I);break;case sn.PROTOCOL_ID:console.log("收到伤害数据");let k=a;A.instance.onRevAttackPush(k);break;case un.PROTOCOL_ID:console.log("收到动画数据");let q=a;A.instance.onRevAnimationPush(q);break;case an.PROTOCOL_ID:console.log("收到玩家加入或离开数据");let Q=a;A.instance.addPlayer(Q);break;case ln.PROTOCOL_ID:console.log("收到第一滴血数据");let H=a;d.intance.event(b.EVENT_FirstBlood,[H]);break;case cn.PROTOCOL_ID:console.log("收到多杀数据");let Z=a;d.intance.event(b.EVENT_MutiKill,[Z]);break;case rn.PROTOCOL_ID:console.log("收到比赛结束");let Dt=a;W.instance.matchDto&&W.instance.matchDto.roomId==Dt.roomId&&(A.instance.onGoMatchEndRank(Dt.rankList),W.instance.reward=Dt.reward,this.isMatching=!1);break;case on.PROTOCOL_ID:console.log("收到了恢复数据返回");let Gt=a;A.instance.onRevRestorePush(Gt.matchDto);break;case ki.PROTOCOL_ID:console.log("收到了错误信息返回");let Wt=new ki;Object.assign(Wt,a),console.log("errorMessage： "+Wt.errorMessage),vt.instance.showErrByString(Wt.errorMessage);break;case en.PROTOCOL_ID:this.isOtherLogin=!0,Laya.timer.clearAll(this),_t.otherLogin(),console.log("websocket----------------------------otherLogin");break;case Ot.CMD_20001:let we=S.instance.playerDto;Object.assign(we,e),d.intance.event(b.ACCOUNTVO_UPDATE),console.log("accout----------------------------update");break;case Ot.CMD_10099:B.instance.hideLoading(),d.intance.event("SET_HERO_POSTION_SUCCESS"),console.log("formation----------------------------update");break;default:break}})}sendHeart(){this.m_socket.connected&&this.sendData(new Za)}};Ot.m_strHttpHost=getWSServer(),Ot.CMD_99999=99999,Ot.CMD_20001=20001,Ot.CMD_10099=10099;var It=Ot;var et=class et{constructor(){this._isSending=!1;this._stopSending=!1;this._sendCmd=0;this._callDataArr=[],this._httpReq=new Laya.HttpRequest,this._httpReq.http.timeout=15e3,this._httpReq.http.ontimeout=this.timeoutFunction,this._httpReq.on(Laya.Event.COMPLETE,this,this.reqCompleteHandler),this._httpReq.on(Laya.Event.ERROR,this,this.reqErrorHandler),this._httpReq.on(Laya.Event.PROGRESS,this,this.reqProcessHandler),et.RepeatHandler=Laya.Handler.create(this,this.repeatCallHandler,null,!1)}static get instance(){return et._instance||(et._instance=new et),et._instance}repeatCallHandler(){let t=this._callDataArr[0];t&&(t.needReSend?(this._callDataArr.shift(),this._sendByByte(t.command,t.callData,t.isShowLoading,!0)):this._callDataArr.shift())}timeoutFunction(){et.ErrorIndex++,this._sendCmd==2,et.timeoutTimes<et.MaxSendTimes,et.timeoutTimes++,et._IS_SEND=!1,this._isSending=!1,et.ErrorIndex>=et.RepeatTimesTimeOut?(B.instance.hideLoading(),et.ErrorTips=f.instance.getLanguage("5076"),V.intance.openModule(p.ClientErrView)):et.RepeatHandler.run()}reqCompleteHandler(t){let e=Laya.Browser.now()-this.m_nSendTime;if(e&&e>et.RequestTime?(et.reqTimes<et.MaxSendTimes,et.reqTimes++):(et.reqTimes=0,et.timeoutTimes=0,et.errorTimes=0),console.log("cmd time："+(Laya.Browser.now()-this.m_nSendTime)),this._httpReq.data==null){vt.instance.showErrByString("_buff:null");return}this._isSending=!1,et.ErrorIndex=0;let i=new Laya.Byte(this._httpReq.data),a;if(i){let n=new Ne,r=n.ReadString(i);$e.instance.analyCookie(r);let o=n.ReadByte(i);for(let l=0;l<o;l++){n.ReadByte(i);let v=n.ReadShort(i),I=n.ReadBytes(i,i.pos+v);if(i.pos+=v,I.length<2)continue;I.pos=0;let k=n.ReadBytes(I,I.length);k.pos=0;let q=new Uint8Array(k.buffer),Q=new Uint8Array(ru(q)),H=new Laya.Byte(Q.buffer);H.pos=0;let Z=$e.instance.analyServer(H);Laya.LayaEnv.isConch?console.log("REVC_CMD: cmdID:"+Z[0]+" data:"+Z,1):console.log(_t.GetLogTime+" REVC_CMD: cmdID:",Z[0],Z),Z[0]==153&&console.log("......"),Z[0]==27&&(Z[1]==2e4||Z[1]==20042)&&(a=!0),d.intance.event("msg_"+Z.shift(),[Z])}o==0&&console.log("REVC_DATA: NO_DATA",1)}if(this._callDataArr.length>0){let n=this._callDataArr.shift();a&&n&&n.callBackHandler!=null&&n.callBackHandler.run()}et._IS_SEND=!1,this._callDataArr.length>0?et.RepeatHandler.run():B.instance.hideLoading()}reqErrorHandler(t){console.log("[error] HttpNetService reqError: ["+t+"]",1),et.errorTimes<et.MaxSendTimes&&this._sendCmd==2,et.errorTimes++,B.instance.showLoadingByInfo(f.instance.getLanguage(5205)),et.ErrorIndex++,et._IS_SEND=!1,this._isSending=!1,et.ErrorIndex>=et.RepeatTimes?(B.instance.hideLoading(),et.ErrorTips=f.instance.getLanguage("5075"),V.intance.openModule(p.ClientErrView),this._callDataArr.length=0):Laya.timer.once(1e3,this,function(){et.RepeatHandler.run()})}reqProcessHandler(t){}DataToService(t){Laya.LayaEnv.isConch?this._httpReq.send(X.server,t.buffer,"post","arraybuffer",["Content-Type","application/x-www-form-urlencoded","Connection","close"]):this._httpReq.send(X.server,t.buffer,"post","arraybuffer",["Content-Type","application/x-www-form-urlencoded"])}SendData(t,e,i=null,a=!0,n=!0){this._stopSending||(this.m_nSendTime=Laya.Browser.now(),et.ErrorIndex=0,n&&this._callDataArr.push({command:t,callData:e,callBackHandler:i,isShowLoading:a,needReSend:n}),this._sendByByte(t,e,a,!1))}_sendByByte(t,e,i=!0,a=!1){this._sendCmd=t,this._sendCmd==2,It.instance.sendData({cmd:t,code:"",data:e})}reSendData(){this._callDataArr.length>0&&et.RepeatHandler.run()}sendOutHandler(){Laya.timer.clear(this,this.sendOutHandler),this._isSending&&(this._isSending=!1,et.ErrorIndex>=et.RepeatTimes?(B.instance.hideLoading(),et.ErrorTips="Client Error!",V.intance.openModule(p.ClientErrView),this._callDataArr.length=0):et.RepeatHandler.run())}EnCodeByte(t){t.pos=0;let i=new Ne().ReadBytes(t,t.length);i.pos=0;let a=new Laya.Byte,n=0,r,o=0;for(let l=0;l<i.length;l++)n>=6?n=1:n+=1,r=i.getByte(),o=r,r>>=8-n,o<<=n,o|=r,o^=3,a.writeByte(o);return a}DecryptByte(t){t.pos=0;let i=new Ne().ReadBytes(t,t.length);i.pos=0;let a=new Laya.Byte,n=0,r,o=new Uint8Array(i.buffer);for(let l=0;l<o.length;l++)n>=6?n=1:n+=1,r=o[l],r^=3,r<<=8-n,o[l]^=3,o[l]>>=n,o[l]|=r;return a=new Laya.Byte(o.buffer),a}init(){}HttpLoadProcess(t){}httpLoadComplete(t){$e.instance.analyData=t}dispose(){}set stopSending(t){this._stopSending=t}};et._IS_SEND=!1,et.ErrorIndex=0,et.RepeatTimes=8,et.RepeatTimesTimeOut=3,et.ErrorTips="",et.LoginTime=5e3,et.RequestTime=4e3,et.MaxSendTimes=5,et.reqTimes=0,et.timeoutTimes=0,et.errorTimes=0;var re=et;function ru(s){throw new Error("Function not implemented.")}var Bt=class extends Laya.Event{constructor(){super()}};Bt.INIT_SUIT_EVENT="HeroEvent:INIT_SUIT_EVENT",Bt.EVENT_FIND_ITEM_CLICK="HeroEvent:EVENT_FIND_ITEM_CLICK",Bt.EVENT_RELEASE_ITEM_CLICK="HeroEvent:EVENT_RELEASE_ITEM_CLICK",Bt.EVENT_FINISH="HeroEvent:EVENT_FINISH",Bt.EVENT_START="HeroEvent:EVENT_START",Bt.EVENT_AGAIN="HeroEvent:EVENT_AGAIN",Bt.EVENT_ENABLE_TIJIAO="HeroEvent:EVENT_ENABLE_TIJIAO",Bt.EVENT_HUMANSTAY="HeroEvent:EVENT_HUMANSTAY",Bt.EVENT_STOPGAME="HeroEvent:EVENT_STOPGAME",Bt.EVENT_RESTORE="HeroEvent:EVENT_RESTORE",Bt.EVENT_CANCEL_RESTORE="HeroEvent:EVENT_CANCEL_RESTORE",Bt.EVENT_COLLISIONENTER="HeroEvent:EVENT_COLLISIONENTER",Bt.EVENT_HERO_DRAW_UPDATE_PRODUCTION="HeroEvent:EVENT_HERO_DRAW_UPDATE_PRODUCTION",Bt.SELECT_UI="HeroEvent:SELECT_UI";var hn=class extends pt{constructor(){super()}};var dn=class extends pt{constructor(){super()}};var zt=class s{constructor(){this._inited=!1;this._initUpgrade=!1;this.heroList=[];this.init()}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){this._inited||(this._inited=!0)}initUpgrade(){if(!this._initUpgrade){let t=j.intance;t.m_dicHeroLv||(t.m_dicHeroLv=t.initConfig("hero_lv",["hero_lv","hero_star","race"],dn)),t.m_dicHeroAttup||(t.m_dicHeroAttup=t.initConfig("hero_attup",["star_lv","race"],hn)),this._initUpgrade=!0}}getHead(t){let e=Math.floor(Math.random()*3)+1;return"common/common_icon/img_"+t+"_"+e+".png"}getNextHero(t){let e=S.instance.m_heroData.heroVoDic.keys.indexOf(t.pk);return S.instance.m_heroData.heroVoDic.keys.length===1?null:e<=S.instance.m_heroData.heroVoDic.keys.length-2?S.instance.m_heroData.heroVoDic.values[e+1]:null}getLastHero(t){let e=S.instance.m_heroData.heroVoDic.keys.indexOf(t.pk);return e>0?S.instance.m_heroData.heroVoDic.values[e-1]:null}setStar(t,e){console.log("setStar: _star "+e);let i=parseInt(e);var a=Math.floor(i/6),n=i%6,r=a+n;let o=0;for(let I=0;I<a;I++)t["img_star"+(I+1)].skin="gameIcon/hero/heroDetail/img_star_2.png",t["img_star"+(I+1)].visible=!0;for(let I=a;I<n;I++)t["img_star"+(I+1)].skin="gameIcon/hero/heroDetail/img_star_1.png",t["img_star"+(I+1)].visible=!0;for(let I=r;I<5;I++)t["img_star"+(I+1)].visible=!1;let l=t.box_star.width,v=46;r==1?t["img_star1"].x=l/2-o:r==2?(t["img_star1"].x=l/2-v/2-o,t["img_star2"].x=l/2+v/2-o):r==3?(t["img_star1"].x=l/2-o,t["img_star2"].x=l/2-v-o,t["img_star3"].x=l/2+v-o):r==4?(t["img_star1"].x=l/2-v/2-o,t["img_star2"].x=l/2+v/2-o,t["img_star3"].x=l/2-v*(1/2+1)-o,t["img_star4"].x=l/2+v*(1/2+1)-o):(t["img_star1"].x=l/2-o,t["img_star2"].x=l/2-v-o,t["img_star3"].x=l/2+v-o,t["img_star4"].x=l/2-v*2-o,t["img_star5"].x=l/2+v*2-o)}getRoundName(t){let e=f.instance.getLanguage(10014,16,8);return t==4?e=f.instance.getLanguage(10014,2,1):t==3?e=f.instance.getLanguage(10014,4,2):t==2&&(e=f.instance.getLanguage(10014,8,4)),e}};var ni=class{};var yn=class{};var Pt=class s{constructor(){this.mail_contract=null}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){typeof window.ethereum!="undefined"&&(this.mail_contract=new window.web3.eth.Contract(C.BLINDBOX_ABI,C.BLINDBOX_ADDRESS))}initData(){return _(this,null,function*(){this.mailList=new F,B.instance.showLoading(!0);let t=yield this.mail_contract.methods.getPricesLength().call();for(let e=0;e<t;e++){let i=yield this.mail_contract.methods.getPriceByIndex(e).call(),a=new ni;a.type=1,a.idx=e,Object.assign(a,i),this.mailList.set(a.idx,a),a.showPrice=window.web3.utils.fromWei(a.currentPrice+"")}B.instance.hideLoading()})}hasFree(){return _(this,null,function*(){return(yield this.mail_contract.methods.getIsFreeOpen().call())?!(yield this.mail_contract.methods.hasFreeHero(z.instance.walletAddress).call()):!1})}recruit(t){return _(this,null,function*(){let e=j.intance.m_dicShops.get(t),i=e.cost[1],a=yield z.instance.getBalance(),n=yield tt.requestPost("wxgame/hero/heroBuy",{shopId:e.id},!0,!0);n&&(ft.instance.autoPop=!1,S.instance.herosDataUpdataHandler(n.reward),n.resChange&&S.instance.moneyInfoHander(n.resChange),n.fightHeroPk&&(S.instance.playerDto.fightHeroPk=n.fightHeroPk),B.instance.hideLoading())})}recruitItem(t,e){return _(this,null,function*(){let i=j.intance.m_dicShops.get(t),a=i.cost[1],n=yield z.instance.getBalance(),r=yield tt.requestPost("wxgame/hero/itemBuy",{shopId:i.id,count:e},!0,!0);r&&(S.instance.itemsDataUpdataHandler(r.reward,!1),r.resChange&&S.instance.moneyInfoHander(r.resChange),r.fightHeroPk&&(S.instance.playerDto.fightHeroPk=r.fightHeroPk),B.instance.hideLoading())})}recruitFree(){return _(this,null,function*(){B.instance.showLoading(!0),this.isOpen=yield this.mail_contract.methods.getIsOpen().call();let t=yield this.hasFree();if(!this.isOpen){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(12)]);return}if(!t){d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(17)]);return}yield this.mail_contract.methods.recruitFree().send({from:z.instance.walletAddress},(e,i)=>{if(e){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(16)]);return}})})}ownerHero(){return _(this,null,function*(){let t=yield tt.requestPost("wxgame/hero/heroList",{},!0,!0);S.instance.m_heroData.initData(t.heroList),console.log("HERO LIST")})}ownerBag(){return _(this,null,function*(){let t=yield tt.requestPost("wxgame/hero/bagList",{},!0,!0);S.instance.m_packageData.initData(t.data),console.log("BAG LIST")})}heroOutputRate(){return _(this,null,function*(){if(zt.instance.heroOutputRateDic)return;let t=yield tt.requestPost("cybertron-sys-api/api/v1/heroes/heroOutputRate",{},!0);zt.instance.heroOutputRateDic=new F;for(let e of t){let i=new yn;Object.assign(i,e),zt.instance.heroOutputRateDic.set(i.mineralLevel,i)}console.log("HERO heroOutputRate"),d.intance.event(Bt.EVENT_HERO_DRAW_UPDATE_PRODUCTION)})}makeHeroVo(t){let e=new jt;return Object.assign(e,t),e}};var gn=class{constructor(){this.heroVoDic=new F}initData(t){this.heroVoDic||(this.heroVoDic=new F);let e;for(let a=0;a<t.length;a++){e=new jt;var i=t[a];e.id=i.id,e.lv=i.lv,e.pk=i.pk,e.color=i.color,this.pushItem(e)}console.log("@@@@@@@@@@@@@@@@@@-----------------------------------------packVo: ")}updateData(t){console.dir("更新英雄："+t),this.updataItemVoByArr(t)}pushItem(t){this.heroVoDic.set(t.pk,t)}removeItem(t){this.heroVoDic.remove(t.pk)}updataItemVoByArr(t,e=!1){let i=[],a=!1,n;for(let r=0;r<t.length;r++){n=t[r];let o=this.heroVoDic.get(n.pk);o==null?(o=new jt,o.id=n.id,o.pk=n.pk,o.lv=n.lv,o.color=n.color,o.m_bNew=!0,o.newAddCnt=1,o.newAddCnt>0&&this.pushItem(o)):o.newAddCnt=1,o.isLvUp=e,i.push(o.pk),o.m_iNum<=0&&this.removeItem(o),o.newAddCnt>0&&ft.instance.needPop&&(ft.instance.addHeroItem(o),a=!0)}a&&ft.instance.needPop&&ft.instance.autoPop&&Zt.instance.startShow(),i.length>0&&d.intance.event(b.PACKAGE_UPDATE_ITEM,[i])}getItemById(t){return this.heroVoDic.get(t)}};var S=class s{constructor(){this.timeZoneOff=0;this.hearIntervalSceond=10*60;this._timeStamp=0;this._m_strLanguage=1;this.isLanChanged=!1;this.lastTimestamp=0;this._m_serverTime=0;this.M_S_VersionServer="1.0.0";this.headId=10001;this.countryId=1e3;this.initReceiveExp=!0;this.needPopError=!0}initData(){return _(this,null,function*(){mt.instance.sendCustumEvent(20),yield Pt.instance.ownerHero(),yield Pt.instance.ownerBag(),mt.instance.sendCustumEvent(21)})}addMail(t){this.mailVoDic||(this.mailVoDic=new F),this.mailVoDic.set(t.id,t)}get m_serverTime(){let t=Date.now();return this._m_serverTime+(t-this.lastTimestamp)}set m_serverTime(t){this._m_serverTime=t,this.lastTimestamp=Date.now()}get m_strLanguage(){return this._m_strLanguage}set m_strLanguage(t){this._m_strLanguage=t}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){this.vipInfo=new Ka,this.m_packageData=new Ut,this.m_heroData=new gn,this.systemOpenModel=new Fa,this.m_dicCustomerVo=new F,d.intance.on("msg_27",this,this.commonErrHandler),d.intance.on("msg_7",this,this.roleLeveHandler),d.intance.on("msg_11",this,this.vipInfoHandler),d.intance.on("msg_13",this,this.onVipUpgrade),d.intance.on("msg_6",this,this.moneyInfoHander),d.intance.on("msg_90",this,this.initSystemOpen),d.intance.on("msg_161",this,this.reciveTurnoverVo),d.intance.on("msg_333",this,this.onInitSceneBg),d.intance.on("msg_350",this,this.onInitStoreDiscount),d.intance.on("msg_388",this,this.onInitTitle),d.intance.on("msg_1002",this,this.onLanChange)}initSend(){}onLanChange(t){let e=parseInt(t[0]),i=parseInt(t[1]);switch(e){case 1:i==1&&mt.instance.reload();break;case 2:break}}get timeStamp(){return this._timeStamp+(Laya.Browser.now()-this.recordStampTime)/1e3}set timeStamp(t){this.recordStampTime=Laya.Browser.now(),this._timeStamp=t}onReciveBuyTimes(t){s.instance.playerDto.updateRoleBuyTimes(t)}reciveTurnoverVo(t){}onInitSceneBg(t){}onInitTitle(t){}getAdRankById(t){return this.m_adRankDic&&this.m_adRankDic.get(t)?this.m_adRankDic.get(t):""}onGetPvpGrade(t){let e=t[0]}onInitStoreDiscount(t){}getRealExp(t){return parseInt(t.exp)-parseInt(t.nowExp)}getRealNextExp(t){return parseInt(t.nextExp)-parseInt(t.nowExp)}reciveBuyCustomerMsg(t){}onInitStyleAndTag(t){let e=t[0];for(let i=0;i<e.length;i++){let a=e[i],n=a[0],r=a[1],o=a[2]}}reciveFriendList(t){}reciveFirstRecharge(t){}hasReceiveFirst(){return this.firstRechargeState.toString()=="3"}recieveOnlineAward(t){}initFriendsGiftHandler(t){}initSystemOpen(t){this.systemOpenModel.initSystemOpen(t[0])}updateSystemOpen(t){let e=t[0];Wa.instance.addNewOpenFun(e);for(let i=0;i<e.length;i++)this.systemOpenModel.openSystem.set(e[i],!0)}serverTimeUpdateHandler(){let t=this.hearIntervalSceond*1e3;Laya.timer.loop(t,this,this.onHear)}onHear(){}initMainTaskHandler(t){}itemsDataUpdataHandler(t,e){this.m_packageData.updateData(t,e),d.intance.event(b.EVENT_ITEM_UPDATE)}herosDataUpdataHandler(t){this.m_heroData.updateData(t)}itemsDataInitHandler(t){this.m_packageData.initData(t)}vipInfoHandler(t){this.vipInfo.trecharge=t[1],this.vipInfo.isRewards=t[2],this.vipInfo.daygift=t[3]}onVipUpgrade(t){}getConsumeValue(t){t=parseInt(t.toString());var e=this.playerDto.coins[t];return e>0?e:0}hasEnoughMoney(t,e,i=!0){switch(t=parseInt(t.toString()),e=parseInt(e.toString()),t){default:return this.playerDto.coins[t]<e&&i&&d.intance.event("open_buy",4),this.playerDto.coins[t]>=e}}moneyInfoHander(t,e=!0,i=!0){let a=!1,n=!1,r=0;for(let o of t)n=!1,o[0]==Et.TYPE_EXP?(r=parseInt(o[1]+"")-this.playerDto.exp,this.playerDto.exp=parseInt(o[1]+""),n=r>0):(r=parseFloat(o[1]+"")-this.playerDto.coins[o[0]],this.playerDto.coins[o[0]]=parseFloat(o[1]+""),n=r>0),n&&ft.instance.needPop&&i&&(a=!0,ft.instance.addConsumeByServer([o[0],r]));e&&d.intance.event(b.ROLE_INFO_CHANGE),a&&ft.instance.autoPop&&Zt.instance.startShow()}roleLeveHandler(t){let e=this.playerDto.lv>0&&this.playerDto.lv!=t[0],i=this.playerDto.lv;this.playerDto.lv=t[0],this.playerDto.trueiron=t[1];let a=this.playerDto.lv;this.playerDto.deltaExp>0&&ft.instance.needPop&&!this.initReceiveExp&&ft.instance.addConsumeByServer([Et.TYPE_EXP,this.playerDto.deltaExp]),ft.instance.autoPop&&!this.initReceiveExp&&Zt.instance.startShow(),this.initReceiveExp=!1,e&&(d.intance.event(b.ROLE_INFO_CHANGE),d.intance.event(b.EVENT_OPEN_MODULE,[p.RoleUpgradeView]))}initGuideHandler(t){let e=t[0],i=t[1];X.UseGuide==!1&&(e=0,i=[100,110,120,130,140,150,160,190,200,210,220,230,232,235,245,250,260,270,280,290,293,296,300,310,330])}commonErrHandler(t){if(B.instance.hideLoading(),parseInt(t[0])==2e4){this.needPopError&&(vt.instance.showErrorWord(parseInt(t[0])),d.intance.event(b.RECIVE_SUCESS_SERVICE));return}else if(parseInt(t[0])==20008){d.intance.event("open_buy",1);return}else if(parseInt(t[0])==20007){d.intance.event("open_buy",2);return}else if(parseInt(t[0])==20015){d.intance.event("open_buy",3);return}else if(parseInt(t[0])==20016){d.intance.event("open_buy",4);return}else if(parseInt(t[0])==10021){re.ErrorTips=vt.instance.get(10021),V.intance.openModule(p.ClientErrView);return}else if(parseInt(t[0])==10023){re.ErrorTips=vt.instance.get(10023),V.intance.openModule(p.ClientErrView);return}else if(parseInt(t[0])==10019){re.ErrorTips=vt.instance.get(10019),V.intance.openModule(p.ClientErrView);return}else if(parseInt(t[0])!=20053){if(parseInt(t[0])==10002){re.ErrorTips=f.instance.getLanguage(5085),V.intance.openModule(p.ClientErrView);return}}vt.instance.showErrorWord(parseInt(t[0])),console.log("Server Error Code:"+t[0])}dispose(){}parseNumber(t){let e=[];for(let i=0;i<t.length;i++){let a=t[i];a=this.dividedNumber(a),e.push(a.toString())}return e}dividedNumber(t){return t/1e4}};var bn=class extends pt{constructor(){super()}};var ri=class{constructor(t,e,i){this._idKeyName="";this._jsonName="";this._sheetItemCls=null;this._isParse=!1;this._idKeyName=e,this._jsonName=t,this._sheetItemCls=i,this._idToValueMap=new F,this._items=[]}parseJson(){if(this._isParse)return;let t=R.instance.getResByURL("config/"+this._jsonName+".json");if(!t)throw new Error("无效的配置数据"+this._jsonName);for(let e of t){let i=new this._sheetItemCls;i.beFill(e),this._idToValueMap.set(e[this._idKeyName],i),this._items.push(i),this.addItemProcess(i)}this._isParse=!0}addItemProcess(t){}getItemById(t){return this.excuteIsParse()&&this._idToValueMap.get(t)?this._idToValueMap.get(t):null}getAllItems(){return this.excuteIsParse()?this._items:null}excuteIsParse(){return this._isParse,this._isParse}};var fn=class extends ri{constructor(){super("","","");this._itemsTypeMap=null;this._itemsTypeMap=new F}getCombineKey(e,i,a){return e+a.toString()+i}getItemsByChildType(e,i){let a=this.getCombineKey(e,i,"childType_itemType");if(this._itemsTypeMap.get(a))return this._itemsTypeMap.get(a);this._itemsTypeMap.set(a,[]);let n=j.intance.m_dicItems.values;for(let r of n)r.child_type==e&&r.itm_type==i&&this._itemsTypeMap.get(a).push(r);return this._itemsTypeMap.get(a)}};var Ln=class extends pt{realIcon(){return"https://cdn.bunnyswap.cc/images/items/"+this.icon}get starArr(){if(this._starArr)return this._starArr;if(this._starArr=[],this.max_quality==0)return this._starArr;let e=this.quality/this.max_quality*5;for(let i=1;i<=5;i++)e>=i?this._starArr.push(0):i-e<=.5?this._starArr.push(2):this._starArr.push(1);return this._starArr}};var _n=class extends pt{};var vn=class{constructor(){}beFill(t){for(let e in t)if(this.hasOwnProperty(e)){let i=t[e];i instanceof String&&String(i).indexOf("[[")>=0&&(i=JSON.parse(i)),this[e]=i}}converNumberStrArr(t){let e=[];for(let i=0;i<t.length;i++)e.push(parseInt(t[i]));return e}};var wn=class extends vn{constructor(){super();this._childtypeL=""}get icon(){return this._icon}set icon(e){this._icon=e}get childtype(){return this._childtypeL==""&&(this._childtypeL=f.instance.getLanguage(this._childtype)),this._childtypeL}set childtype(e){this._childtype=e}get childtypeID(){return this._childtypeID}set childtypeID(e){this._childtypeID=e}get if_use(){return this._if_use}set if_use(e){this._if_use=e}};var In=class extends ri{constructor(){super("catagory_childtype","childtypeID",wn);this._beautySalonUpgradeItems=null;this._beautySalonSkinItems=null;this._beautySalonFeaturesItems=null;this._beautySlonHairItems=null}getBeautySalonUpgradeItems(){return this._beautySalonUpgradeItems?this._beautySalonUpgradeItems:(this._beautySalonUpgradeItems=[],this._beautySalonUpgradeItems.push(this.getItemById(Rt.MODEL)),this._beautySalonUpgradeItems=this._beautySalonUpgradeItems.concat(this.getHairTabItems()),this._beautySalonUpgradeItems)}getSkinTabItems(){return this._beautySalonSkinItems?this._beautySalonSkinItems:(this._beautySalonSkinItems=[],this._beautySalonSkinItems.push(this.getItemById(Rt.SkinColor)),this._beautySalonSkinItems.push(this.getItemById(Rt.FACE_TYPE)),this._beautySalonSkinItems)}getFeaturesTabItems(){return this._beautySalonFeaturesItems?this._beautySalonFeaturesItems:(this._beautySalonFeaturesItems=[],this._beautySalonFeaturesItems.push(this.getItemById(Rt.Eye)),this._beautySalonFeaturesItems.push(this.getItemById(Rt.Nose)),this._beautySalonFeaturesItems.push(this.getItemById(Rt.Mouse)),this._beautySalonFeaturesItems.push(this.getItemById(Rt.Eyebrow)),this._beautySalonFeaturesItems.push(this.getItemById(Rt.EYE_ZHU)),this._beautySalonFeaturesItems)}isSalonFeatureType(e){return e=parseInt(e.toString()),e==Rt.Eye||e==Rt.Nose||e==Rt.Mouse||e==Rt.Eyebrow||e==Rt.EYE_ZHU}getHairTabItems(){return this._beautySlonHairItems?this._beautySlonHairItems:(this._beautySlonHairItems=[],this._beautySlonHairItems)}};var Sn=class extends pt{};var En=class extends pt{constructor(){super()}};var Tn=class extends pt{constructor(){super()}};var Dn=class extends pt{};var Cn=class extends pt{};var Mn=class extends pt{};var xn=class extends pt{};var An=class extends pt{constructor(){super()}};var Rn=class extends pt{};var Vt=class Vt{get m_fragrances(){if(this._m_fragrances)return this._m_fragrances;this._m_fragrances=[];for(let t of this.m_dicItems.values)t&&t.child_type+""==Rt.FRAGRANCE+""&&this._m_fragrances.push(t);return this._m_fragrances}set m_fragrances(t){this._m_fragrances=t}constructor(){if(Vt._instance)throw new Error("SheetDataManager是单例,不可new.");Vt._instance=this,this._modelList=new F}static get intance(){return Vt._instance||(Vt._instance=new Vt),Vt._instance}resetTokenData(){this.m_dicItems.get(1e4).tokenId=C.TOX_ADDRESS,this.m_dicItems.get(10001).tokenId=C.ASSETS_ARCANITE_ADDRESS,this.m_dicItems.get(10002).tokenId=C.ASSETS_CRYSTAL_ADDRESS,this.m_dicItems.get(10003).tokenId=C.ASSETS_MITHRIL_ADDRESS,this.m_dicItems.get(10004).tokenId=C.ASSETS_REDSTONE_ADDRESS,this.m_dicItems.get(10005).tokenId=C.ASSETS_TRUEIRON_ADDRESS,this.m_dicMaps.get(1).tokenId=C.STAKING_ARCANITE_ADDRESS,this.m_dicMaps.get(2).tokenId=C.STAKING_CRYSTAL_ADDRESS,this.m_dicMaps.get(3).tokenId=C.STAKING_MITHRIL_ADDRESS,this.m_dicMaps.get(4).tokenId=C.STAKING_REDSTONE_ADDRESS,this.m_dicMaps.get(5).tokenId=C.STAKING_TRUEIRON_ADDRESS,this.mapsCallBack()}init(){let t=Laya.Browser.now();S.instance.systemOpenModel.parseJson(),this.m_dicItems=this.initConfigObject("item",Ln),this.m_dicShops=this.initConfig("shop",["id"],Sn),this.m_dicUnions=this.initConfig("union",["id"],Rn),this.m_dicHeros=this.initConfigObject("hero",Dn),this.m_dicSkills=this.initConfigObject("skill",Mn),this.m_dicBuffs=this.initConfigObject("buff",xn),this.m_dicArenaDic=new F,this.m_dicArenaMulDic=this.initConfig("arena",["lv","coinType"],Cn,!0,Laya.Handler.create(this,this.onSetArena,null,!1)),this.m_dicMaps=this.initConfigObject("map",_n),this.mapsCallBack(),console.log("-----------------------sheetdata-time1:"+(Laya.Browser.now()-t)),this.m_dicHead=this.initConfig("head",["id"],Tn),this.m_dicCountry=this.initConfig("country",["id"],An),this.m_dicGenerate=this.initConfigObject("general",bn),this.m_dicWorldMapChildTypeItem=new F,console.log("-----------------------sheetdata-time2:"+(Laya.Browser.now()-t))}mapsCallBack(){this.m_dicTokenMaps=new F;for(let t of this.m_dicMaps.values)t&&this.m_dicTokenMaps.set(t.tokenId,t)}onSetArena(t){this.m_dicArenaDic.set(t.id,t)}preInit(){this.m_dicScene=this.initConfig("scene",["name"],En)}getItemModel(){return this.getDataModel(Vt.DataType_Items)}getGeneralValueById(t){return this.m_dicGenerate&&this.m_dicGenerate.get(t)?this.m_dicGenerate.get(t).value:0}getSocialShareValueById(t){return this.m_dicSocialShare&&this.m_dicSocialShare.get(t)?this.m_dicSocialShare.get(t).parameter:0}getDataModel(t){if(!this._modelList.get(t))switch(t){case Vt.DataType_Items:this._modelList.set(t,new fn);break;case Vt.DataType_CatagoryChildType:this._modelList.set(t,new In);break}return this._modelList.get(t)}static getArrFromDictionary(t,e,i){let a=[];for(let n=0;n<t.values.length;n++)t.values[n][e]+""==i+""&&a.push(t.values[n]);return a}getArrFromDicItemByKey(t,e){let i=[];for(let a=0;a<this.m_dicItems.values.length;a++)this.m_dicItems.values[a][t]+""==e+""&&i.push(this.m_dicItems.values[a]);return i}initConfigObject(t,e=null,i=null){let a="config/"+t+".json";console.log("initConfigObject： url: "+a);let n=R.instance.getResByURL(a).data;return new Je(n,e)}initConfig(t,e,i=null,a=!1,n=null){let r="config/"+t+".json";console.log("initConfig url: "+r);let o=R.instance.getResByURL(r).data,l=new F;if(!o)return console.log("ERROR : SheetDataManager -->initConfig()  url:"+r),l;let v;for(let I=0;I<o.length;I++){let k=this.compoundKey(o[I],e);i?(v=new i,v.init==null&&console.log("ERROR :BaseItem> SheetDataManager -->initConfig()  url:"+r),v.init(o[I]),l.set(k,v),n&&n.runWith(v)):(l.set(k,o[I]),n&&n.runWith(o[I]))}if(a){let I=R.instance.setResURL(r);Laya.Loader.clearRes(I)}return l}compoundKey(t,e){let i="",a=e.length;if(a>1)for(let n=0;n<a;n++)i+=t[e[n]],n!=a-1&&(i+="_");else i=t[e[0]];return i}getCompoundKey(t){let e="",i=t.length;if(i>1)for(let a=0;a<i;a++)e+=t[a],a!=i-1&&(e+="_");else e=t[0];return e}initConfig2(t,e,i,a=!0){let n="config/"+t+".json",r=R.instance.getResByURL(n).data,o=new F;if(!r)return console.log("ERROR : SheetDataManager -->initConfig2()  url:"+n),o;let l;for(let v=0;v<r.length;v++){let I=r[v][e],k;o.get(I)==null?(k=[],o.set(I,k)):k=o.get(I),l=new i,l.init==null&&console.log("ERROR :<BaseItem> SheetDataManager -->initConfig2()  url:"+n),l.init(r[v]),k.push(l)}if(a&&t!="items"){let v=R.instance.setResURL(n);Laya.Loader.clearRes(v)}return o}getItemsBy(t,e){let i=this.getArrFromDicItemByKey("itm_type",t),a=[];for(let n of i)n.child_type.toString()==e.toString()&&a.push(n);return a}getSheetDataByMultiKey(t,e){let i=this.getCompoundKey(e);return t.get(i)}};Vt.DataType_Items="SheetDataManager:items",Vt.DataType_CatagoryChildType="SheetDataManager:CatagoryChildType",Vt.DataType_BeautyPiece="SheetDataManager:beautypiece",Vt.DataType_BeautyExp="SheetDataManager:beautyexp",Vt.DataType_ClothStyleScore="SheetDataManager:clothStyleScore";var j=Vt;var fe=class fe{constructor(){this.mainSceneX=10086;this.isCloseAll=!0;this.enterMainSceneTimes=0;this.isTopOpening=!1;this.isBottomOpening=!1;d.intance.on(b.EVENT_MODULE_ADDED,this,this.onAdded)}static get intance(){return fe._instance||(fe._instance=new fe),fe._instance}init(){}setup(){}onAdded(t){}getPreSceneData(){if(this.m_arrFromScenes.length<1)return[J.M_SCENE_MAIN,!0,1,null];{let t=this.m_arrFromScenes.pop();return console.log("pop-----------route："+this.m_arrFromScenes.join(" | ")),t}return[J.M_SCENE_MAIN,!0,1,null]}removePreSceneData(){this.m_arrFromScenes=[]}setBackScene(){let t=this.getPreSceneData();this.setCurrentScene(t[0],t[1],!1)}setMainScene(t=1,e=null){this.setCurrentScene(J.M_SCENE_MAIN,e)}setCurrentScene(t,e=null,i=!1,a=!0){return _(this,null,function*(){let n=!1;if(this.m_sceneCurrent&&this.m_sceneCurrent.name==t){console.log("currentScene："+this.m_sceneCurrent.name+"  openScene：："+t);return}this.isCloseAll?V.intance.closeAll():this.isCloseAll=!0,this.m_sceneCurrent&&(this.m_arrFromScenes||(this.m_arrFromScenes=[]),i&&this.m_sceneCurrent.m_arrOpenSceneData[3]&&this.m_arrFromScenes.push(this.m_sceneCurrent.m_arrOpenSceneData),console.log("open-----------scene："+this.m_arrFromScenes),this.fromScene=this.m_sceneCurrent.name,console.log("fromSceneName: "+this.fromScene),fe.m_arrSceneToDialog.indexOf(t)==-1?(this.m_sceneCurrent==this.m_preScene&&(this.m_preScene=null),this.m_sceneCurrent.toScene=t,this.m_sceneCurrent.removeSelf(),this.m_sceneCurrent=null,Laya.loader.clearUnLoaded(),Si.instance.dispose()):this.m_preScene=this.m_sceneCurrent,!i&&fe.m_arrSceneToDialog.indexOf(t)==-1&&this.m_preScene&&(this.m_sceneCurrent=this.m_preScene,this.m_sceneCurrent.toScene=t,this.m_sceneCurrent.removeSelf(),this.m_sceneCurrent=null,Laya.loader.clearUnLoaded(),Si.instance.dispose()));let r=j.intance.m_dicScene.get(t);switch(r&&r.music!=null&&r.music!="0"&&r.music!=""&&(console.log("SceneManager.setCurrentScene sceneItem.music: "+r.music),bt.instance.playMusicByName(r.music)),t){case J.M_SCENE_MAIN:this.m_arrFromScenes=[],this.m_sceneCurrent=yield Laya.Scene.open("scenes/mainView/MainScene.ls"),this.enterMainSceneTimes++;break;case J.M_SCENE_SHOP:this.m_sceneCurrent=yield Laya.Scene.open("scenes/shop/ShopScene.ls",!0,e);break;case J.M_SCENE_HERO:this.m_sceneCurrent=yield Laya.Scene.open("scenes/hero/MyHeroScene.ls");break;case J.M_SCENE_KNAPSACK:this.m_sceneCurrent=yield Laya.Scene.open("scenes/item/KnapsackScene.ls");break;case J.M_SCENE_UNION:this.m_sceneCurrent=yield Laya.Scene.open("scenes/union/UnionScene.ls");break;case J.M_SCENE_MATCH_READY:this.m_sceneCurrent=yield Laya.Scene.open("scenes/match/MatchReady.ls");break;case J.M_SCENE_MATCH:this.m_sceneCurrent=yield Laya.Scene.open("scenes/match/Match.ls");break;default:break}_t.logs("======================  打开Scene: "+t+"  ======================"),this.m_sceneCurrent.name=t,this.m_sceneCurrent.fromScene=this.fromScene,this.m_sceneCurrent.m_arrOpenSceneData=[t,e,i,a];let o=x.M_SCENE})}initPreload(){let t=j.intance.m_dicScene.get(J.M_SCENE_PRE_LOAD);t&&t.music!=null&&t.music!="0"&&t.music!=""&&(console.log("SceneManager.initPreload sceneItem.music: "+t.music),bt.instance.playMusicByName(t.music))}get currSceneName(){return this.m_sceneCurrent?this.m_sceneCurrent.name:""}};fe.m_arrSceneToDialog=[];var ot=fe;var Ct=class Ct{constructor(){this.resArr=["gameIcon/map/1001/img_map.jpg",{url:"gameIcon/map/map_1001.lh",type:Laya.Loader.HIERARCHY},"res/common/comm_bg/img_com_bg.jpg","res/common/comm/img_bg_large.png","res/common/comm/img_bg_medium.png","res/common/comm/img_bg_small.png",{url:"res/common.atlas",type:Laya.Loader.ATLAS},{url:"gameIcon/effect/match/beiji/spine.sk"},{url:"gameIcon/effect/match/dunpai/spine.sk"},{url:"gameIcon/effect/ruchang/effect1.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/ruchang/effect2.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/ruchang/effect3.skel",type:Laya.Loader.SPINE},{url:"gameIcon/effect/hua/effect.skel",type:Laya.Loader.SPINE},{url:"scenes/mainView/MainScene.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/shop/ShopScene.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/hero/MyHeroScene.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/match/Match.ls",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchHeroSpr.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/DamageNumber.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/CreateRoomDialog.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/mainView/EnterRoomView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchEndRankView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchReadyView.lh",type:Laya.Loader.HIERARCHY},{url:"scenes/match/MatchEndView.lh",type:Laya.Loader.HIERARCHY},{url:"prefab/closeBtn.lh",type:Laya.Loader.HIERARCHY},{url:"prefab/defaultButton.lh",type:Laya.Loader.HIERARCHY},{url:"prefab/DropBox.lh",type:Laya.Loader.HIERARCHY},{url:"resources/sound/destroy.wav",type:Laya.Loader.BUFFER},{url:"resources/sound/hit.wav",type:Laya.Loader.BUFFER}];this.m_arrPreResource=["config/spot.json","config/scene.json"];this.m_arrInitResource=["config/general.json","config/head.json","config/country.json","config/variable.json","config/equip.json","config/shop.json","config/union.json","config/hero.json","config/skill.json","config/buff.json","config/item.json","config/arena.json","config/map.json","config/level.json","config/mailmessage.json"];this.m_objModuleReource={FindScene:["res/atlas/find.atlas"],MainScene:[],ShopScene:[],CommentDialog:["res/atlas/comment.atlas"],GuideView:["res/atlas/guide.atlas","res/atlas/ShopView.atlas","config/newplayer.json"],ShareView:["res/atlas/share.atlas"],SelectHeadDialog:[],UnionApplyDialog:["config/alliance_constant.json","config/guild_building_main.json","config/alliance_pos.json","config/guild_level.json"],GuildScene:["res/atlas/union.atlas","config/alliance_constant.json","config/guild_building_main.json","config/alliance_pos.json","config/guild_level.json","config/guild_apply.json","config/guild_contrubute.json"],UnionWarScene:["res/atlas/unionWar.atlas","config/resource_node.json"],HeroScene:["res/atlas/hero.atlas","config/hero_lv.json","config/hero_attup.json","res/atlas/equip.atlas"],AFKBattleScene:["res/atlas/battle.atlas"],ArenaScene:["res/atlas/Arena.atlas"],KnapsackScene:["res/atlas/mainUI1.atlas"],UnionScene:["res/union1.atlas"]};this.m_objModuleViews={NoServerView:"scenes/createRole/NoServer.lh",CreateLoginView:"scenes/createRole/CreateLoginView.lh",ChangeHeadDialog:"scenes/createRole/ChangeHeadDialog.lh",HeroGetDialog:"scenes/shop/HeroGetDialog.lh",ItemGetDialog:"scenes/item/ItemGetDialog.lh",KnapsackTipDialog:"scenes/item/KnapsackTipDialog.lh",SelectHeadDialog:"scenes/createRole/SelectHeadDialog.lh",TxtNoticeView:"scenes/notice/TxtNoticeView.lh",RoleInfoDialog:"scenes/createRole/RoleInfoDialog.lh",CreateRoomDialog:"scenes/mainView/CreateRoomDialog.lh",EnterRoomView:"scenes/mainView/EnterRoomView.lh",InputPwdDialog:"scenes/mainView/InputPwdDialog.lh",HeroDetailDialog:"scenes/hero/HeroDetailDialog.lh",MatchEndRankView:"scenes/match/MatchEndRankView.lh",MatchReadyView:"scenes/match/MatchReadyView.lh",MatchEndView:"scenes/match/MatchEndView.lh",GameSettingLanguageDialog:"scenes/gameSetting/GameSettingLanguageDialog.lh",SkillTipDialog:"scenes/hero/SkillTipDialog.lh",BaseAlertDialog:"scenes/baseAlert/BaseAlertDialog.lh"};this.m_objConfigReource={};this.m_commonResource=new F;this.loadingView=Laya.Browser.window.loadingView;this.ii=100;this.baseUrl="https://cdn-5ejmbrg9nhxc.vultrcdn.com/hero/";if(Ct._instance)throw new Error("LayerManager是单例,不可new.");Ct._instance=this}static get instance(){return Ct._instance==null&&(Ct._instance=new Ct),Ct._instance}init(){Laya.loader.on(Laya.Event.ERROR,this,this.onError),this.initGameLanguage()}initGameLanguage(){Ct.GameLanguage_URL="config/language.json",Laya.loader.load(Ct.GameLanguage_URL,Laya.Handler.create(this,this.initGameResource))}initGameResource(t){if(t==null)return;let e=Ct.instance.getResBySetURL(Ct.GameLanguage_URL);f.instance.initLanTypes(e.data),Laya.loader.clearRes(Ct.GameLanguage_URL),this.onConfigLoaded()}onError(t){}onConfigLoaded(){let t=new Qe;t.ID=4,t.Event="加载语言包信息",mt.instance.sendCustumEvent(4,null,t),X.ignoreLang||(S.instance.m_strLanguage=f.instance.getLanIdByType(X.User_Lan)),this.m_UILang="config/lang_english"+S.instance.m_strLanguage+".json",this.m_NomalLang="config/english"+S.instance.m_strLanguage+".json",this.m_ErrorLang="config/error"+S.instance.m_strLanguage+".json",this.m_arrPreResource.push(this.m_UILang),this.m_arrPreResource.push(this.m_NomalLang),this.m_arrPreResource.push(this.m_ErrorLang),this.initResourceURL(this.m_arrPreResource,!0),this.initResourceURL(this.m_arrInitResource,!0),this.addFont1()}addFont1(){Laya.loader.load("res/font/CookieRun Regular.otf",Laya.Loader.TTF).then(()=>{this.loadDemoResource()})}loadDemoResource(){Laya.loader.load(this.resArr,null,Laya.Handler.create(this,this.onPreAssetPress1,null,!1)).then(()=>{A.instance.damageNumPrefab=Laya.loader.getRes("scenes/match/DamageNumber.lh"),A.instance.roleAniPrefab=Laya.loader.getRes("scenes/match/MatchHeroSpr.lh"),A.instance.ruchangEffects=[Laya.loader.getRes("gameIcon/effect/ruchang/effect1.skel"),Laya.loader.getRes("gameIcon/effect/ruchang/effect2.skel"),Laya.loader.getRes("gameIcon/effect/ruchang/effect3.skel")],A.instance.huaEffect=Laya.loader.getRes("gameIcon/effect/hua/effect.skel"),A.instance.beijiTemplet=Laya.loader.getRes("gameIcon/effect/match/beiji/spine.sk"),A.instance.dunpaiTemplet=Laya.loader.getRes("gameIcon/effect/match/dunpai/spine.sk");var t=A.instance.roleAniPrefab.create();console.log(" ================ roleAniPrefab: "+t),this.onLoadThreeDimen()})}onLoadThreeDimen(){Laya.loader.load(this.m_arrPreResource,Laya.Handler.create(this,this.onPreAssetLoaded),Laya.Handler.create(this,this.onPreAssetPress2,null,!1))}onPreAssetPress1(t){this.va=(t*100*.5).toFixed(0),this.loadingView&&this.va<100&&this.va>this.m_iPrecess&&this.loadingView.loading(this.va)}onPreAssetPress2(t){this.va=(t*100*.5+.5).toFixed(0),this.loadingView&&this.va<100&&this.va>this.m_iPrecess&&this.loadingView.loading(this.va)}onPreAssetLoaded(t){if(!t)return;let e=Laya.Browser.now();Ze.instance.initSpotCfgData(),this.initResourceURL(this.m_objModuleReource),this.initResourceURL(this.m_objConfigReource),mt.instance.sendCustumEvent(5),j.intance.preInit(),this.setGlobalLanguage(),mt.instance.sendCustumEvent(6),d.intance.event(b.EVENT_BACK_TO_LOGIN),ot.intance.initPreload(),this.loadingView&&this.loadingView.loading(100),console.log("-----------------------preload-time:"+(Laya.Browser.now()-e))}setGlobalLanguage(){let t=Ct.instance.getResByURL(this.m_NomalLang);f.instance.initConfigLan(t.data);let e=Ct.instance.getResByURL(this.m_UILang);f.instance.initUILan(e.data);let i=Ct.instance.getResByURL(this.m_ErrorLang);vt.instance.initErrData(i.data),this.clearResUrlByRoot(this.m_UILang,!0),this.clearResUrlByRoot(this.m_NomalLang,!0),this.clearResUrlByRoot(this.m_ErrorLang,!0)}initResourceURL(t,e=!1){if(t instanceof Array)this.setResURLArr(t,e);else if(t instanceof Object)for(let i in t)this.setResURLArr(t[i],e)}setResURLArr(t,e){let i,a;for(let n=0;n<t.length;n++)e?(this.m_commonResource.set(t[n],!0),a=this.setResURL(t[n]),i=this.getTypeFromUrl(a),t[n]={url:a,type:i,size:1,priority:1}):this.m_commonResource.get(t[n])?(t.splice(n,1),n--):(a=this.setResURL(t[n]),i=this.getTypeFromUrl(a),t[n]={url:a,type:i,size:1,priority:1})}getTypeFromUrl(t){let{ext:e,typeId:i,main:a,loaderType:n}=Laya.Loader.getURLInfo(t);Ct._extReg.lastIndex=t.lastIndexOf(".");let r=Ct._extReg.exec(t);return r&&r.length>1?r[1].toLowerCase():"text"}setResURL(t){return t}clearResUrlByRoot(t,e=!1){let i=t;Laya.loader.clearRes(i)}hasFormatEffectUrl(t){return t.indexOf("effect/")>=0}setItemResURL(t){return t&&t.hasOwnProperty("item_img")?this.setResURL("icon/"+t.item_img+".png"):""}setThreeDimenUrl(t){return t?this.setResURL("threeDimen/"+t):""}getThreeDimenUrl(t){let e=this.setResURL("threeDimen/"+t);return Laya.Loader.getRes(e)}getResByURL(t){let e=Ct.instance.setResURL(t);return Laya.Loader.getRes(e)}getResBySetURL(t){return Laya.Loader.getRes(t)}loadModuleUrl(t,e=null,i=null,a=1,n=!0){console.log("loadModuleUrl m_strName: "+t),this.ii++;let r=Ct.instance.m_objModuleReource[t];if(r==null||r.length<1){e.run();return}Laya.loader.load(r,Laya.Handler.create(this,this.loadItemComplete,[e,r]),Laya.Handler.create(this,this.onLoadProgress,[t],!1),i,a,n,this.ii.toString())}loadItemComplete(t,e){this.usedUrlDic||(this.usedUrlDic=new F);for(let i in e){let a=e[i].url,n=this.usedUrlDic.get(a);n?this.usedUrlDic.set(a,++n):this.usedUrlDic.set(a,1)}t.run()}clearModuleUrl(t){console.log("clearModuleUrl m_strName: "+t);let e=Ct.instance.m_objModuleReource[t];for(let i in e){let a=e[i].url;if(this.usedUrlDic){let n=this.usedUrlDic.get(a);n-=1,n<1?(this.usedUrlDic.remove(a),Laya.loader.clearRes(a)):this.usedUrlDic.set(a,n)}}}onLoadProgress(t,e){}loadResource(t,e=null,i=null,a=null,n=1,r=!0){Laya.loader.load(t,e,i,a,n,r)}getCountryIcon(t){return this.setResURL("gameIcon/country/img_"+t+".png")}getHeroEggIcon(t){return this.setResURL("gameIcon/hero/heroEgg/img_"+t+".png")}getHeroEggBigIcon(t){return this.setResURL("gameIcon/hero/heroEggBig/img_"+t+".png")}getHeroHeadIcon(t){return this.setResURL("gameIcon/hero/heroHead/img_"+t+".png")}getHeroQuality(t){return this.setResURL("gameIcon/hero/heroQuality/img_"+t+".png")}getHeroBackIcon(t){return this.setResURL("gameIcon/hero/heroDetail/img_hero_di_"+t+".png")}getHeroFrontIcon(t){return this.setResURL("gameIcon/hero/heroDetail/img_hero_"+t+".png")}getItemIcon(t){return this.setResURL("gameIcon/items/item/img_"+t+".png")}getItemBgIcon(t){return this.setResURL("gameIcon/items/itemBg/img_"+t+".png")}getItemBigIcon(t){return this.setResURL("gameIcon/items/itemBig/img_"+t+".png")}getItemQualityIcon(t){return this.setResURL("gameIcon/items/itemQuality/img_"+t+".png")}getMoneyIcon(t){return this.setResURL("gameIcon/items/money/img_"+t+".png")}getAttrIcon(t){return this.setResURL("gameIcon/attr/img_attr_"+t+".png")}getSkillIcon(t,e=!1){let i;return e?i=this.setResURL("gameIcon/skill/skills/img_big_"+t+".png"):i=this.setResURL("gameIcon/skill/skills/img_"+t+".png"),i}getPlayerIcon(t){return parseInt(t)>0?this.setResURL("gameIcon/head/headCircle/img_"+t+".png"):t}getSceneBgUrl(t){return"scene/"+t+".jpg"}clearSKinUrl(t){for(let e in t)t[e]instanceof String&&t[e].indexOf("skincolor")==-1&&Laya.loader.clearRes(t[e]);t=[]}getFunctionIcon(t){return this.setResURL("icon/functionIcon/"+t+".png")}getNewFunIcon(t){return this.setResURL("icon/newFunIcon/"+t+".png")}getSoundURL(t,e=".ogg"){let i;return i=this.setResURL("mp3/"+t+e),i}getSoundURLogg(t){let e;return e=this.setResURL("mp3/"+t),e}getSceneUrl(t){return"scene/sceneBg/"+t+".jpg"}getMianSysIcon(t){return this.setResURL("icon/mainSysIcon/btn_"+t+".png")}getEffectUrl(t){return this.setResURL("effect/"+t+".json")}getLoadingUrl(t){return this.setResURL("effect/"+t)}getGuangImg(t){return this.setResURL("swf/"+t+".png")}getGuildProofBg(t){return this.setResURL("scene/guild/proof/"+t+"/1.png")}getGuildProofHots(t){return this.setResURL("scene/guild/proof/"+t+"/"+t+"/"+t+".json")}getShareImgUrl(t,e=!1,i=!1){let a;return i?t:(t=t+".jpg",e?a="https://mutantbox.8686c.com/16/qa/common/share/"+t:a="https://cdn.test.com/16/qa/common/share/"+t,a)}getHeadUrl(t){return"common/common_icon/"+t+".png"}getMapImg(t){return"gameIcon/map/"+t+"/img_map.jpg"}getMapPrefab(t){return"gameIcon/map/map_"+t+".lh"}clearCache(){}getHeroHeadRes(t,e){return X.Res==0?"gameIcon/hero/heroHead/img_"+t+".png":this.baseUrl+`${t}/${e}.png`}getHeroSkRes(t,e){return X.Res==0?`gameIcon/hero/heroSk/${t}/img_hero.skel`:this.baseUrl+`${t}/${e}/img_hero.skel`}};Ct._extReg=/\.(\w+)\??/g;var R=Ct;var kn=class extends Laya.Dialog{constructor(){super();this.canClickMask=!0;this.preinitialize()}_onClick(e){let i=e.target;if(i)switch(i.name){case Laya.Dialog.CLOSE:break;case Laya.Dialog.CANCEL:break;case Laya.Dialog.SURE:break;case Laya.Dialog.NO:break;case Laya.Dialog.OK:break;case Laya.Dialog.YES:this.destroy();break}}preinitialize(){this.init()}init(){}createChildren(){super.createChildren(),this.createUI(),this.initialize()}createUI(){}initialize(){this.addEvent(),this.initData()}addEvent(){}initData(){}removeEvent(){}disposeDialog(){Laya.Dialog.manager.close(this)}destroy(e=!0){this.removeEvent(),this._view&&(this._view.destroy(),this._view=null),super.destroy()}sendData(e,i=null){i==null&&(i=[])}};var On=class extends kn{constructor(){super();this.destroyDoCancel=!1}addEvent(){this.okBtn=this._alertView.getChildByName("okBtn"),this.cancleBtn=this._alertView.getChildByName("cancleBtn"),this.alertTitle=this._alertView.getChildByName("alertTitle"),this.descTf=this._alertView.getChildByName("alertDesc"),this._alertView.on(Laya.Event.CLICK,this,this.onClickEvent)}createUI(){this.createAlert()}createAlert(){this._alertView||(this._alertView=new Laya.View),this.addChild(this._alertView)}onClickEvent(e){let i=e.target;i.name=="okBtn"?(this._okHandler&&this._okHandler.runWith(null),this.close()):i.name=="cancleBtn"&&(this.destroyDoCancel=!1,this._cancelHandler&&this._cancelHandler.runWith(null),this.close())}alert(e,i,a,n=null,r=!1,o=null){let l=66;this._okHandler=i,this._cancelHandler=a,this.destroyDoCancel=r,e&it.YES&&!(e&it.NO)?(this.okBtn.x=this._alertView.width-this.okBtn.width>>1,this.cancleBtn.visible=!1,this.okBtn.label="Sure"):e&it.NO&&!(e&it.YES)?this.okBtn.visible=!1:e&it.YES&&e&it.NO,n&&this.descTf&&(n instanceof Array?(this.alertTitle.text=n[0],this.descTf.text=n[1]):this.descTf.text=n),o&&o.runWith(this)}removeSelf(){return this.destroyDoCancel&&this._cancelHandler&&this._cancelHandler.run(),super.removeSelf()}removeEvent(){super.removeEvent(),this._okHandler=null,this._cancelHandler=null}};var si=class extends Laya.Script{onAdded(){this.m_iLayerType=x.M_PANEL,this.m_iPositionType=x.CENTER,this.m_canTouch_all=!1,this.m_ioffsetX=0,this.m_ioffsetY=0,this.m_arrMapEvent=[],this.m_iAdaptation_Top=0,this.m_iAdaptation_Buttom=0,this.m_bAutoResizeWidth=!1,this.m_bAutoResizeHeith=!1,this.m_bAutoResize=!1,this.hideLoadingBySelf=!1}get loadPaths(){return this._loadPaths}onStageResize(){}setIphoneX(){if(X.m_bIsIphoneX&&this._view){let e=this._view.numChildren,i=[];if(e)for(let a=0,n=e;a<n;a++){let r=this._view.getChildAt(a);r.name==="ui_top"?isNaN(r.top)?r.y+=this.m_iAdaptation_Top:r.top+=this.m_iAdaptation_Top:r.name=="ui_bottom"&&(r.bottom+=this.m_iAdaptation_Buttom)}}}onAwake(){X.m_bIsIphoneX&&(this.m_iAdaptation_Top=X.IPHONEX_TOP,this.m_iAdaptation_Buttom=X.IPHONEX_BUTTOM),this.loadPaths&&this.loadPaths.length?(this.hideLoadingBySelf=!0,Laya.loader.load(this.loadPaths,Laya.Handler.create(this,this.loadPathsComplete))):(this.createUI(),this.createUILater())}createUILater(){this.createUIEnd()}loadPathsComplete(){this.createUI(),this.loadPathsCompleteLater()}loadPathsCompleteLater(){this.createUIEnd(),this.onStageResize(),B.instance.hideLoading()}createUI(){}createUIEnd(){this.setIphoneX(),this._addEvent(),this.initData(),this.onLoaded()}_addEvent(){this.btn_com_help&&this.btn_com_help.on(Laya.Event.CLICK,this,this.onHelp),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.addEvent()}addEvent(){}initData(){}onLoaded(){}removeEvent(){}backToPreScene(){let e=ot.intance.getPreSceneData();ot.intance.setCurrentScene(e[0],e[1],e[2],e[3],!1)}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN,!0,!0,1)}addMapEvent(e,i,a,n,r=null){e.on(i,a,n,r),this.m_arrMapEvent.push(e)}removeAllMapEvent(){if(this.m_arrMapEvent){for(let e=0;e<this.m_arrMapEvent.length;e++)this.m_arrMapEvent[e].offAll();this.m_arrMapEvent.splice(0,this.m_arrMapEvent.length),this.m_arrMapEvent=null}}dispose(){console.log("<<< BaseView.dispose() className: "+this.constructor.name+" ==== name: "+this._view.name+" ==== m_strName: "+this.m_strName),Laya.stage.off(Laya.Event.RESIZE,this,this.onStageResize),this.btn_com_help&&this.btn_com_help.off(Laya.Event.CLICK,this,this.onHelp),this.removeEvent(),this.removeAllMapEvent(),V.intance.removeViewFromModuleManger(this),this.m_arrMapEvent=null,this.m_strName&&this.m_strName!=""||(this.m_strName=this.constructor.name),R.instance.clearModuleUrl(this.m_strName),this.m_strName=null,this._view&&(Laya.timer.clearAll(this._view),Laya.Tween.clearAll(this._view),this._view.offAll(),this._view.removeSelf(),this._view.destroy(!0),this._view=null),Laya.timer.clearAll(this),Laya.Tween.clearAll(this)}sendData(e,i=null,a=null,n=!0){i==null&&(i=[])}get btn_com_help(){return this._view?this._view.getChildByName("btn_com_help"):null}get btn_back(){return this._view?this._view.getChildByName("btn_back"):null}onHelp(){this.m_helpId&&V.intance.openModule(p.HelpDialog,this.m_helpId)}resetView(){this.onStageResize()}};var ma=class s{constructor(){this.mail_contract=null}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){typeof window.ethereum!="undefined"&&(this.mail_contract=new window.web3.eth.Contract(C.SERIESHEROMALL_ABI,C.SERIESHEROMALL_ADDRESS))}initData(){return _(this,null,function*(){this.mailList=new F,B.instance.showLoading(!0);let t=yield this.mail_contract.methods.getPricesLength().call();for(let e=0;e<t;e++){let i=yield this.mail_contract.methods.getPriceByIndex(e).call(),a=new ni;if(a.type=2,a.idx=e,Object.assign(a,i),this.mailList.set(a.idx,a),a.showPrice=window.web3.utils.fromWei(a.currentPrice+""),a.currentToken!=C.ADDRESS0){let n=new window.web3.eth.Contract(C.TOKEN_ERC20ABI,a.currentToken);a.tokenContract=n,a.currentTokenName=yield n.methods.symbol().call()}else a.currentTokenName="BNB"}B.instance.hideLoading()})}recruit(t){return _(this,null,function*(){if(B.instance.showLoading(!0),!(yield this.mail_contract.methods.accountIsInWhiteList(t,z.instance.walletAddress).call())){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(6055)]);return}if(this.isOpen=yield this.mail_contract.methods.getIsOpen().call(),!this.isOpen){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(12)]);return}let i=this.mailList.get(t);if(i.totalSupply===i.sellAmount){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(13)]);return}let a=i.currentPrice,n=i.currentToken,r="0",o="18";n!=C.ADDRESS0?(r=yield i.tokenContract.methods.balanceOf(z.instance.walletAddress).call(),o=yield i.tokenContract.methods.decimals().call()):r=window.web3.eth.getBalance(z.instance.walletAddress);let l=ee.fromWei(a,o,2);if(parseFloat(r)<parseFloat(l)){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(14)]);return}if(n!=C.ADDRESS0){if(!(yield z.instance.allowanceAddressByTokenAddress(C.SERIESHEROMALL_ADDRESS,n))){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(15)]);return}yield this.mail_contract.methods.recruit(t).send({from:z.instance.walletAddress},(I,k)=>{if(I){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(16)]);return}})}else yield this.mail_contract.methods.recruit(t).send({from:z.instance.walletAddress,value:a},(v,I)=>{if(v){B.instance.hideLoading(),d.intance.event(b.EVENT_HERO_DRAW_BACK,[f.instance.getLanguage(16)]);return}})})}};var dt=class{};dt.FUN_MYHOME=1,dt.FUN_STORE=2,dt.FUN_TRAVEL=3,dt.FUN_PVP=1011,dt.FUN_PVPMULTI=7001,dt.FUN_GUILDPHOTO=1004,dt.FUN_PET=1003,dt.FUN_1V1=1014,dt.FUN_THUMB=9005,dt.FUN_THUMB_RANKING_REWARD=3008,dt.FUN_BOYFRIEND=4005,dt.FUN_TIMESTAGE=1006,dt.FUN_FARM_MODEL=1008611,dt.FUN_GROUP_PHOTO=1008612,dt.FUN_TV=1001,dt.FUN_PRAY=1005,dt.FUN_WORKSHOP=1006,dt.FUN_SHOP_CLOTH=4001,dt.FUN_SHOP_PRAY=2108,dt.FUN_SHOP_1V1=2119,dt.FUN_SHOP_PVP=2107,dt.FUN_SHOP_THUMB=2113,dt.FUN_SHOP_GUILD=2111,dt.FUN_FIRST_RECHARGE=2201,dt.FUN_ACTIVITY_CENTER=2002,dt.FUN_LIMITRECRUIT=2003;var Ge=class extends Laya.Script{constructor(){super()}};Ge.INIT_LUCKDEAW_EVENT="DigEvent:INIT_DIG_EVENT";var Pn=class extends si{constructor(e){super();this.currTab=0;this.type=1;this.hasFree=!1;this.type=e}get view(){return this._view}createUI(){this._view=new Laya.View,this.m_iPositionType=x.UP,this.onStageResize(),d.intance.on(Ge.INIT_LUCKDEAW_EVENT,this,this.luckdrawevevt),d.intance.on(b.EVENT_HERO_DRAW_BACK,this,this.onDrawBack),this.hideLoadingBySelf=!0,this.view.btn_myhero.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.view.btn_myhero]),this.view.box_skill.on(Laya.Event.CLICK,this,this.onShowSkill),this.view.btn_recruit1.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.view.btn_recruit1]),this.view.btn_heroshop.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.view.btn_heroshop]),this.view.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.view.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.view.listPanel1.vScrollBarSkin="",this.view.listPanel2.vScrollBarSkin="",this.view.animation_hreo.visible=!0,this.view.box_1.visible=!1,this.view.box_2.visible=!1,this.view.animation_hreo._complete=Laya.Handler.create(this,this.stopAni,[6]),this.view.tf_congratulation.text=f.instance.getLanguage(131),this.view.tf_congratulation.visible=!1,this.view.img_bg.visible=!1,this.initLuckDrawView(),Pt.instance.heroOutputRate();let e=(Laya.stage.height-X.DESIGN_HEIGHT)/2}setTab(e){for(let i=1;i<3;i++)e==i?this.view["btn_"+i].skin="common/common_btn/btn_tab1.png":this.view["btn_"+i].skin="common/common_btn/btn_tab2.png"}initLuckDrawView(){return _(this,null,function*(){yield Pt.instance.initData(),yield ma.instance.initData(),this.hasFree=yield Pt.instance.hasFree(),!this.destroyed&&(this.type==dt.FUN_LIMITRECRUIT?this.onClickTab(2):this.onClickTab(1))})}onClickTab(e){if(this.currTab!=e)if(this.setTab(e),e==1)if(this.hasFree)this.view.img_bg.visible=!0,this.view.box_1.visible=!0,this.view.box_2.visible=!1,this.view.label_cost.text=f.instance.getLanguage(30);else{this.view.box_1.visible=!1,this.view.box_2.visible=!0;let i=Pt.instance.mailList;if(this.destroyed)return;i&&i.values.length>0?(this.getItemByStarAndMintLevel(1,1)?this.view.box1_draw_1.dataSource=this.getItemByStarAndMintLevel(1,1):this.view.box1_draw_1.visible=!1,this.getItemByStarAndMintLevel(1,2)?this.view.box1_draw_2.dataSource=this.getItemByStarAndMintLevel(1,2):this.view.box1_draw_2.visible=!1,this.getItemByStarAndMintLevel(2,3)?this.view.box1_draw_3.dataSource=this.getItemByStarAndMintLevel(2,3):this.view.box1_draw_3.visible=!1,this.getItemByStarAndMintLevel(3,4)?this.view.box1_draw_4.dataSource=this.getItemByStarAndMintLevel(3,4):this.view.box1_draw_4.visible=!1,this.view.listPanel1.visible=!0,this.view.listPanel2.visible=!1,this.view.tf_noData.visible=!1):(this.view.tf_noData.visible=!0,this.view.listPanel1.visible=!1,this.view.listPanel2.visible=!1)}else{this.view.box_1.visible=!1,this.view.box_2.visible=!0;let i=ma.instance.mailList;if(this.destroyed)return;i&&i.values.length>0?(i.get(0)?this.view.box2_draw_1.dataSource=i.get(0):this.view.box2_draw_1.visible=!1,i.get(1)?this.view.box2_draw_2.dataSource=i.get(1):this.view.box2_draw_2.visible=!1,i.get(2)?this.view.box2_draw_3.dataSource=i.get(2):this.view.box2_draw_3.visible=!1,this.view.listPanel1.visible=!1,this.view.listPanel2.visible=!0,this.view.tf_noData.visible=!1):(this.view.tf_noData.visible=!0,this.view.listPanel1.visible=!1,this.view.listPanel2.visible=!1)}}getItemByStarAndMintLevel(e,i){let a=Pt.instance.mailList;for(let n of a.values){let r=n;if(r.rarity===e+""&&r.mineralLevel===i+"")return r}return!1}onStageResize(){super.onStageResize();let e=Laya.stage.height-X.DESIGN_HEIGHT;this.view.la_img_bg.height+=e,this.view.listPanel2.height+=e}onShowSkill(){V.intance.openModule(p.SkillTipDialog)}createUIEnd(){this.view.box_sucess2.visible=!1,this.view.btn_recruit1.visible=!0}stopAni(e){console.log("stopAni: "+e),this.view.animation_hreo.paused(),this.view.animation_hreo.stop()}handleClickBtn(e){switch(e){case this.view.btn_myhero:V.intance.openModule(p.MyHeroView),console.log("My hero");break;case this.view.btn_heroshop:console.log("Hero shop");break;case this.view.btn_recruit1:console.log("Hero Recruit"),this.drawCard();break}}drawCard(){return _(this,null,function*(){let e=yield Pt.instance.recruitFree()})}onDrawBack(e){if(e instanceof Array)for(let i of e){let a=i,n=this.view.box_card;n.dataSource=a,this.startAni()}else vt.instance.showErrorWord(e)}startAni(){this.view.box_sucess2.visible=!0,this.view.animation_hreo.paused(),this.view.animation_hreo.play(0,!1),this.view.tf_congratulation.visible=!0,Laya.timer.once(1500,this,this.showCard)}showCard(){this.hasFree?this.view.box_1.visible=!1:this.view.box_2.visible=!1,this.view.box_sucess2.visible=!0,this.view.box_skill.visible=!1,this.view.btn_recruit1.visible=!1,Laya.Tween.to(this.view.box_card,{scaleX:1.5,scaleY:1.5},100,null,Laya.Handler.create(this,this.onScaleEnd))}onScaleEnd(){Laya.Tween.to(this.view.box_card,{scaleX:1.4,scaleY:1.4},100,null,Laya.Handler.create(this,this.onScaleEnd1))}onScaleEnd1(){}luckdrawevevt(){}removeEvent(){d.intance.off(Ge.INIT_LUCKDEAW_EVENT,this,this.luckdrawevevt),d.intance.off(b.EVENT_HERO_DRAW_BACK,this,this.onDrawBack)}};var Nn=class extends Yt{constructor(){super()}get view(){return this._view}dispose(){super.dispose()}createUI(){this._view=new Laya.View,this.addChild(this._view)}};var Bn=class extends Yt{constructor(e){super();this.vo=e}get view(){return this._view}dispose(){super.dispose()}createUI(){this._view=new Laya.View,this.addChild(this._view)}initData(){this.view.img_icon.skin=`gameIcon/attricon/img_daoju_${this.vo.type-1e3}.png`,this.view.label_hp.text=`${f.instance.getLanguage(this.vo.name)} : ${this.getShowValue(this.vo.value)}`,this.view.label_level.text=f.instance.getLanguage("304")+` : ${this.vo.level}`,this.view.lable_desc.text=`${f.instance.getLanguage(this.vo.desc)}`}getShowValue(e){return this.vo.type===1003||this.vo.type===1005?(parseFloat(e+"")*100).toFixed(1)+"%":parseInt(e)}};var At=class s{static toFixed(t,e){if(t.toString().indexOf(".")==-1)return t;{let i=t.toFixed(e);return parseFloat(i)}}static toFixedWithPercent(t,e,i="+"){let a;return t.toString().indexOf(".")==-1?a=i+t*100+"%":(e=e-2,e<0&&(e=0),a=i+(t*100).toFixed(e)+"%"),a}static getGoldStr(t){let e;return t>999999?e=parseInt(String(t/1e5))+"m":e=t,e}static numStringFormat(t){let e=t;return S.instance.m_strLanguage==2?t.length>4&&(e=String(t).replace(/(\d)(?=(\d{3})+$)/g,"$1 ")):e=String(t).replace(/(\d)(?=(\d{3})+$)/g,"$1,"),e}static numSimple(t){let e=t,i=parseInt(parseInt(e)/1e3+"");return i>0?i+"k":s.numStringFormat(e)}static numStringFormat2(t){let e;if(t>999999)e=s.getNumStr(t,1e6,"M");else if(t>999)e=s.getNumStr(t,1e3,"K");else return t+"";return e}static getNumStr(t,e,i){return parseInt(Math.floor(t/e)+"")+i}static getTimeStr(t){let e;return t<3600?e=f.instance.getLanguage(9024,Math.ceil(t/60)):t<3600*24?e=f.instance.getLanguage(9025,Math.ceil(t/3600)):e=f.instance.getLanguage(9025,Math.ceil(t/(3600*24))),e}static BigInt(t){return 0}static isInteger(t){return t%1===0}static formatNumber(t,e=2){return Number.isInteger(t)?t:parseFloat(t.toFixed(2))}static filterNumFormat(t,e=2){if(!t)return t;if(t<1e3&&t>0)return parseFloat(t).toFixed(e);if(t==="0.00")return t;var i=[{value:1,symbol:""},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"}],a=/\.0+$|(\.[0-9]*[1-9])0+$/,n;for(n=i.length-1;n>0&&!(t>=i[n].value);n--);let r=(t/i[n].value).toString();return r.indexOf(".")>-1&&(e>0?r=r.substr(0,r.indexOf(".")+e+1):r=r.substr(0,r.indexOf(".")+e)),r.replace(a,"$1")+i[n].symbol}static fromWei(t,e,i=0){if(!t)return 0;let a=t.length-e+i;if(a<=0)return 0;let n=t.toString().slice(0,a);if(i){let r=n.length-i;if(r<=0){let o="0.";for(let l=0;l<Math.abs(r);l++)o+="0";n=o+n}else n=n.slice(0,n.length-i)+"."+n.slice(n.length-i)}return n}};var D=class{static RECV_MSG(t){return"msg_"+t}};D.MSG_CLOSE_SESSION_S2C=99998,D.MSG_UNION_GET_MY_UNION_C2S=12001,D.MSG_UNION_GET_MY_UNION_S2C=12002,D.MSG_UNION_GET_RECOMMEND_UNION_C2S=12003,D.MSG_UNION_GET_RECOMMEND_UNION_S2C=12004,D.MSG_UNION_CREATE_UNION_C2S=12005,D.MSG_UNION_CREATE_UNION_S2C=12006,D.MSG_UNION_UPDATE_UNION_C2S=12007,D.MSG_UNION_UPDATE_UNION_S2C=12008,D.MSG_UNION_JOIN_UNION_C2S=12009,D.MSG_UNION_JOIN_UNION_S2C=12010,D.MSG_UNION_LEVEL_UNION_C2S=12011,D.MSG_UNION_LEVEL_UNION_S2C=12012,D.MSG_UNION_GET_UNION_MEMBER_C2S=12013,D.MSG_UNION_GET_UNION_MEMBER_S2C=12014,D.MSG_UNION_GET_MY_UNION_VO_C2S=12015,D.MSG_UNION_GET_MY_UNION_VO_S2C=12016,D.MSG_UNION_GET_UNION_MEMBER_APPLY_C2S=12020,D.MSG_UNION_GET_UNION_MEMBER_APPLY_S2C=12021,D.MSG_UNION_GET_UNION_MEMBER_APPLY_JOIN_C2S=12022,D.MSG_UNION_GET_UNION_MEMBER_APPLY_JOIN_S2C=12023,D.MSG_UNION_GET_UNION_MEMBER_APPLY_AGREE_C2S=12024,D.MSG_UNION_GET_UNION_MEMBER_APPLY_AGREE_S2C=12025,D.MSG_UNION_GET_UNION_MEMBER_APPLY_REFUSE_C2S=12026,D.MSG_UNION_GET_UNION_MEMBER_APPLY_REFUSE_S2C=12027,D.MSG_UNION_GET_UNION_MEMBER_ADMIN_SET_C2S=12028,D.MSG_UNION_GET_UNION_MEMBER_ADMIN_SET_S2C=12029,D.MSG_UNION_GET_UNION_MEMBER_ADMIN_UNSET_C2S=12030,D.MSG_UNION_GET_UNION_MEMBER_ADMIN_UNSET_S2C=12031,D.MSG_UNION_GET_UNION_MEMBER_REMOVE_C2S=12032,D.MSG_UNION_GET_UNION_MEMBER_REMOVE_S2C=12032,D.MSG_UNION_GET_UNION_MEMBER_LEADER_TRANSFER_C2S=12033,D.MSG_UNION_GET_UNION_MEMBER_LEADER_TRANSFER_S2C=12034,D.MSG_UNION_GET_UNION_MEMBER_APPLY_HISTORY_C2S=12040,D.MSG_UNION_GET_UNION_MEMBER_APPLY_HISTORY_S2C=12041,D.MSG_UNION_GET_UNION_MANAGER_INVITATION_C2S=12042,D.MSG_UNION_GET_UNION_MANAGER_INVITATION_S2C=12043,D.MSG_COMM_GET_RED_HOT_C2S=14001,D.MSG_COMM_GET_RED_HOT_S2C=14002,D.MSG_FRIEND_GET_RECOMMEND_FRIEND_S2C=18001,D.MSG_FRIEND_GET_FRIEND_MEMBER_APPLY_S2C=18001,D.MSG_FRIEND_GET_FRIEND_MEMBER_APPLY_JOIN_S2C=18001,D.MSG_FRIEND_GET_FRIEND_MEMBER_APPLY_AGREE_S2C=18001,D.MSG_FRIEND_GET_FRIEND_MEMBER_APPLY_REFUSE_S2C=18001,D.MSG_FRIEND_GET_FRIEND_MEMBER_REMOVE_S2C=18001,D.MSG_FRIEND_GET_RECOMMEND_FRIEND_C2S=18001,D.MSG_FRIEND_GET_FRIEND_MEMBER_C2S=18001,D.MSG_WALLET_UPDATE_WALLET_ITEM_S2C=19001,D.MSG_WALLET_TRANSFER_WALLET_S2C=19002,D.MSG_UNION_PERSONAL_BOUNS_S2C=15003,D.MSG_UNION_SET_BOUNS_RATE_S2C=15004,D.MSG_UNION_BATTLE_CD_C2S=15e3,D.MSG_UNION_BATTLE_CD_S2C=15001,D.MSG_UNION_BATTLE_DIGGINGS_STATUS_S2C=15002,D.MSG_UNION_BATTLE_BOUNS_S2C=15008,D.MSG_COMM_SCROLL_MSG_S2C=16001,D.MSG_ROLE_UPDATE_KNEAD_FACE_S2C=2700,D.MSG_BUY_SUIT_NPC_C2S=87,D.MSG_BUY_SUIT_NPC_S2C=88,D.MSG_INIT_WISHING_TREE_C2S=112,D.MSG_WISHING_TREE_C2S=113,D.MSG_WISHING_TREE_FREE_C2S=114,D.MSG_INIT_WISHING_TREE_EXCHANGE_C2S=115,D.MSG_WISHING_TREE_EXCHANGE_REWARD_C2S=116,D.MSG_WISHING_TREE_FREE_S2C=117,D.MSG_INIT_WISHING_TREE_S2C=118,D.MSG_WISHING_TREE_S2C=119,D.MSG_INIT_WISHING_TREE_EXCHANGE_S2C=120,D.MSG_INIT_SUIT_COLLECT_S2C=130,D.MSG_SUIT_COLLECT_REWARD_C2S=131,D.MSG_ACTIVE_CHECKIN_INIT_C2S=2310,D.MSG_ACTIVE_CHECKIN_INIT_S2C=2311,D.MSG_ACTIVE_CHECKIN_GET_REWARD_C2S=2312,D.MSG_ACTIVE_CHECKIN_GET_REWARD_S2C=2313,D.MSG_ACTIVE_DRAWING_SHOP_INIT_C2S=2320,D.MSG_ACTIVE_DRAWING_SHOP_INIT_S2C=2321,D.MSG_ACTIVE_DRAWING_SHOP_BUY_C2S=2322,D.MSG_ACTIVE_DRAWING_SHOP_BUY_S2C=2323,D.MSG_INIT_ACTIVE_TASK_C2S=800,D.MSG_INIT_ACTIVE_TASK_S2C=801,D.MSG_FINISH_ACTIVE_TASK_C2S=802,D.MSG_INIT_EVERYDAY_QUEST_C2S=83,D.MSG_INIT_EVERYDAY_QUEST_S2C=84,D.MSG_FINISH_EVERYDAY_QUEST_C2S=85,D.MSG_REWARD_ACTIVE_SCORE_GIFT_C2S=176,D.MSG_ACTIVE_SCORE_PRAY_C2S=177,D.MSG_UPDATE_VITALITY_REWARD_S2C=2401,D.MSG_GET_PVP_GRADE_S2C=157,D.MSG_SYS_BASE_INFO_S2C=158,D.MSG_GET_PVP_RANK_RESULT_S2C=278,D.MSG_INVITATIONCENTER_INIT_INVITATION_CODE_C2S=2003,D.MSG_INVITATIONCENTER_INIT_INVITATION_CODE_S2C=2008,D.MSG_INVITATIONCENTER_RECEIVE_MY_CODE_REWARD_C2S=2006,D.MSG_INVITATIONCENTER_RECEIVE_MY_RECOMMEND_REWARD_S2C=2007,D.MSG_INVITATIONCENTER_FILL_IN_THE_INVITATION_CODE_C2S=2004,D.MSG_INVITATIONCENTER_FILL_IN_THE_INVITATION_CODE_S2C=2005,D.MSG_SHARE_INIT_S2C=3e3,D.MSG_SHARE_GET_C2S=3001,D.MSG_SHARE_GET_S2C=3002,D.MSG_UPDATE_SHARE_POPUP_DATA_S2C=3003,D.MSG_CLIENT_ORDER_UPDATE_C2S=3004,D.MSG_REC_SHARE_SHOP_ITEMS_C2S=3005,D.MSG_SHARE_SHOP_ITEMS_RETURN_S2C=3006,D.MSG_DIG_INIT_C2S=4001,D.MSG_LUCKDRAW_INIT_S2C=5002;var ha=class{};var Hn=class{};var Un=class s{constructor(){this.create_union_contract=null;this.member_sys_contract=null;this.union_war_contract=null;this.price=""}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){return _(this,null,function*(){this.memberList=new F,typeof window.ethereum!="undefined"&&(this.create_union_contract=new window.web3.eth.Contract(C.CREATE_UNION_ABI,C.CREATE_UNION_ADDRESS),this.member_sys_contract=new window.web3.eth.Contract(C.UNION_NUMBER_SYS_ABI,C.UNION_NUMBER_SYS_ADDRESS),this.union_war_contract=new window.web3.eth.Contract(C.UNION_WAR_ABI,C.UNION_WAR_ADDRESS))})}poolEarned(t,e){return _(this,null,function*(){let i=yield this.union_war_contract.methods.earned(e).call();return window.web3.utils.fromWei(i)})}claim_pool_reward(t,e,i){return _(this,null,function*(){B.instance.showLoading(!0),yield this.union_war_contract.methods.claimReward(t,e,i).send({from:z.instance.walletAddress},(a,n)=>{if(a)return B.instance.hideLoading(),!1})})}claim_member_reward(){return _(this,null,function*(){B.instance.showLoading(!0);let{sendBeanDto:t}=yield tt.requestPost("cybertron-sys-api/api/v1/alliance/bonus/receiveBonus",{}),e=new WalletValidateItemVo;return Object.assign(e,t),yield this.union_war_contract.methods.memberClaim(e.tokenAddress,e.to,e.amount,e.timestamp,e.hash,e.r,e.s,e.v).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1}),!0})}quitOccupy(t,e,i){return _(this,null,function*(){B.instance.showLoading(!0),yield this.union_war_contract.methods.quitOccupy(t,e,i).send({from:z.instance.walletAddress},(a,n)=>{if(a)return B.instance.hideLoading(),!1})})}setManagerBonusPercent(t,e,i){return _(this,null,function*(){B.instance.showLoading(!0),re.instance.SendData(15901,{accountIds:e,bonusPercents:i})})}queryNextGetTime(t,e){return _(this,null,function*(){return""})}donate(t,e){return _(this,null,function*(){B.instance.showLoading(!0),re.instance.SendData(13e3,{itemId:t,amount:e})})}getCreateCost(){return _(this,null,function*(){let t=yield this.create_union_contract.methods.getCreateUnionPrice().call();return this.price=window.web3.utils.fromWei(t[1]),this.price})}createUnion(t,e,i=""){return _(this,null,function*(){B.instance.showLoading(!0),this.price||(yield this.getCreateCost());let a=yield z.instance.getBalance();return parseInt(a)<parseInt(this.price)?(B.instance.hideLoading(),_t.moneyNotEnought(),!1):(yield z.instance.allowanceAddress(C.CREATE_UNION_ADDRESS))?(yield this.create_union_contract.methods.createUnion(t,e,i).send({from:z.instance.walletAddress},(r,o)=>{if(r)return B.instance.hideLoading(),!1}),!0):(B.instance.hideLoading(),at.instance.notice(f.instance.getLanguage(15)),!1)})}getMemberList(t="1"){return _(this,null,function*(){let e=yield tt.requestPost("cybertron-sys-api/api/v1/allianceMember/memberList",{unionId:t});this.memberList=new F;for(let i of e){let a=new Hn;Object.assign(a,i),this.memberList.set(a.accountId,a)}return this.memberList})}getMemberApplyList(t="1"){return _(this,null,function*(){let e=yield tt.requestPost("cybertron-sys-api/api/v1/allianceApply/applyList");GuildModel.instance.applyMembers=new F;for(let i of e){let a=new ha;Object.assign(a,i),GuildModel.instance.applyMembers.set(a.accountId,a)}return GuildModel.instance.applyMembers})}getMemberApplyHistoryList(t="1"){return _(this,null,function*(){let e=yield tt.requestPost("cybertron-sys-api/api/v1/allianceApply/historyRecordList"),i=new F;for(let a of e){let n=new ha;Object.assign(n,a),i.set(n.accountId,n)}return i})}editUnion(t,e,i,a=""){return _(this,null,function*(){B.instance.showLoading(!0),yield this.create_union_contract.methods.updateUnionProfile(t,e,i,a).send({from:z.instance.walletAddress},(n,r)=>{if(n)return B.instance.hideLoading(),!1})})}transferUnion(t,e){return _(this,null,function*(){B.instance.showLoading(!0),yield this.create_union_contract.methods.transferUnion(t,e).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})})}applyJoinUnion(t,e){return _(this,null,function*(){yield tt.requestPost("cybertron-sys-api/api/v1/allianceMember/applyJoinUnion",{unionId:e}),at.instance.notice(f.instance.getLanguage(2005))})}confirmApplyJoin(t,e){return _(this,null,function*(){B.instance.showLoading(!0),yield this.member_sys_contract.methods.confirmApplyJoin(t,e).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})})}refuseApplyJoin(t,e){return _(this,null,function*(){let i=yield tt.requestPost("cybertron-sys-api/api/v1/allianceMember/refuseApplyJoin",{accountId:t,unionId:e});d.intance.event(D.RECV_MSG(D.MSG_UNION_GET_UNION_MEMBER_APPLY_REFUSE_S2C),[[i]])})}kickOutUnion(t,e){return _(this,null,function*(){B.instance.showLoading(!0),yield this.member_sys_contract.methods.kickOutUnion(t,e).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})})}quitUnion(t,e){return _(this,null,function*(){B.instance.showLoading(!0),yield this.member_sys_contract.methods.quitUnion(t,e).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})})}addManager(t,e){return _(this,null,function*(){B.instance.showLoading(!0);let i=yield this.member_sys_contract.methods.getMaxManagerCount().call(),a=parseInt(i),n=yield this.member_sys_contract.methods.getUnionManagerCount(e).call();if(parseInt(n)>=a)return B.instance.hideLoading(),at.instance.notice(f.instance.getLanguage("3013")),!1;yield this.member_sys_contract.methods.addManager(t,e).send({from:z.instance.walletAddress},(o,l)=>{if(o)return B.instance.hideLoading(),!1})})}removeManager(t,e){return _(this,null,function*(){B.instance.showLoading(!0),yield this.member_sys_contract.methods.removeManager(t,e).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})})}};var Vn=class{};var Gn=class extends Yt{constructor(e){super();this.donateValue=1e3;this.persentAry=[25,50,75,100];this.vo=e,this.detailVo=new Vn,this.view.btn_reduce.on(Laya.Event.CLICK,this,this.clickHandler,[this.view.btn_reduce]),this.view.btn_plus.on(Laya.Event.CLICK,this,this.clickHandler,[this.view.btn_plus]),this.view.btn_donate.on(Laya.Event.CLICK,this,this.clickHandler,[this.view.btn_donate]),d.intance.on(It.CMD_13001+"",this,this.onDonateSuccess);for(let i=0;i<4;i++){let a=this.view["p"+i],n=a.getChildByName("img_select");n.visible=!1,a.on(Laya.Event.CLICK,this,this.onClickP,[i])}}removeEvent(){super.removeEvent(),d.intance.off(It.CMD_13001+"",this,this.onDonateSuccess)}get view(){return this._view}dispose(){super.dispose()}createUI(){this._view=new Laya.View,this.addChild(this._view)}onClickP(e){if(console.log("selcet==="+e),!this.detailVo.resourcesType)return;let i=this.maxValue/100*this.persentAry[e];if(!(i<1e3)){this.donateValue=i-i%1e3,this.view.lable_num.text=this.donateValue.toString(),this.updateContribute();for(let a=0;a<4;a++){let r=this.view["p"+a].getChildByName("img_select");r.visible=!1,a<=e&&(r.visible=!0)}}}initData(){return _(this,null,function*(){this.view.img_icon.skin=`gameIcon/attricon/img_daoju_${this.vo.type-1e3}.png`,this.updateView()})}updateContribute(){this.view.label_cb_right.text=f.instance.getLanguage("306")+` : ${parseInt(this.detailVo.contributeValue)+this.donateValue/1e3}`}onDonateSuccess(){return _(this,null,function*(){at.instance.notice(f.instance.getLanguage("307")),B.instance.hideLoading()})}updateView(){return _(this,null,function*(){if(!this.view)return;let e=yield tt.requestPost("cybertron-sys-api/api/v1/alliance/attribute/find",{attributeType:this.vo.type});Object.assign(this.detailVo,e);let i=j.intance.m_dicItems.get(this.detailVo.resourcesType);this.view.img_cost.skin="https://cdn.bunnyswap.cc/images/items/"+i.icon,this.detailVo.tokenAddress=i.tokenId;let a=WalletModel.instance.getValue(this.detailVo.resourcesType);this.view.lable_title.text=`${f.instance.getLanguage(this.vo.name)} : ${this.getShowValue(this.detailVo.value)}`,this.maxValue=parseFloat(a),this.view.lable_progress.text=f.instance.getLanguage("305")+` 
 ${At.filterNumFormat(this.detailVo.num)}/${At.filterNumFormat(this.detailVo.totalNum)}`,this.view.label_attr_left.text=`${f.instance.getLanguage(this.detailVo.name)} : ${this.getShowValue(this.detailVo.value)}`,this.view.label_attr_right.text=`${f.instance.getLanguage(this.detailVo.name)} : ${this.getShowValue(this.detailVo.toValue)}`,this.view.label_lv_left.text=f.instance.getLanguage("304")+` : ${this.detailVo.level}`,this.view.label_lv_right.text=f.instance.getLanguage("304")+` : ${this.detailVo.toLevel}`,this.view.label_cb_left.text=f.instance.getLanguage("306")+` : ${this.detailVo.contributeValue}`,this.updateContribute()})}getShowValue(e){return this.detailVo.type===1003||this.detailVo.type===1005?(parseFloat(e+"")*100).toFixed(1)+"%":parseInt(e)}clickHandler(e){return _(this,null,function*(){if(this.detailVo.resourcesType)switch(e){case this.view.btn_reduce:this.donateValue>1e3&&(this.donateValue-=1e3),this.view.lable_num.text=this.donateValue.toString(),this.updateContribute();break;case this.view.btn_plus:this.donateValue+1e3<=this.maxValue&&(this.donateValue+=1e3),this.view.lable_num.text=this.donateValue.toString(),this.updateContribute();break;case this.view.btn_donate:if(this.donateValue>this.maxValue){at.instance.notice(f.instance.getLanguage(14));return}Un.instance.donate(this.detailVo.resourcesType+"",this.donateValue+"");break;default:break}})}};var Fn=class extends si{constructor(){super()}get view(){return this._view}createUI(){this._view=new Laya.View,this.m_iPositionType=x.UP,this.addChild(this._view),this.onStageResize(),this.view.tab.dataSource=3,this.view.attr_list.vScrollBarSkin="",this.view.attr_list.array=[],d.intance.on(It.CMD_13001+"",this,this.getAttrList),this.getAttrList()}getAttrList(){return _(this,null,function*(){let t=yield tt.requestPost("cybertron-sys-api/api/v1/alliance/attribute/findAll",{});this.destroyed||t.length&&(this.view.attr_list.array=t.slice(0,5))})}removeEvent(){super.removeEvent(),d.intance.off(It.CMD_13001+"",this,this.getAttrList)}onStageResize(){super.onStageResize();let t=Laya.stage.height-X.DESIGN_HEIGHT;this.view.la_img_bg.height+=t,this.view.attr_list.height+=t,this.view.height+=t}};var Kn=class{};var ie=class s{constructor(){this._inited=!1;this.contract=null;this.init()}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){this._inited||(this._inited=!0,this.posDic=new F,this.contract=new window.web3.eth.Contract(C.HEROFORMATION_ABI,C.HEROFORMATION_ADDRESS))}getHeroPos(){return _(this,null,function*(){return(yield tt.requestPost("cybertron-sys-api/api/v1/heroes/positionList",{})).forEach(e=>{let i=new Kn;Object.assign(i,e),this.posDic.set(i.position,i)}),this.posDic})}setHeroPos(){return _(this,null,function*(){if(B.instance.showLoading(!0),this.checkOnlyChangePos())return yield tt.requestPost("cybertron-sys-api/api/v1/heroes/setPosition",this.copyPosDic.values),this.posDic=this.copyPosDic,B.instance.hideLoading(),d.intance.event("SET_HERO_POSTION_SUCCESS"),this.posDic;{let e=[];this.copyPosDic.values.forEach(i=>{parseInt(i.heroId)&&e.push([parseInt(i.heroId),parseInt(i.position)])}),yield this.contract.methods.formation(e).send({from:z.instance.walletAddress},(i,a)=>{if(i)return B.instance.hideLoading(),!1})}})}checkOnlyChangePos(){let t=[],e=[];for(let i of this.posDic.values)parseInt(i.heroId)&&t.push(parseInt(i.heroId));for(let i of this.copyPosDic.values)parseInt(i.heroId)&&e.push(parseInt(i.heroId));return t.sort(),e.sort(),t.toString()===e.toString()}};var Wn=class extends Yt{constructor(){super()}get view(){return this._view}dispose(){super.dispose()}createUI(){this.addChild(this._view),d.intance.on("CANCEL_HERO_POS",this,this.cancelHero),d.intance.on("SET_HERO_POSTION_SUCCESS",this,this.setHeroPosSuccess),this.view.btn_set.clickHandler=new Laya.Handler(this,this.onSetHeroPos)}onSetHeroPos(){return _(this,null,function*(){yield ie.instance.setHeroPos()})}setHeroPosSuccess(){vt.instance.showErrorWord(2e4),V.intance.disposeView(p.HeroFormationDialog)}removeEvent(){d.intance.off("CANCEL_HERO_POS",this,this.cancelHero),d.intance.off("SET_HERO_POSTION_SUCCESS",this,this.setHeroPosSuccess)}createUIEnd(){return _(this,null,function*(){this.view.list.vScrollBarSkin="",this.view.list.dataSource=[],this.view.list.mouseHandler=new Laya.Handler(this,this.onListEvent),this.view.list.renderHandler=new Laya.Handler(this,this.onRenderList),yield ie.instance.getHeroPos(),ie.instance.copyPosDic=ee.deepClone(ie.instance.posDic);let t=S.instance.m_heroData.heroVoDic.values;if(t&&t.length>0){let e=t.filter(i=>i.status!=2);this.view.list.array=e}this.updateList()})}cancelHero(t){let e=ie.instance.copyPosDic.get(t);e.heroId="0",this.updateList()}updateList(){for(let t of ie.instance.copyPosDic.keys){let e=ie.instance.copyPosDic.get(t);this.view["pos"+t].dataSource=e}this.view.list.refresh()}onListEvent(t,e){switch(t.type){case Laya.Event.CLICK:this.handleSelectHero(e);break}}handleSelectHero(t){let e=this.view.list.array[t];for(let i of ie.instance.copyPosDic.values)if(i.heroId==e.id){this.cancelHero(i.position);return}for(let i of ie.instance.copyPosDic.keys){let a=ie.instance.copyPosDic.get(i);if(!parseInt(a.heroId)){a.heroId=e.id+"",this.view["pos"+i].dataSource=a;break}}this.view.list.refresh()}onRenderList(t,e){}onComplete(){}initData(){}};var Yn=class s{constructor(){if(s._instance)throw new Error("LayerManager是单例,不可new.");s._instance=this}static get intance(){return s._instance||(s._instance=new s),s._instance}init(){Laya.ClassUtils.regClass(it.BASEALERTVIEW,On),Laya.ClassUtils.regClass(p.SkillTipDialog,Nn),Laya.ClassUtils.regClass(p.LuckdrawView,Pn),Laya.ClassUtils.regClass(p.UnionAttrView,Fn),Laya.ClassUtils.regClass(p.UnionAttrLvUpDialog,Gn),Laya.ClassUtils.regClass(p.UnionAttributeDetailsDialog,Bn),Laya.ClassUtils.regClass(p.HeroFormationDialog,Wn)}};var jn=class s{constructor(){this.m_sprMap=new Laya.Sprite;this.m_Image=new Laya.Image}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){}showLoading(t=!1){if(this.loadingMc)this.m_sprMap.size(Laya.stage.width,Laya.stage.height),X.m_bIsIphoneX&&(this.m_Image.scaleX=X.IPHONEX_SCARE,this.m_Image.scaleY=X.IPHONEX_SCARE),this.m_Image.x=(this.m_sprMap.width-this.m_Image.width*this.m_Image.scaleX)/2,this.m_Image.y=(this.m_sprMap.height-this.m_Image.height*this.m_Image.scaleY)/2,this.m_sprMap.x=(x.instence.m_iStageWidth-this.m_sprMap.width*this.m_sprMap.scaleX)/2,this.m_sprMap.y=(x.instence.m_iStageHeight-this.m_sprMap.height*this.m_sprMap.scaleY)/2,this.m_sprMap.visible=!0,Laya.timer.clear(this,this.showLazyBg),t?(this.m_Image.alpha=1,this.showLazyBg()):(this.m_Image.alpha=0,this.m_sprMap&&(this.m_sprMap.graphics.clear(),this.m_sprMap.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#000000")),Laya.timer.once(300,this,this.showLazyBg));else return}showLazyBg(){this.m_sprMap&&(this.m_sprMap.graphics.clear(),this.m_Image.alpha=1),this.loadingMc&&(this.loadingMc.x=Laya.stage.width/2,this.loadingMc.y=Laya.stage.height/2,this.loadingMc.play(),this.loadingMc.visible=!0)}hideLoading(){if(this.loadingMc)this.hideLoadingSHow();else return}hideLoadingSHow(){Laya.timer.clear(this,this.showLazyBg),this.loadingMc.stop(),this.loadingMc.visible=!1,this.m_sprMap.visible=!1}get isShow(){return this.loadingMc&&this.loadingMc.visible}dispose(){this.m_sprMap&&this.m_sprMap.graphics.clear(),Laya.timer.clear(this,this.showLazyBg),this.loadingMc&&(this.loadingMc.destroy(),this.loadingMc.removeSelf(),this.loadingMc=null)}};var wt=class wt{static get IsSetRelease(){return wt._IsSetRelease}static get IsSetGuid(){return wt._IsSetGuid}static initParms(){if(Laya.Browser.window.location){let e=Laya.Browser.window.location.href,i=this.getURLParameters(e);if(wt.m_obj=i,console.log("1initgame-->urldata:",wt.m_obj),wt.m_obj.server&&wt.m_obj.server!=""&&(tt.httpRoot=wt.m_obj.server),wt.m_obj.socket&&wt.m_obj.socket!=""){var t=wt.m_obj.socket;It.m_strHttpHost=t+"/websocket"}if(wt.m_obj.address&&wt.m_obj.address!=""&&(z.instance.walletAddress=wt.m_obj.address),wt.m_obj.debug&&wt.m_obj.debug!="0"&&(X.Debug=parseInt(wt.m_obj.debug)),wt.m_obj.res&&wt.m_obj.res!="0"&&(X.Res=parseInt(wt.m_obj.res)),wt.m_obj.lang&&wt.m_obj.lang!=""){let a=parseInt(wt.m_obj.lang);a<1&&(a=1),X.ignoreLang=!0,S.instance.m_strLanguage=a}}}static getURLParameters(t){let e={};return t.replace(/[?&]+([^=&]+)=([^&]*)/gi,(i,a,n)=>e[a]=decodeURIComponent(n)),e}static cheakStr(t){let e=new RegExp("[A-Za-z0-9_-\\s]","g"),i=t.match(e);return!!(i&&i.length==t.length)}};wt._IsSetRelease=!1,wt._IsSetGuid=!1;var Xn=wt;var{regClass:su}=Laya,oi=class extends Va{constructor(){super(...arguments);this.isLogout=!1;this.dotNum=0;this.m_nProgress=0}onAwake(){Laya.loader.on(Laya.Event.ERROR,this,this.onError),Laya.loader.load(["res/common/comm_bg/img_loading_bg.jpg","res/loading/progress_load1.png","res/loading/progress_load1$bar.png"]).then(()=>{this.createUI(),this.init()})}onError(e){console.log("加载失败: "+e)}createUI(){this.m_nSendTime=Laya.timer.currTimer,bt.instance.init(),bt.instance.playMusicByName(bt.soundName_bg,".mp3"),d.intance.on(b.EVENT_BACK_TO_LOGIN,this,this.backToLogin),d.intance.on(b.EVENT_LOGIN_GAME_END,this,this.loginGameEnd),d.intance.on(b.EVENT_ENTER_MAIN,this,this.loginCallBack),this.initLoad();let e=X.User_Lan;var i=getGameVersion();this.txtLoad.text=i,console.log("VERSION: "+i),$t.Initialize(Laya.stage,!0)}handleClickBtn(e){switch(e){}}initLoad(){this.onAssetLoaded()}onAssetLoaded(){this.loadingProcess=0,this.m_nProgress=0,Laya.timer.loop(1800,this,this.onLoading,[this.m_nProgress])}set loadingProcess(e){e>1&&(e=1),this.mcProcess.value=e,this.txtProcess.text=Math.floor(e*100)+"%";var i=e*this.mcProcess.width-70;i<0&&(i=0),this.img_guang.x=i,console.log("loadingProcess: "+e+", width: "+this.mcProcess.width)}init(){f.instance.FGM_GetLanguage(),Yn.intance.init(),x.instence.init(),ot.intance.init(),B.instance.init(),jn.instance.init(),V.intance.init(),S.instance.init(),R.instance.init(),Xn.initParms()}backToLogin(){Laya.timer.clear(this,this.onLoading),this.m_nProgress=0,Laya.loader.load(R.instance.m_arrInitResource,Laya.Handler.create(this,this.getLoginData),Laya.Handler.create(this,this.onLoading2,null,!1))}getLoginData(){mt.instance.sendCustumEvent(7),this.readyInitGame()}readyInitGame(){if(this.isLogout){d.intance.event(b.EVENT_LOADING_SUC);return}this.mcProcess&&(this.loadingProcess=.8+.2),this.loginGame()}loginGame(){return _(this,null,function*(){d.intance.event(b.EVENT_LOADED_COMPLETE),yield z.instance.init(),yield z.instance.dappLogin()})}loginGameEnd(e){return _(this,null,function*(){mt.instance.sendCustumEvent(8),j.intance.init(),re.instance.init(),console.log("PreLoadingView.joinGame()");let i=Laya.timer.currTimer-this.m_nSendTime;if(mt.instance.sendCustumEvent(22),!e){V.intance.openModule(p.NoServerView);return}e.loginState==1?(console.log("have no regist"),mt.instance.sendCustumEvent(23),V.intance.openModule(p.CreateLoginView)):(mt.instance.sendCustumEvent(30),e.playerDto?(mt.instance.sendCustumEvent(31),console.log("registed "+e.playerDto.name),S.instance.playerDto=e.playerDto,this.loginCallBack()):(mt.instance.sendCustumEvent(32),console.log("getRegisted error"),at.instance.notice(f.instance.getLanguage(135))))})}loginCallBack(){return _(this,null,function*(){console.log("loginCallBack++++++++++++++++++++++++++++++++"),B.instance.hideLoading();var e=S.instance.playerDto;if(e.roomId>0){let i=yield tt.requestPost("wxgame/room/info",{roomId:e.roomId});W.instance.roomDto=i.roomDto,i.roomDto?e.roomState==0?V.intance.openModule(p.EnterRoomView):e.roomState==1&&It.instance.initSocket():at.instance.notice(f.instance.getLanguage(135))}else _t.logs("进入主界面",5),mt.instance.sendCustumEvent(33),ot.intance.setCurrentScene(J.M_SCENE_MAIN);tt.startHeart()})}onLoading(e){this.m_nProgress+=.01,this.mcProcess&&e>this.mcProcess.value&&(this.loadingProcess=e*.4)}onLoading2(e){this.mcProcess&&(this.loadingProcess=0+e*1.1)}removeEvent(){d.intance.off(b.EVENT_BACK_TO_LOGIN,this,this.backToLogin),d.intance.off(b.EVENT_LOGIN_GAME_END,this,this.loginGameEnd),d.intance.off(b.EVENT_ENTER_MAIN,this,this.loginCallBack)}};oi.m_iState=1,oi=u([su("xmaaYG8AQ1yC07pr_JvyPA")],oi);var li=class li extends Laya.ColorFilter{constructor(t=null){super(t)}static addClickFilter(t){let e=t.filters||[];e.push(li.clickFilter),t.filters=e}static clearClickFilter(t){let e=t.filters;if(e!=null&&e.length>0){for(let i=e.length-1;i>-1;i--)e[i]instanceof li&&e.splice(i,1);t.filters=e}}};li.clickFilter=new li([1,0,0,0,-34,0,1,0,0,-34,0,0,1,0,-34,0,0,0,1,0]);var Be=li;var{regClass:ou,property:lu}=Laya,ci=class extends Laya.Script{constructor(){super();this.noSound=!1}onEnable(){let e=this.owner.scaleX;this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onUp)}onDown(){this.noSound||bt.instance.playSoundByName(bt.soundName4),Be.addClickFilter(this.owner)}onUp(){Be.clearClickFilter(this.owner)}onDisable(){Be.clearClickFilter(this.owner),this.owner.off(Laya.Event.MOUSE_DOWN,this,this.onDown),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.onUp)}};u([lu({type:"boolean"})],ci.prototype,"noSound",2),ci=u([ou("cL1AmqOiTHmtQWKayPNcTA")],ci);var qn=class extends Laya.Dialog{};var{regClass:cu}=Laya,zn=class extends qn{constructor(){super();this.destroyDoCancel=!1}onEnable(){this.on(Laya.Event.CLICK,this,this.onClickEvent)}onClickEvent(e){let i=e.target;i.name=="okBtn"?(this._okHandler&&this._okHandler.runWith(null),this.close()):i.name=="cancleBtn"&&(this.destroyDoCancel=!1,this._cancelHandler&&this._cancelHandler.runWith(null),this.close())}setOpenData(e){e&&(this._okHandler=e.okHandler,this._cancelHandler=e.cancelHandler,this.destroyDoCancel=e.destroyDoCancel,e.flag&it.YES&&!(e.flag&it.NO)?(this.okBtn.x=this.width-this.okBtn.width>>1,this.cancleBtn.visible=!1,this.okBtn.label="Sure"):e.flag&it.NO&&!(e.flag&it.YES)?this.okBtn.visible=!1:e.flag&it.YES&&e.flag&it.NO,e.data&&this.alertDesc&&(e.data instanceof Array?(this.alertTitle.text=e.data[0],this.alertDesc.text=e.data[1]):this.alertDesc.text=e.data),e.initHandler&&e.initHandler.runWith(this))}onDisable(){this.destroyDoCancel&&this._cancelHandler&&this._cancelHandler.run(),this._okHandler=null,this._cancelHandler=null}};zn=u([cu("8G0DBvD7T_2CVupdfQXrBw")],zn);var Qn=class extends Laya.Dialog{};var{regClass:uu}=Laya,Jn=class extends Qn{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}onEnable(){this.list_head.vScrollBarSkin="",this.btn_confirm.on(Laya.Event.CLICK,this,this.onRegister),this.btn_custom.on(Laya.Event.CLICK,this,this.onBtnChangePic),this.initContainer()}initContainer(){this.list_head.vScrollBarSkin="",this.list_head.selectHandler=new Laya.Handler(this,this.handleSelectHead),this.createHeadList()}handleSelectHead(e){if(e!=-1){let i=this.list_head.selectedItem;S.instance.headId=i.id,this.playerIcon.headSkin=S.instance.headId}}createHeadList(){let e=j.intance.m_dicHead;this.list_head.array=e.values,this.list_head.visible=!0;let i=-1,a=0;this.playerIcon.headSkin=S.instance.headId;for(let n of e.values){if(n.id==S.instance.headId){i=a;break}a++}this.list_head.selectedIndex=i}onBtnChangePic(){var e=Laya.Render.canvas.style.zIndex,i=f.instance.getUILang("Upload picture"),a=f.instance.getUILang("Select Image"),n=f.instance.getUILang("Save changes");openUploadPic(this,e,i,a,n)}openPicEnd(e,i){return _(this,null,function*(){if(i.length>500){let a=yield tt.requestPost("wxgame/player/uploadImg",{base64Str:i},!1,!1);a&&(S.instance.headId=a.imgUrl,e.playerIcon.headSkin=a.imgUrl,console.log(a.imgUrl))}})}onRegister(){let e=S.instance.headId;d.intance.event(b.EVENT_MODIFY_HEAD,[e]),this.close()}};Jn=u([uu("BmtPy79ySCyg4IuEQC4zsQ")],Jn);var Zn=class extends Laya.ComboBox{};var{regClass:pu}=Laya,$n=class extends Zn{set defaultLabel(t){this._defaultLabel=t,this._selectedIndex<0&&(this._button.label=t),this._button.labelAlign="center"}onEnable(){this.list=this.comboList}set dataSource(t){super.dataSource=t;var e=t;e&&(this.labels=e.join(","),console.log("comboData.length: "+e.length),this.list.repeatY=e.length,this.list.width=this.width,this.list.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1))}onCountryItemRender(t,e){t.onChange(this.list.selectedIndex==e)}set isOpen(t){if(console.log("isOpen: "+t),this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal(Laya.Point.TEMP.setTo(0,0)),i=e.y+this._button.height;i=i+this._listHeight<=Laya.stage.height||e.y-this._listHeight<0?i:e.y-this._listHeight,this.img_pad.addChild(this._list),this.img_pad.pos(e.x,i),this.img_pad.visible=!0,Laya.stage.addChild(this.img_pad),this.img_pad.zOrder=1001,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.removeList),Laya.stage.on(Laya.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf(),this.img_pad&&this.img_pad.removeSelf()}};$n=u([pu("AqEOSlrnRkmI9RUPCJUVqQ")],$n);var tr=class extends Laya.List{};var{regClass:mu}=Laya,er=class extends tr{};er=u([mu("7DDHp602Rs6dL3bjAu4ArA")],er);var ir=class extends Laya.Box{};var{regClass:hu}=Laya,ar=class extends ir{addEvent(){}set dataSource(e){super.dataSource=e;var i=e;i&&i.label&&(this.addEvent(),this.tf_name.text=i.label)}onChange(e){e?(this.selectImg.visible=!0,this.tf_name.color="#ffffff"):(this.tf_name.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};ar=u([hu("nREGzTKFSX6LuiRnM5nPXA")],ar);var nr=class extends Laya.Box{};var{regClass:du}=Laya,rr=class extends nr{addEvent(){}set dataSource(e){super.dataSource=e,console.log("value: "+e);var i=e;i&&(this.addEvent(),this.img_icon.skin=R.instance.getCountryIcon(i.id),this.tf_name.text=f.instance.getLanguage(i.name))}onChange(e){e?(this.selectImg.visible=!0,this.tf_name.color="#ffffff"):(this.tf_name.color="#357cc0",this.selectImg.visible=!1)}onDisable(){}};rr=u([du("LJ8PUf7kRCGUr4eT8Mhy3g")],rr);var sr=class extends Laya.Dialog{};var ui=class extends Laya.Event{constructor(){super()}};ui.INIT_CREATELOGIN_EVENT="CreateLoginEvent:INIT_CREATELOGIN_EVENT";var{regClass:yu}=Laya,or=class extends sr{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_PANEL;this.m_iPositionType=x.CENTER}onEnable(){d.intance.on(ui.INIT_CREATELOGIN_EVENT,this,this.initCreateLoginView),d.intance.on(b.EVENT_MODIFY_HEAD,this,this.onChangeModifyHead),this.btn_radio1.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_radio1]),this.btn_radio2.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_radio2]),this.btn_register.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_register]),this.box_change.on(Laya.Event.CLICK,this,this.onChangeHead),this.input_name.prompt=f.instance.getLanguage("31"),this.selectRadio(1),this.initCountry(),this.initCreateLoginView(),mt.instance.sendCustumEvent(23)}initCountry(){this.list_country.selectHandler=new Laya.Handler(this,this.handleSelectCountry),this.createCountryList(),this.box_country.on(Laya.Event.CLICK,this,this.onOpenCountry),this.list_country.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_country.mouseHandler=Laya.Handler.create(this,this.onCountryItemMouse,null,!1),this.list_country.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1),this.list_country.scrollBar&&this.list_country.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}onCountryItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_country.selectedIndex=i,this.onHideCountry())}onListDown(e){e.stopPropagation()}onScrollBarDown(e){e.stopPropagation()}onCountryItemRender(e,i){e.onChange(this.list_country.selectedIndex==i)}onOpenCountry(){this.img_country_pad.visible==!1&&(this.img_country_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideCountry))}onHideCountry(){this.img_country_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideCountry)}handleSelectCountry(e){if(console.log("handleSelectCountry: "+e),e!=-1){let i=this.list_country.selectedItem;S.instance.countryId=i.id,this.img_flag.skin=R.instance.getCountryIcon(i.id),this.tf_country.text=f.instance.getLanguage(i.name)}}createCountryList(){let e=j.intance.m_dicCountry;this.list_country.array=e.values,this.list_country.visible=!0;let i=-1,a=0;for(let n of e.values){if(n.id==S.instance.countryId){i=a;break}a++}this.list_country.selectedIndex=i}onChangeHeadBack(e,i){this.input_name.text=e,S.instance.headId=i,this.playerIcon.headSkin=i}onChangeModifyHead(e){S.instance.headId=e,this.playerIcon.headSkin=e}onChangeHead(){V.intance.openModule(p.ChangeHeadDialog)}onBtnChangePic(){var e=Laya.Render.canvas.style.zIndex,i=f.instance.getUILang("Upload picture"),a=f.instance.getUILang("Select Image"),n=f.instance.getUILang("Save changes");openUploadPic(this,e,i,a,n)}openPicEnd(e,i){return _(this,null,function*(){if(i.length>500){let a=yield tt.requestPost("wxgame/player/uploadImg",{base64Str:i},!1,!1);a&&(S.instance.headId=a.imgUrl,e.playerIcon.headSkin=a.imgUrl,console.log(a.imgUrl))}})}selectRadio(e){let i=e==1;this.btn_radio1.selected=i,this.btn_radio2.selected=!i}handleClickBtn(e){switch(e){case this.btn_radio1:this.selectRadio(1);break;case this.btn_radio2:this.selectRadio(2);break;case this.btn_register:this.onRegister();break}}onRegister(){return _(this,null,function*(){let e=this.input_name.text,i=this.btn_radio1.selected?1:2;if(e=e.trim(),e==""){at.instance.notice(f.instance.getLanguage(31));return}if(S.instance.countryId==-1){at.instance.notice(f.instance.getLanguage(1048));return}let a=yield z.instance.createAcccount(e,i,S.instance.headId.toString(),S.instance.countryId);a&&(S.instance.playerDto=a,this.close(),d.intance.event(b.EVENT_ENTER_MAIN))})}initCreateLoginView(){}onDisable(){this.removeEvent()}removeEvent(){d.intance.off(ui.INIT_CREATELOGIN_EVENT,this,this.initCreateLoginView),d.intance.off(b.EVENT_CHANGE_HEAD,this,this.onChangeHeadBack)}};or=u([yu("1K2SyFxcQY-12SasSSRXyQ")],or);var lr=class extends Laya.Box{};var{regClass:gu}=Laya,cr=class extends lr{set dataSource(t){super.dataSource=t;var e=t;e&&(this.img_icon.skin="res/role/img_icon_"+e[0]+".png",this.tf_name.text=f.instance.getUILang(e[1]),this.tf_num.text=e[2])}};cr=u([gu("WJ5TDeRBSkC9yMqJ72B0Ow")],cr);var ur=class extends Laya.Box{};var{regClass:bu}=Laya,pr=class extends ur{set dataSource(e){super.dataSource=e,this.headItem=e,this.headItem&&this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){let e=this.headItem.id;this.playerIcon.headSkin=e})}onChange(e){}};pr=u([bu("AwN_JFPwQsKswm1N53Bmkg")],pr);var mr=class extends Laya.Dialog{};var{regClass:fu}=Laya,hr=class extends mr{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}onEnable(){this.btn_copy.on(Laya.Event.CLICK,this,this.onCopy),this.btn_changeHead.on(Laya.Event.CLICK,this,this.onChangeHead),d.intance.on(b.ROLE_INFO_CHANGE,this,this.updateRoleInfo),this.updateRoleInfo()}updateRoleInfo(){let e=S.instance.playerDto;this.tf_name.text=e.name,this.img_sex.skin=e.sex==1?"res/role/img_icon_xb_1.png":"res/role/img_icon_xb_2.png",this.tf_uid.text=e.pid.toString();var i=j.intance.m_dicCountry.get(e.country);this.img_country.skin=R.instance.getCountryIcon(e.country+""),this.tf_address.text=this.formatWalletAddress(z.instance.walletAddress);let a=e.icon;this.playerIcon.headSkin=a,this.onGetAttr(e.pid)}formatWalletAddress(e){let n="...";return e.length<=12+10?e:`${e.substring(0,12)}${n}${e.substring(e.length-10)}`}onGetAttr(e){return _(this,null,function*(){let i=this,a=yield tt.requestPost("wxgame/player/getPlayerInfo",{pid:e});if(a){var n=[["1","Fighting",a.fightTimes],["2","Victory",a.winTimes],["3","Fail",a.fightTimes-a.winTimes],["4","Run away",a.taopao],["5","Winning rate",Math.floor(a.fightTimes==0?0:a.winTimes/a.fightTimes*100)]];i.list_attrs.array=n}else at.instance.notice(f.instance.getLanguage(135))})}onChangeHead(){V.intance.openModule(p.SelectHeadDialog,!0)}onCopy(){let e=z.instance.walletAddress;doCopy(e),at.instance.notice(f.instance.getLanguage(132))}onDisable(){d.intance.off(b.ROLE_INFO_CHANGE,this,this.updateRoleInfo)}};hr=u([fu("T7g565QQR7-fZgZNjVg92A")],hr);var dr=class extends Laya.Dialog{};var{regClass:Lu}=Laya,yr=class extends dr{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}setOpenData(e){}onEnable(){this.list_head.vScrollBarSkin="",this.btn_confirm.on(Laya.Event.CLICK,this,this.onRegister),this.btn_custom.on(Laya.Event.CLICK,this,this.onBtnChangePic),this.input_name.prompt=f.instance.getLanguage("31"),this.initContainer()}initContainer(){this.list_head.vScrollBarSkin="",this.list_head.selectHandler=new Laya.Handler(this,this.handleSelectHead),this.createHeadList(),this.initCountry()}handleSelectHead(e){if(e!=-1){let i=this.list_head.selectedItem;S.instance.headId=i.id,this.playerIcon.headSkin=S.instance.headId}}createHeadList(){let e=j.intance.m_dicHead;this.list_head.array=e.values,this.list_head.visible=!0;let i=-1,a=0;S.instance.headId=S.instance.playerDto.icon,this.playerIcon.headSkin=S.instance.headId,this.input_name.text=S.instance.playerDto.name;for(let n of e.values){if(n.id==S.instance.headId){i=a;break}a++}this.list_head.selectedIndex=i}initCountry(){this.list_country.selectHandler=new Laya.Handler(this,this.handleSelectCountry),this.createCountryList(),this.box_country.on(Laya.Event.CLICK,this,this.onOpenCountry),this.list_country.on(Laya.Event.MOUSE_DOWN,this,this.onListDown),this.list_country.mouseHandler=Laya.Handler.create(this,this.onCountryItemMouse,null,!1),this.list_country.renderHandler=Laya.Handler.create(this,this.onCountryItemRender,null,!1),this.list_country.scrollBar&&this.list_country.scrollBar.on(Laya.Event.MOUSE_DOWN,this,this.onScrollBarDown)}onCountryItemMouse(e,i){e.type===Laya.Event.CLICK&&(this.list_country.selectedIndex=i,this.onHideCountry())}onListDown(e){e.stopPropagation()}onScrollBarDown(e){e.stopPropagation()}onCountryItemRender(e,i){e.onChange(this.list_country.selectedIndex==i)}onOpenCountry(){this.img_country_pad.visible==!1&&(this.img_country_pad.visible=!0,Laya.stage.once(Laya.Event.MOUSE_DOWN,this,this.onHideCountry))}onHideCountry(){this.img_country_pad.visible=!1,Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onHideCountry)}handleSelectCountry(e){if(console.log("handleSelectCountry: "+e),e!=-1){let i=this.list_country.selectedItem;S.instance.countryId=i.id,this.img_flag.skin=R.instance.getCountryIcon(i.id),this.tf_country.text=f.instance.getLanguage(i.name)}}createCountryList(){let e=j.intance.m_dicCountry;this.list_country.array=e.values,this.list_country.visible=!0;let i=-1,a=0;S.instance.countryId=S.instance.playerDto.country;for(let n of e.values){if(n.id==S.instance.countryId){i=a;break}a++}this.list_country.selectedIndex=i}onBtnChangePic(){var e=Laya.Render.canvas.style.zIndex,i=f.instance.getUILang("Upload picture"),a=f.instance.getUILang("Select Image"),n=f.instance.getUILang("Save changes");openUploadPic(this,e,i,a,n)}openPicEnd(e,i){return _(this,null,function*(){if(i.length>500){let a=yield tt.requestPost("wxgame/player/uploadImg",{base64Str:i},!1,!1);a&&(S.instance.headId=a.imgUrl,e.playerIcon.headSkin=a.imgUrl,e.list_head.selectedIndex=-1,console.log(a.imgUrl))}})}onRegister(){let e=this.input_name.text;if(e=e.trim(),e==""){at.instance.notice(f.instance.getLanguage(31));return}S.instance.headId!=-1?this.onModify(e,S.instance.headId,S.instance.countryId):at.instance.notice(f.instance.getLanguage(134))}onModify(e,i,a){return _(this,null,function*(){if(e==""){at.instance.notice(f.instance.getLanguage(31));return}let n=yield ti.instance.updateProfile(e,i.toString(),a);this.destroyed||(n?(S.instance.playerDto=n,this.close(),d.intance.event(b.ROLE_INFO_CHANGE)):at.instance.notice(f.instance.getLanguage(135)))})}};yr=u([Lu("3CibwwHGSPG2Qkeq4rbMag")],yr);var Ee=class Ee{constructor(){}static trim(t,e=null){e||(e=[" ","\r",`
`,"	",String.fromCharCode(65279)]);var i,a,n;for(i=t,n=e.length,a=0;a<n;a++)i=Ee.getReplace(i,e[a],"");return i}static getReplace(t,e,i){if(!t)return"";var a;return a=t.replace(new RegExp(e,"g"),i),a}static isEmpty(t){return t.length<1?!0:Ee.emptyStrDic.hasOwnProperty(t)}static trimLeft(t){var e;e=0;var i;for(i=t.length;Ee.isEmpty(t.charAt(e))&&e<i;)e++;return e<i?t.substr(e):""}static trimRight(t){var e;for(e=t.length-1;Ee.isEmpty(t.charAt(e))&&e>=0;)e--;var i;return i=t.substring(0,e),e>=0?t.substring(0,e+1):""}static trimSide(t){var e;return e=Ee.trimLeft(t),e=Ee.trimRight(e),e}static shortStr(t,e){return t.length>e?t.substr(0,e)+"...":t}static shortHeroStr(t,e=10){if(t.length>e){let i=t.split("#"),a=i[0],n=i[1];return a.substr(0,3)+"...#"+n}else return t}static caseInsensitiveSearchWithRegex(t,e){return new RegExp(e,"i").test(t)}};Ee.emptyStrDic={" ":!0,"\r":!0,"\n":!0,"	":!0};var Qt=Ee;var gr=class extends Laya.Dialog{};var{regClass:_u}=Laya,Te=class extends Laya.Script{constructor(){super();this._isLeft=!1}onAwake(){}get isLeft(){return this._isLeft}set isLeft(e){this._isLeft=e,this.btn_bg=this.owner.getChildByName("btn_bg"),this.label_left=this.owner.getChildByName("label_left"),this.label_right=this.owner.getChildByName("label_right"),this.isLeft?(this.btn_bg.x=4,this.label_left.color="#213343",this.label_right.color="#52a5e0"):(this.btn_bg.x=this.owner.width-this.btn_bg.width-4,this.label_left.color="#52a5e0",this.label_right.color="#213343")}};Te=u([_u("-1MGS4JRSMOn_RKPUuuV9Q")],Te);var{regClass:vu}=Laya,br=class extends gr{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}onEnable(){this.musicSwitchButton=this.box_music.getComponent(Te),this.soundSwitchButton=this.box_sound.getComponent(Te),this.languageSwitchButton=this.box_language.getComponent(Te),this.initContainer(),this.box_music.on(Laya.Event.CLICK,this,this.onClickHandler,[this.box_music]),this.box_sound.on(Laya.Event.CLICK,this,this.onClickHandler,[this.box_sound]),this.box_language.on(Laya.Event.CLICK,this,this.onClickHandler,[this.box_language]),this.btn_copy.clickHandler=new Laya.Handler(this,this.onClickHandler,[this.btn_copy]),this.btn_referral.on(Laya.Event.CLICK,this,this.onClickHandler,[this.btn_referral])}onClickHandler(e){switch(e){case this.box_music:this.musicSwitchButton.isLeft=!this.musicSwitchButton.isLeft,bt.instance.switchMusic(this.musicSwitchButton.isLeft);break;case this.box_sound:this.soundSwitchButton.isLeft=!this.soundSwitchButton.isLeft,bt.instance.switchSound(this.soundSwitchButton.isLeft);break;case this.btn_referral:V.intance.openModule(p.InviteRewardDialog);break;case this.box_language:{this.languageSwitchButton.isLeft=!this.languageSwitchButton.isLeft;let i=this.languageSwitchButton.isLeft?"zh":"en";f.instance.FGM_SetLanguage(i),mt.instance.reload()}break;case this.btn_copy:{let i=this.inviteUrl;_t.doCopy(i),at.instance.notice(f.instance.getLanguage(132))}break}}initContainer(){this.musicSwitchButton.isLeft=bt.instance.m_bPlayMusic,this.soundSwitchButton.isLeft=bt.instance.m_bPlayeSound,this.languageSwitchButton.isLeft=S.instance.m_strLanguage==6,this.inviteUrl=ee.getInviteUrl(),this.label_url.text=Qt.shortStr(this.inviteUrl,50)}addEvent(){}removeEvent(){}webCopyString(e){let i=e,a=window.document.createElement("textarea");a.value=i,a.setAttribute("readonly",""),a.style.contain="strict",a.style.position="absolute",a.style.left="-9999px",a.style.fontSize="12pt";let n=window.getSelection(),r=!1;n.rangeCount>0&&(r=n.getRangeAt(0)),window.document.body.appendChild(a),a.select(),a.selectionStart=0,a.selectionEnd=i.length;let o=!1;try{o=window.document.execCommand("copy")}catch(l){console.error(l)}return window.document.body.removeChild(a),r&&(n.removeAllRanges(),n.addRange(r)),o}};br=u([vu("yJfJZzgZRluE_rgB44yTvg")],br);var fr=class extends Laya.Box{};var{regClass:wu}=Laya,Lr=class extends fr{set dataSource(t){super.dataSource=t;var e=t;e&&(this.img_icon.skin=R.instance.getAttrIcon(e[0]),this.tf_name.text=f.instance.getUILang(e[1]),this.tf_num.text=e[2])}};Lr=u([wu("lWiDi5bCR-CNy4v3ZMd42w")],Lr);var _r=class extends Laya.Dialog{};var de=class{constructor(){}};de.UPDATE_HERO_EVENT="HeroEvent:UPDATE_HERO_EVENT",de.UPDATE_HERO_UPGRADE_EVENT="HeroEvent:UPDATE_HERO_UPGRADE_EVENT";var{regClass:Iu}=Laya,vr=class extends _r{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}setOpenData(e){e&&(this._vo=e)}onComplete(){}onEnable(){this.showViewByVo(this._vo),this.btn_last.on(Laya.Event.CLICK,this,this.onClickLast),this.btn_next.on(Laya.Event.CLICK,this,this.onClickNext),this.btn_upgrade.on(Laya.Event.CLICK,this,this.onClickUpgrade),this.btn_out.on(Laya.Event.CLICK,this,this.onClickOut)}onClickUpgrade(){V.intance.openModule(p.HeroUpgradeDialog,this._vo)}onClickNext(){let e=zt.instance.getNextHero(this._vo);e&&(this._vo=e,this.showViewByVo(e))}onClickLast(){let e=zt.instance.getLastHero(this._vo);e&&(this._vo=e,this.showViewByVo(e))}addEvent(){d.intance.on(de.UPDATE_HERO_UPGRADE_EVENT,this,this.onHeroUpgrade),this.stage.on(Laya.Event.CLICK,this,this.hideTips);for(let e=1;e<7;e++)this["equip"+e].on(Laya.Event.CLICK,this,this.onClickEquip)}hideTips(){}onClickEquip(e){}removeEvent(){d.intance.off(de.UPDATE_HERO_UPGRADE_EVENT,this,this.onHeroUpgrade)}onHeroUpgrade(){this._vo=S.instance.m_heroData.heroVoDic.get(this._vo.pk),this._vo&&this.showViewByVo(this._vo)}updateEquip(){let e=this._vo.equipDtoList;for(let i=0;i<e.length;i++){let a=e[i];this["equip"+(i+1)].dataSource=a}}showViewByVo(e){return _(this,null,function*(){this.txt_name.text=e.name;let i=e.heroItem.level+"";zt.instance.setStar(this,i),this.box_star.visible=!0,this.heroSk.dataSource=e;var a=[["maxHp","MaxHP",e.heroItem.maxHp],["atk","ATK",e.heroItem.atk],["def","DEF",e.heroItem.def],["mov","MOV",e.heroItem.mov],["crt","CRT",e.heroItem.crt],["crtRate","CrtRate",e.heroItem.crtRate/1e4+"%"],["immunity","Immunity",e.heroItem.immunity],["dex","Dex",e.heroItem.dex],["miss","MISS",e.heroItem.miss]];this.list_attrs.array=a;var n=[];e.heroItem.skillIds.forEach(r=>{var o=j.intance.m_dicSkills.get(r);n.push(o)}),this.list_skills.array=n,this.updatePk()})}updatePk(){S.instance.playerDto.fightHeroPk==this._vo.pk?(this.box_sign.visible=!0,this.btn_out.disabled=!0,this.btn_out.label=f.instance.getLanguage(1038)):(this.box_sign.visible=!1,this.btn_out.disabled=!1,this.btn_out.label=f.instance.getLanguage(1037))}onClickOut(){return _(this,null,function*(){let e=this,i=yield tt.requestPost("wxgame/hero/heroFight",{pk:this._vo.pk});i?(S.instance.playerDto.fightHeroPk=i.pk,e.updatePk(),d.intance.event(de.UPDATE_HERO_EVENT)):at.instance.notice(f.instance.getLanguage(135))})}};vr=u([Iu("Qri7gUY9SiWsYhtvNCEOQQ")],vr);var wr=class extends Laya.Box{};var{regClass:Su}=Laya,Ir=class extends wr{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,this.heroVo=e,!this.heroVo){this.img_back.skin=R.instance.getHeroBackIcon(0),this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){var e=[];S.instance.playerDto.fightHeroPk==this.heroVo.pk&&e.push({img_state:{skin:"gameIcon/hero/heroDetail/img_hero_state_1.png"}}),this.list_state.dataSource=e,this.img_back.skin=R.instance.getHeroBackIcon(this.heroVo.heroItem.quality),this.img_front.skin=R.instance.getHeroFrontIcon(this.heroVo.heroItem.quality),this.img_hero.skin=this.heroVo.simgurl,this.tf_name.text=Qt.shortHeroStr(this.heroVo.name);let i=this.heroVo.heroItem.level+"";zt.instance.setStar(this,i),this.box_show.visible=!0,this.destroyed})}toDetail(){this.heroVo.id&&V.intance.openModule(p.HeroDetailDialog,this.heroVo)}};Ir=u([Su("PfeS1F4rQCqM4vXJpBZVWQ")],Ir);var Lt=class Lt{constructor(){}};Lt.ANI_beiji="beiji",Lt.ANI_daiji="daiji",Lt.ANI_gongji="gongji",Lt.ANI_ti="ti",Lt.ANI_hua="hua",Lt.ANI_dang="gedang",Lt.ANI_ruchang="ruchang",Lt.ANI_siwang="siwang",Lt.ANI_xingzou="xingzou",Lt.ANI_chongzhuang="z_chongzhuang",Lt.ANI_chongzhuang2="z_chongzhuang2",Lt.ANI_daodi="z_daodi",Lt.ANI_shanbi="z_shanbi",Lt.ANIS=[Lt.ANI_daiji,Lt.ANI_xingzou,Lt.ANI_gongji,Lt.ANI_ti,Lt.ANI_hua,Lt.ANI_dang,Lt.ANI_beiji,Lt.ANI_siwang],Lt.TYPE_GONGJI=1,Lt.TYPE_TI=2,Lt.TYPE_HUA=3,Lt.TYPE_DANG=4,Lt.TYPE_FEI=5;var Tt=Lt;var Sr=class extends Laya.Box{};var{regClass:Eu}=Laya,Er=class extends Sr{constructor(){super();this.isAddEvent=!1;this.isReady=!1;this.skinIndex=0;this.spineAniIndex=0;this.skinArray=["goblin","goblingirl"]}addEvent(){this.isAddEvent||(this.isAddEvent=!0,this.on(Laya.Event.CLICK,this,this.changeAni),this.sk.on(Laya.Event.READY,this,this.onSkReady))}onSkReady(){this.isReady=!0}set dataSource(e){super.dataSource=e,this.heroVo=e,this.addEvent(),this.createSpine()}createSpine(){Laya.loader.load(this.heroVo.sk,Laya.Loader.SPINE).then(e=>{this.destroyed||(this.sk.templet=e,this.sk.animationName=Tt.ANI_daiji,this.spineAniNum=Tt.ANIS.length)})}changeAni(){if(this.isReady){this.spineAniIndex++,this.spineAniIndex>=this.spineAniNum&&(this.spineAniIndex=0);var e=Tt.ANIS[this.spineAniIndex];this.sk.play(e,!0,!0)}}changeSkin(){this.sk.showSkinByName(this.skinArray[this.skinIndex]),++this.skinIndex>=this.skinArray.length&&(this.skinIndex=0)}onDisable(){this.sk.off(Laya.Event.READY,this,this.onSkReady)}};Er=u([Eu("kS5K53GHRWOdgfXoo6VH1A")],Er);var Tr=class extends Laya.Scene{};var{regClass:Tu}=Laya,Dr=class extends Tr{onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP}onEnable(){this.list_hero.vScrollBarSkin="",this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),d.intance.on(de.UPDATE_HERO_EVENT,this,this.createHeadList),this.initMyHeroView(),this.initContainer()}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN)}initMyHeroView(){return _(this,null,function*(){})}onListEvent(e,i){switch(e.type){case Laya.Event.CLICK:this.list_hero.selectedIndex=i,this.handleSelectHero(i);break}}onRenderList(e,i){let a=e.dataSource}initContainer(){this.list_hero.visible=!1,this.list_hero.vScrollBarSkin="",this.list_hero.mouseHandler=new Laya.Handler(this,this.onListEvent),this.list_hero.renderHandler=new Laya.Handler(this,this.onRenderList),this.createHeadList()}handleSelectHero(e){let i=this.list_hero.selectedItem}createHeadList(){return _(this,null,function*(){if(yield Pt.instance.ownerHero(),!this)return;let e=S.instance.m_heroData.heroVoDic.values;if(e&&e.length>9){this.list_hero.array=e,this.list_hero.visible=!0,this.tf_noData.visible=!1;let n=-1;this.list_hero.selectedIndex=n}else{let n=[];for(var i=0;i<10;i++){var a=e[i];a?n.push(a):n.push(null)}this.list_hero.array=n,this.list_hero.visible=!0,this.tf_noData.visible=!1}})}handleClickBtn(e){switch(e){}}onDisable(){d.intance.off(de.UPDATE_HERO_EVENT,this,this.createHeadList)}};Dr=u([Tu("eEFn-xcRTXagUEZFDdSujw")],Dr);var Cr=class extends Laya.Box{};var{regClass:Du}=Laya,Mr=class extends Cr{set dataSource(t){super.dataSource=t;var e=t;e&&(this.tf_name.text=f.instance.getUILang(e[1]),this.tf_num.text=e[2])}};Mr=u([Du("BFrnzfZDRh2v3vDKqrNVwA")],Mr);var xr=class extends Laya.Box{};var{regClass:Cu}=Laya,Ar=class extends xr{constructor(){super();this.isBig=!1;this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.skillItem=e,this.skillItem&&(this.txt_num.text="",this.img_icon.skin=R.instance.getSkillIcon(this.skillItem.icon,this.isBig))}};Ar=u([Cu("qJVd2M3_Td-5eIx8PsQpAw")],Ar);var Rr=class extends Laya.Box{};var{regClass:Mu}=Laya,kr=class extends Rr{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.skillItem=e,this.skillItem&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){this.skillItem&&(this.skillIconItem.dataSource=this.skillItem)})}toDetail(){this.skillItem&&V.intance.openModule(p.SkillTipDialog,this.skillItem)}};kr=u([Mu("VRh1GpjHSyqm75euC37ZKw")],kr);var Or=class extends Laya.Dialog{};var{regClass:xu}=Laya,Pr=class extends Or{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}setOpenData(e){e&&(this.skillItem=e)}onEnable(){this.item.dataSource=this.skillItem,this.tf_name.text=f.instance.getLanguage(this.skillItem.name);var e=[["type","S_type",f.instance.getUILang("S_type_"+this.skillItem.type)],["distance","S_distance",this.skillItem.distance],["hurt","S_hurt",this.skillItem.hurt/1e4+"%"],["cd","S_cd",this.skillItem.cd+f.instance.getUILang("S_S")],["displacement","S_displacement",this.skillItem.displacement],["targetsType","S_targetsType",f.instance.getUILang("S_targetsType"+this.skillItem.targetsType)]];this.list_skillAttrs.array=e}removeEvent(){}};Pr=u([xu("PiBuXnP8ToeveVbB_bfhUQ")],Pr);var Nr=class extends Laya.Box{};var{regClass:Au}=Laya,Br=class extends Nr{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}set dataSource(e){super.dataSource=e,this.itemVo=e,this.itemVo&&this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){if(!this.itemVo)return;let e=this.itemVo.itemItem;this.knapsackItem.dataSource=this.itemVo,e?this.disabled=!1:this.disabled=!0})}toDetail(){!this.itemVo||!this.itemVo.needTip||(this.itemVo.type===Ut.TYPE_Equipment?V.intance.openModule(p.EquipDetailDialog,this.itemVo):V.intance.openModule(p.KnapsackTipDialog,this.itemVo))}};Br=u([Au("HYoZb6e-RFKj8fjDKbl-7Q")],Br);var Hr=class extends Laya.Dialog{};var{regClass:Ru}=Laya,Ur=class extends Hr{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}onEnable(){this.initContainer(),bt.instance.playSoundByName(bt.soundName32)}initContainer(){var e=ft.instance.getOneItem();e&&this.showItem(e)}showItem(e){this.knapsackItem.showAdd=!0,this.knapsackItem.dataSource=e,this.tf_name.text=f.instance.getLanguage(e.itemItem.name)}onDisable(){d.intance.event(b.EVENT_CHECK_REMAIN,p.ItemGetDialog)}};Ur=u([Ru("tC2uDJDVQMaI41Lys60O5Q")],Ur);var Vr=class extends Laya.Box{};var{regClass:ku}=Laya,Gr=class extends Vr{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.itemVo=e,this.itemVo&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){if(!this.itemVo)return;let e=this.itemVo.itemItem;e?(this.showAdd?this.txt_num.text=this.itemVo.newAddCnt+"":this.txt_num.text=this.itemVo.m_iNum+"",this.img_icon.skin=R.instance.getItemIcon(e.icon),this.img_box.skin="gameIcon/items/itemBg/img_"+e.quality+".png"):(this.txt_num.text="",this.img_icon.skin=null,this.img_box.skin="gameIcon/items/itemBg/img_0.png")})}toDetail(){!this.itemVo||!this.itemVo.needTip||(this.itemVo.type===Ut.TYPE_Equipment?V.intance.openModule(p.EquipDetailDialog,this.itemVo):V.intance.openModule(p.KnapsackTipDialog,this.itemVo))}};Gr=u([ku("LzxJYKybT_m3CJav3RyDmg")],Gr);var Fr=class extends Laya.Scene{};var{regClass:Ou}=Laya,Kr=class extends Fr{constructor(){super(...arguments);this.currTab=0;this.type=1;this.items=[];this.hasItem=!1}onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP}onOpened(e){this.type=e}onEnable(){this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.listPanel1.vScrollBarSkin="",this.listPanel1.selectHandler=Laya.Handler.create(this,this.onSelectItem,null,!1),this.box_show.visible=!1,this.box_2.visible=!1,this.initLuckDrawView();let e=(Laya.stage.height-X.DESIGN_HEIGHT)/2}setTab(e){for(let i=1;i<3;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe")}initLuckDrawView(){return _(this,null,function*(){yield Pt.instance.ownerBag(),!this.destroyed&&(this.type?this.onClickTab(this.type):this.onClickTab(1))})}onClickTab(e){if(this.currTab!=e){if(this.setTab(e),e==1){if(this.box_2.visible=!0,this.destroyed)return;var i=this.getItemByType(1);this.listPanel1.array=i}else{if(this.box_2.visible=!0,this.destroyed)return;var i=this.getItemByType(2);this.listPanel1.dataSource=i}this.hasItem?this.listPanel1.selectedIndex=0:this.listPanel1.selectedIndex=-1}}getItemByType(e){var i=e==1?Ut.TYPE_Consumption:Ut.TYPE_Equipment;this.items=[],this.hasItem=!1;for(var a=S.instance.m_packageData.getListByType(i),n=0;n<30;n++){var r=a[n];r?(n==0&&(this.hasItem=!0),this.items.push(r)):this.items.push(new ue(0))}return this.items}onSelectItem(e,i){var a=this.items[e];if(console.log(a),a){let n=a.itemItem;this.img_icon.skin=R.instance.getItemIcon(n.icon),this.tf_name.text=f.instance.getLanguage(n.name),this.tf_des.text=f.instance.getLanguage(n.des),this.box_show.visible=!0}else this.img_icon.skin=null,this.tf_name.text="",this.tf_des.text="",this.box_show.visible=!1}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN)}onShowSkill(){V.intance.openModule(p.SkillTipDialog)}stopAni(e){console.log("stopAni: "+e)}onDrawBack(e){}removeEvent(){}};Kr=u([Ou("6IPqO9JvTmygjIZQXMwq2A")],Kr);var Wr=class extends Laya.Dialog{};var{regClass:Pu}=Laya,Yr=class extends Wr{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}setOpenData(e){e&&(this.itemVo=e)}onEnable(){this.item.dataSource=this.itemVo;let e=this.itemVo.itemItem;this.tf_name.text=f.instance.getLanguage(e.name),this.txt_type.text=f.instance.getLanguage("6060")+f.instance.getLanguage(e.type),this.txt_desc.text=f.instance.getLanguage(e.des),this.btn_use.visible=e.use!="0",this.btn_use.clickHandler=new Laya.Handler(this,this.useItem)}useItem(){return _(this,null,function*(){this.close()})}removeEvent(){}};Yr=u([Pu("or8jNdIhRpSbAG2JBhH-wA")],Yr);var jr=class extends Laya.Box{};var{regClass:Nu}=Laya,Xr=class extends jr{constructor(){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}onEnable(){console.log("OpenScene onEnable："+this.m_strName)}getName(){console.log(this.m_strName)}onDisable(){}};Xr=u([Nu("sQS5mrqRQLWcBk-SgfBGJw")],Xr);var qr=class extends Laya.Box{};var{regClass:Bu}=Laya,zr=class extends qr{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.check_coin.on(Laya.Event.CLICK,this,this.onCheck),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.addEvent();let i=e;this.check_coin.selected=i[1],this.tf_coin.text=i[2]}onCheck(){this._dataSource[1]=this.check_coin.selected,d.intance.event(b.EVENT_CHECK_ICON_SELECT)}};zr=u([Bu("UTGHsPbQS6C5FohXv8T25Q")],zr);var Qr=class extends Laya.Dialog{};var{regClass:Hu}=Laya,Jr=class extends Qr{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER;this.coinType=3001;this.coinIds=[]}setOpenData(e){e&&(this.arenaLv=e[0])}onEnable(){this.btn_create.on(Laya.Event.CLICK,this,this.onCreate),this.initContainer()}initContainer(){let e=S.instance.playerDto;if(!e)return;this.tf_roleName.text=e.name;let i=e.icon;this.playerIcon.headSkin=i,this.img_country.skin=R.instance.getCountryIcon(e.country+""),this.initCombo()}initCombo(){this.coinIds=j.intance.getGeneralValueById(5);var e=[];this.coinIds.forEach(i=>{var a=j.intance.m_dicItems.get(i);e.push(f.instance.getLanguage(a.name))}),this.coinCombo.selectHandler=new Laya.Handler(this,this.onSelected2),this.coinCombo.dataSource=e,this.coinCombo.selectedIndex=0}onSelected2(e){e!=-1&&(this.coinType=this.coinIds[e],console.log("您选中了 coinType"+this.coinType),this.setRoomInfo())}setRoomInfo(){this.arenaItem=j.intance.getSheetDataByMultiKey(j.intance.m_dicArenaMulDic,[this.arenaLv,this.coinType]),this.tf_roomName.text=f.instance.getLanguage(this.arenaItem.name),this.tf_min.text=this.arenaItem.numberMin+"",this.tf_max.text=this.arenaItem.numberMax+""}onCreate(){return _(this,null,function*(){let e=this.input_pwd.text;var i=this.arenaItem.id;if(i){let a=yield tt.requestPost("wxgame/room/create",{password:e,arenaId:i});W.instance.roomDto=a.roomDto,a.roomDto?(this.close(),V.intance.openModule(p.EnterRoomView)):at.instance.notice(f.instance.getLanguage(135))}})}};Jr=u([Hu("_y9qJpZZRk2p26xdgYPRyA")],Jr);var Mt=class Mt{constructor(){}static formatMM(t){if(t<=0)return"00:000";let e,i;e=t/1e3,i=t%1e3;let a="";return e<=9&&(a+="0"),a+=Math.floor(e),a+=":",i<=9?a+="00":i<=99&&(a+="0"),a+=i,a}static format(t,e=":",i=!0){if(t<=0)return i?"00:00:00":"00:00";let a,n,r,o,l;o=t/3600,r=t%3600,l=r/60,a=r%60;let v="";return i&&(o<=9&&(v+="0"),v+=Math.floor(o)+e),l<=9&&(v+="0"),v+=Math.floor(l)+e,Math.ceil(a)<=9&&(v+="0"),v+=Math.ceil(a),v}static formatWithDay(t,e=":"){if(t<=0)return"00:00";let i,a,n,r,o;a=t/86400,n=t%86400,r=n/3600,n=n%3600,o=n/60,i=n%60;let l="";if(a>=1){let v=a>1?2005:2003;l=f.instance.getLanguage(v,Math.floor(a))+" ",r<=9&&(l+="0"),i%2!=0&&(e=_t.getColorText(e,"#412b20")),l+=Math.floor(r)+e,o<=9&&(l+="0"),l+=Math.floor(o)}else r<=9&&(l+="0"),l=Math.floor(r)+e,o<=9&&(l+="0"),l+=Math.floor(o)+e,Math.ceil(i)<=9&&(l+="0"),l+=Math.ceil(i);return l}static getTimeArray(t,e="HH-MM-SS"){if(t=Math.max(0,t),e.indexOf("-")==-1)return[];let i=[],a=e.split("-");for(let n of a)n=="DD"?i.push(Math.floor(t/Mt.OneDaySceond)):n=="HH"?i.push(Math.floor(t%Mt.OneDaySceond/Mt.OneHourSceond)):n=="MM"?i.push(Math.floor(t%Mt.OneHourSceond/Mt.OneMiniuteSecond)):n=="SS"&&i.push(t%Mt.OneMiniuteSecond);return i}static getServerDate(t){return new Date(t)}static formatTime(t){return(parseInt(t/60+"")+100).toString().substring(1)+":"+(parseInt(t%60+"")+100).toString().substring(1)}static formatTime000000(t){return t?(parseInt(t/3600+"")+100).toString().substring(1)+":"+(parseInt(t%3600/60+"")+100).toString().substring(1)+":"+(parseInt(t%60+"")+100).toString().substring(1):"00:00:00"}static formatTimeStamp(t,e="YY-MT-DD HH:MM:SS"){let i=Mt.getServerDate(t),a="";if(e.indexOf("YY")>=0&&(a=i.getFullYear()+"",e=e.replace("YY",a)),e.indexOf("MT")>=0){let n=i.getMonth()+1;n>9?a=n+"":a="0"+n,e=e.replace("MT",a)}if(e.indexOf("DD")>=0){let n=i.getDate();n>9?a=n+"":a="0"+n,e=e.replace("DD",a)}if(e.indexOf("HH")>=0){let n=i.getHours();n>9?a=n+"":a="0"+n,e=e.replace("HH",a)}if(e.indexOf("MM")>=0){let n=i.getMinutes();n>9?a=n+"":a="0"+n,e=e.replace("MM",a)}if(e.indexOf("SS")>=0){let n=i.getSeconds();n>9?a=n+"":a="0"+n,e=e.replace("SS",a)}return e}static formatTimeStamps(t,e="YY-MT-DD HH:MM:SS"){let i=Mt.getServerDate(t),a=e;return a=Mt.parseTimeDetail(i,a,"YY",!1),a=Mt.parseTimeDetail(i,a,"MT",!1),a=Mt.parseTimeDetail(i,a,"DD",!1),a=Mt.parseTimeDetail(i,a,"HH",!0),a=Mt.parseTimeDetail(i,a,"MM",!0),a=Mt.parseTimeDetail(i,a,"SS",!0),a}static parseTimeDetail(t,e,i,a){if(e.indexOf(i)>=0){let n,r;i=="YY"?r=t.getFullYear():i=="MT"?r=t.getMonth()+1:i=="DD"?r=t.getDate():i=="HH"?r=t.getHours():i=="MM"?r=t.getMinutes():i=="SS"&&(r=t.getSeconds()),r>9||!a?n=r.toString():n="0"+r,e=e.replace(i,n)}return e}static getServerTimeStr(){return Mt.formatTimeStamp(Laya.timer.currTimer)}static getTimeArr(){return Mt.getServerTimeStr().split("/")}static get getDay(){let e=Mt.getServerTimeStr().split("/");return parseInt(e[2])}static parseSheetTime(t){let e="";if(t){let i=t.length;for(let a=0;a<i;a++){let n="";t[a]<10?n="0"+t[a]:n=t[a],a!==i-1&&(n=n+":"),e+=n}}return e}};Mt.OneDaySceond=24*3600,Mt.OneHourSceond=3600,Mt.OneMiniuteSecond=60;var He=Mt;var Zr=class extends Laya.Dialog{};var{regClass:Uu}=Laya,$r=class extends Zr{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_PANEL;this.m_iPositionType=x.CENTER}onEnable(){d.intance.event(b.EVENT_ENTER_MATCH_ROOM),this.initContainer()}initContainer(){this.list_wait_hero.visible=!0;var e=W.instance.roomDto,i=e.roomId,a=e.arenaId,n=e.coinType,r=j.intance.m_dicArenaDic.get(a);W.instance.currArenaItem=r,this.tf_roomName.text=f.instance.getLanguage(r.name),this.arenaNo.text=i+"",this.initRoomData(),Laya.timer.loop(1e3,this,this.onRefreshRoom)}updateBattleCD(){W.instance.coolDownTime=Math.round(W.instance.roomDto.joinCd/1e3),W.instance.coolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):(Laya.timer.clear(this,this.onSetCoolTime),this.onGoMatch())}onSetCoolTime(){W.instance.coolDownTime>=0?(this.tf_coolTime.text=f.instance.getLanguage("The battle is to begin: ")+"<font color='#ff5388'>"+He.format(W.instance.coolDownTime)+"</font>",W.instance.coolDownTime--):(Laya.timer.clear(this,this.onSetCoolTime),Laya.timer.clear(this,this.onRefreshRoom),this.onGoMatch())}onGoMatch(){Laya.timer.clearAll(this),It.instance.initSocket()}handleSelectHead(e){}initRoomData(){var e=W.instance.roomDto.members.length;if(this.tf_people.text=e+"",e>=30){this.onGoMatch();return}this.heros=[];for(var i=0;i<30;i++){var a=W.instance.roomDto.members[i];a?this.heros.push(a):this.heros.push(null)}this.list_wait_hero.array=this.heros,this.list_wait_hero.visible=!0,this.updateBattleCD()}onRefreshRoom(){return _(this,null,function*(){let e=yield tt.requestPost("wxgame/room/info",{roomId:W.instance.roomDto.roomId});W.instance.roomDto=e.roomDto,this.initRoomData(),W.instance.setMatchRes()})}handleClickBtn(e){switch(e){}}onDisable(){this.removeEvent(),console.log("EnterRoomView onDisable")}removeEvent(){Laya.timer.clearAll(this)}};$r=u([Uu("IwpLh2K2T5Gh7QXYnJakAw")],$r);var ts=class extends Laya.Dialog{};var{regClass:Vu}=Laya,es=class extends ts{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}setOpenData(e){e&&(this.roomDto=e[0])}onEnable(){this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.initContainer()}initContainer(){var e=j.intance.m_dicItems.get(this.roomDto.coinType),i=f.instance.getLanguage(e.name),a=j.intance.m_dicArenaDic.get(this.roomDto.arenaId);this.tf_roomName.text=f.instance.getLanguage(a.name),this.input_pwd.text=""}onJoin(){return _(this,null,function*(){let e=this.input_pwd.text,i=yield tt.requestPost("wxgame/room/join",{roomId:this.roomDto.roomId,pass:e});W.instance.roomDto=i.roomDto,i.roomDto?V.intance.openModule(p.EnterRoomView):at.instance.notice(f.instance.getLanguage(135))})}};es=u([Vu("bn6StZy0ROGBH9GCTateCA")],es);var is=class extends Laya.Scene{};var as=class s{constructor(){this._inited=!1}static getInstance(){return s._instance||(s._instance=new s),s._instance}init(){this._inited||(this._inited=!0,S.instance.initData())}};var{regClass:Gu}=Laya,ns=class extends is{constructor(){super(...arguments);this.currTab=0;this.arenaLv=1001;this.coinTypes=[];this.currIconAni=1;this.coinDatas=[]}onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP,as.getInstance().init()}onOpened(e){this.mouseThrough=this.mouseThrough=!0,this.headBox.mouseThrough=!0;let i=this.getChildByName("mcMain");i&&(i.mouseThrough=!0),this.updateTopInfo(),this.initCombo(),this.onClickTab(1);var a=Laya.stage.width-X.DESIGN_WIDTH>>1;this.leftX=this.leftMenu.x,this.rightX=this.rightMenu.x,this.leftMenu.x=this.leftX-a-this.leftMenu.width,this.rightMenu.x=this.rightX+a+this.rightMenu.width,Laya.Tween.to(this.leftMenu,{x:this.leftX-a},500),Laya.Tween.to(this.rightMenu,{x:this.rightX+a},500),this.initBtnAni()}initBtnAni(){for(var e=1;e<6;e++)this["spine_"+e].on(Laya.Event.READY,this,this.onSkReady,[this["spine_"+e]])}onSkReady(e){e.stop(),e.visible=!1,e==this.spine_5&&this.startBtnAni()}startBtnAni(){this.currIconAni>5&&(this.currIconAni=1),this["spine_"+this.currIconAni].play(0,!1),this["spine_"+this.currIconAni].visible=!0,this.currIconAni++,Laya.timer.once(2e3,this,this.startBtnAni)}changeMailFlag(){}updateTopInfo(){let e=S.instance.playerDto;if(!e)return;this.tf_roleName.text=e.name,this.levelTF.text=e.lv.toString(),e.needTip=!0,this.playerIcon.dataSource=e,this.updateExp(),this.changeMailFlag();let i=new Date(S.instance.m_serverTime);console.log("server time toLocaleString："+i.toLocaleString()),console.log("server time offset date："+S.instance.timeZoneOff/60/60),this.updateLocalAssets()}updateExp(){let e=S.instance.playerDto,i=S.instance.getRealExp(e)/S.instance.getRealNextExp(e);i?this.txt_exp.text=(i*100).toFixed(0)+"%":this.txt_exp.text="0%",i>1&&(i=1),this.levelTF.text=e.lv.toString(),this.img_exp.width=118*i}requestAssets(){d.intance.event(b.UPDATE_ASSETS)}updataBalence(){return _(this,null,function*(){yield z.instance.getBalance()})}updateAssets(){return _(this,null,function*(){yield ei.instance.updateAssetsBalance()})}updateLocalAssets(){this.tf_3005.text=At.filterNumFormat(S.instance.getConsumeValue(Et.TYPE_GOLD),0)}loopTime(){}onEnable(){this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_3.on(Laya.Event.CLICK,this,this.onClickTab,[3]),this.list_room.vScrollBarSkin="",this.list_room.array=[],this.btn_create.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_create]),this.btn_shop.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_shop]),this.btn_guild.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_guild]),this.btn_heroes.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_heroes]),this.btn_backpack.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_backpack]),this.btn_achv.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_achv]),this.btn_scholarshop.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_scholarshop]),this.btn_leaderboard.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_leaderboard]),this.btn_social.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_social]),this.btn_activities.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_activities]),this.btn_collection.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_collection]),this.btn_setting.clickHandler=new Laya.Handler(this,this.onclickBtnHandler,[this.btn_setting]),d.intance.on(b.UPDATE_RED_STATE_EVENT,this,this.changeMailFlag),d.intance.on(b.ROLE_INFO_CHANGE,this,this.updateTopInfo),d.intance.on(b.UPDATE_ASSETS,this,this.updateAssets),d.intance.on(ae.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),d.intance.on("CHANG_NAME",this,this.changeName),d.intance.on("open_buy",this,this.openBuyDialog),d.intance.on("msg_173",this,this.onFirstRecharge),d.intance.on("ACCOUNTVO_UPDATE",this,this.updateExp),d.intance.on(b.EVENT_REMOVE_ACTIVITY,this,this.onBindStateChange),d.intance.on(b.EVENT_CHECK_ICON_SELECT,this,this.onCoinSelected),d.intance.on(b.EVENT_ENTER_MATCH_ROOM,this,this.onEnterMatchRoom),this.initBtnBox()}setTab(e){for(let i=1;i<4;i++)e==i?(this["btn_"+i].getChildByName("btn_yellowBg").visible=!0,this["btn_"+i].getChildByName("Label").color="#143268"):(this["btn_"+i].getChildByName("btn_yellowBg").visible=!1,this["btn_"+i].getChildByName("Label").color="#ffffff")}onClickTab(e){if(this.currTab!=e){if(this.setTab(e),e==1){this.arenaLv=1;var i=this.getRoomByType()}else if(e==2){this.arenaLv=2;var i=this.getRoomByType()}else if(e==3){this.arenaLv=3;var i=this.getRoomByType()}}}getRoomByType(){return _(this,null,function*(){this.arenaLv,this.coinTypes;let e=yield tt.requestPost("wxgame/room/list",{lv:this.arenaLv,coinTypeList:this.coinTypes});this.list_room.array=e.roomList,Laya.timer.once(3e3,this,this.getRoomByType)})}initCombo(){this.coinTypes=[];var e=j.intance.getGeneralValueById(5);this.coinDatas=[],e.forEach(i=>{this.coinTypes.push(i);var a=j.intance.m_dicItems.get(i);this.coinDatas.push([i,!0,f.instance.getLanguage(a.name)])}),this.list_coin.array=this.coinDatas}onCoinSelected(){this.coinTypes=[],this.coinDatas.forEach(e=>{e[1]&&this.coinTypes.push(e[0])}),console.log("您选中了 coinType"+this.coinTypes),this.getRoomByType()}onBindStateChange(){}onFirstRecharge(e){}initBtnBox(){this.sortIconView()}sortIconView(){}onclickBtnHandler(e){return _(this,null,function*(){switch(e){case this.btn_shop:ot.intance.setCurrentScene(J.M_SCENE_SHOP);break;case this.btn_heroes:ot.intance.setCurrentScene(J.M_SCENE_HERO);break;case this.btn_backpack:ot.intance.setCurrentScene(J.M_SCENE_KNAPSACK);break;case this.btn_guild:ot.intance.setCurrentScene(J.M_SCENE_UNION);break;case this.btn_setting:V.intance.openModule(p.GameSettingLanguageDialog);break;case this.btn_create:V.intance.openModule(p.CreateRoomDialog,[this.arenaLv]);break;case this.btn5:V.intance.openModule(p.MailDialog);break;case this.btn_friend:V.intance.openModule(p.FriendMemberDialog);break;case this.btn_rank:ot.intance.setCurrentScene(J.M_SCENE_RANK);break;case this.btn_wallet:V.intance.openModule(p.WalletDialog);break;case this.btn_limitRecruit:ot.intance.setCurrentScene(J.M_SCENE_HERO,!0,!0,dt.FUN_LIMITRECRUIT);break;default:at.instance.notice(f.instance.getLanguage(12));break}})}openBuyDialog(e){switch(parseInt(e)){case 1:this.clickPlutPower();break;case 2:this.clickFlyBtn();break;case 3:this.buyGoldBtn();break;case 4:this.clickRecharge();break}}clickPlutPower(){}buyTiCallBack(e){B.instance.showLoading(),this.sendData(89,[7])}clickRecharge(){if(X.m_bInstantGame==!0){let e=f.instance.getLanguage(500004);me.instance().AlertByType(it.BASEALERTVIEW,e,it.YES);return}d.intance.event(b.EVENT_OPEN_MODULE,[p.RechargeDialog])}changeName(e){}buyGoldBtn(){d.intance.event(b.EVENT_OPEN_MODULE,[p.GetMoreDialog])}clickFlyBtn(){}onDisable(){for(var e=1;e<6;e++)this["spine_"+e].off(Laya.Event.READY,this,this.onSkReady);d.intance.off(b.UPDATE_RED_STATE_EVENT,this,this.changeMailFlag),d.intance.off(b.ACCOUNTVO_UPDATE,this,this.updateExp),d.intance.off(b.ROLE_INFO_CHANGE,this,this.updateTopInfo),d.intance.off(b.UPDATE_ASSETS,this,this.updateAssets),d.intance.off(ae.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets),d.intance.off("CHANG_NAME",this,this.changeName),d.intance.off("open_buy",this,this.openBuyDialog),d.intance.off("msg_173",this,this.onFirstRecharge),d.intance.off(b.EVENT_REMOVE_ACTIVITY,this,this.onBindStateChange),d.intance.off(b.EVENT_CHECK_ICON_SELECT,this,this.onCoinSelected),d.intance.off(b.EVENT_ENTER_MATCH_ROOM,this,this.onEnterMatchRoom),Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}onEnterMatchRoom(){this.onDisable()}};ns=u([Gu("pxhiJrX5SkKKvyFr8uIlNA")],ns);var rs=class extends Laya.Box{};var{regClass:Fu}=Laya,ss=class extends rs{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.playerDto=e,this.playerDto&&(this.addEvent(),this.setCurrentOutPut())}set headSkin(e){this.img_head.skin=R.instance.getPlayerIcon(e)}setCurrentOutPut(){return _(this,null,function*(){if(!this.playerDto)return;let e=this.playerDto.icon;this.img_head.skin=R.instance.getPlayerIcon(e)})}toDetail(){!this.playerDto||!this.playerDto.needTip||V.intance.openModule(p.RoleInfoDialog)}};ss=u([Fu("OPT5t2CoSmuYp2zUJWwUWA")],ss);var os=class extends Laya.Box{};var{regClass:Ku}=Laya,ls=class extends os{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.btn_join.on(Laya.Event.CLICK,this,this.onJoin),this.isAddEvent=!0)}onJoin(){return _(this,null,function*(){if(this.roomDto.requirePass)V.intance.openModule(p.InputPwdDialog,[this.roomDto]);else{let e=yield tt.requestPost("wxgame/room/join",{roomId:this.roomDto.roomId});W.instance.roomDto=e.roomDto,e.roomDto?V.intance.openModule(p.EnterRoomView):at.instance.notice(f.instance.getLanguage(135))}})}set dataSource(e){super.dataSource=e,this.roomDto=e,this.roomDto&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){let e=this.roomDto.leader.icon;this.playerIcon.headSkin=e,this.tf_name.text=this.roomDto.leader.name,this.tf_people.text='<font color="#25ff63">'+this.roomDto.memberCount+"</font>/"+this.roomDto.maxCount,this.tf_seconds.text=He.format(Math.round(this.roomDto.joinCd/1e3),":",!1)})}};ls=u([Ku("YoCqj_dyTb2ZIAnhkSds6Q")],ls);var se=class s{constructor(){}static judgePosition(t,e){var i=Math.atan2(t,-e)*180/3.141593;return i<-22&&(i=i+360),i=Math.ceil((i+22)/45),i}static distancePoint(t,e,i,a){return Math.sqrt((t-i)*(t-i)+(e-a)*(e-a))}get2D_Distance(t,e){return Math.sqrt(Math.pow(Math.abs(t),2)+Math.pow(Math.abs(e),2))}static rollCharacterByDir(t,e,i,a){let n;switch(i){case 3:n=0;break;case 4:n=45;break;case 5:n=90;break;case 6:n=135;break;case 7:n=180;break;case 8:n=225;break;case 1:n=270;break;case 2:n=315;break;default:n=0;break}return s.rollCharacter(t,e,n,a)}static rollCharacter(t,e,i,a){let n=i*(Math.PI/180);var r=t+a*Math.cos(n),o=e+a*Math.sin(n),l=320;return r<l?r=l:r>3040-l&&(r=3040-l),o<l?o=l:o>2640-l&&(o=2640-l),console.log(`新的坐标：X=${r}, Y=${o}`),[r,o]}static createDirectPath(t,e,i,a=40,n=25){for(var r=[],o=i*Math.PI/180,l=1;l<a;++l){var v=t,I=e+n*l,k=-(I-e)*Math.sin(o)+t,q=(I-e)*Math.cos(o)+e;r.push(k,q)}return r}static pointsBack(t,e){if(e<=0||!t||t.length<4)return t;for(var i=0,a=-1,n=-1,r=0;r<t.length;r+=2){var o=t[r],l=t[r+1];a>0&&n>0&&(i+=this.distancePoint(a,n,o,l)),a=o,n=l}if(i<e)return null;for(var v=t.concat(),I=0,k=0;v&&v.length>=4&&I<e;){var q=v.pop(),Q=v.pop(),H=v[v.length-1],Z=v[v.length-2];if(I+=this.distancePoint(Z,H,Q,q),k=I-e,k>0){var Dt=Math.atan2(H-q,Z-Q),Gt=Dt*180/Math.PI+90;Dt=Gt*Math.PI/180;var Wt=H+k,we=-(Wt-H)*Math.sin(Dt)+Z,gi=(Wt-H)*Math.cos(Dt)+H;v.push(we,gi)}}return v}static createLinePath(t,e,i,a,n=25,r=0){var o=[],l=Math.atan2(a-e,i-t);l=(l*180/Math.PI-90)*Math.PI/180;for(var v=this.distancePoint(t,e,i,a)-r,I=0,k=0;v>I;){var q=t,Q=e+n*k,H=-(Q-e)*Math.sin(l)+t,Z=(Q-e)*Math.cos(l)+e;I=this.distancePoint(t,e,H,Z),v>I&&o.push(H,Z),k++}return r==0&&o.push(i,a),o}static rolePosTransform(t,e,i){var a=new Laya.Matrix;return a.rotate(Math.PI/180*(t.modelAngle-90)),a.translate(e.x,e.y),a.transformPoint(i)}static pointtInPolygon(t,e){for(var i=0,a=0;a<e.length;a++){var n=e[a],r=e[(a+1)%e.length];if(n.y!=r.y&&!(t.y<Math.min(n.y,r.y))&&!(t.y>=Math.max(n.y,r.y))){var o=(t.y-n.y)*(r.x-n.x)/(r.y-n.y)+n.x;o>t.x&&i++}}return i%2==1}static pointInPie(t,e,i,a,n,r){var o=Math.atan2(r.y-e,r.x-t)*180/Math.PI,l=this.distancePoint(t,e,r.x,r.y);return o>=i&&o<=a&&l<=n}static getRandInRound(t,e){return Math.floor(Math.random()*(e-t+1))+t}};var cs=class extends Laya.Box{};var{regClass:Wu}=Laya,Ht=class extends cs{init(t,e,i=28){var a,n;switch(t!=0?(n=se.getRandInRound(-30,30),e.bj?a=Ht.TYPE_Critical:a=Ht.TYPE_Normal):(n=se.getRandInRound(-30,30),a=Ht.TYPE_Miss),this.pos(n,-180),this.alpha=1,this.scale(1,1),this.tf_damage.visible=!1,this.box_crit.visible=!1,this.img_miss.visible=!1,a){case Ht.TYPE_Normal:this.tf_damage.text=t+"",this.showNormalDamageEffect();break;case Ht.TYPE_Critical:this.fontClip_damage.value=t+"",this.showCriticalDamageEffect();break;case Ht.TYPE_Miss:this.showMissEffect();break;default:break}}showNormalDamageEffect(){this.tf_damage.visible=!0,Laya.Tween.to(this,{y:this.y-50,alpha:0},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,this.onComplete))}showCriticalDamageEffect(){this.box_crit.visible=!0,this.scale(.2,.2),Laya.Tween.to(this,{scaleX:1.3,scaleY:1.3,alpha:1,y:this.y-70},500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1,alpha:0},500,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{this.onComplete()}))}))}showMissEffect(){this.img_miss.visible=!0,Laya.Tween.to(this,{y:this.y-50,alpha:0},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{this.onComplete()}))}onComplete(){this.removeSelf(),Laya.Pool.recover("damageNumber",this)}};Ht.WHITE="#FFFFFF",Ht.ORANGE="#FFA500",Ht.RED="#FF0000",Ht.GREEN="#119c09",Ht.TYPE_Normal="Normal",Ht.TYPE_Miss="Miss",Ht.TYPE_Critical="Critical",Ht=u([Wu("nHp6WKzZRIWvyhguidEfqg")],Ht);var us=class extends Laya.Box{};var{regClass:Yu}=Laya,ps=class extends us{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.roomRankPlayerDto=e,this.roomRankPlayerDto&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){this.roomRankPlayerDto.id==S.instance.playerDto.pid?this.bg.skin="res/matchRank1/img_ranking_bg_me.png":this.roomRankPlayerDto.rankNum<4?this.bg.skin="res/matchRank1/img_ranking_bg_"+this.roomRankPlayerDto.rankNum+".png":this.bg.skin="res/matchRank1/img_ranking_bg_4.png",this.roomRankPlayerDto.rankNum<4?(this.img_rankIcon1.skin="res/matchRank1/img_ranking_"+this.roomRankPlayerDto.rankNum+".png",this.img_rankIcon1.visible=!0,this.img_rankIcon2.visible=!1):(this.roomRankPlayerDto.id==S.instance.playerDto.pid?this.img_rankIcon2.skin="res/matchRank1/img_ranking_ranking_me.png":this.img_rankIcon2.skin="res/matchRank1/img_ranking_ranking_4.png",this.img_rankIcon2.visible=!0,this.img_rankIcon1.visible=!1);let e=this.roomRankPlayerDto.icon;this.playerIcon.headSkin=e,this.playerIcon.gray=this.roomRankPlayerDto.die,this.tf_name.text=this.roomRankPlayerDto.name,this.tf_rank.text=this.roomRankPlayerDto.rankNum+"",this.tf_kill.text=this.roomRankPlayerDto.kill+"",this.tf_score.text=this.roomRankPlayerDto.score+""})}};ps=u([Yu("vpTYNMB4TfGFK2gaXiPAeg")],ps);var ms=class extends Laya.Dialog{};var{regClass:ju}=Laya,hs=class extends ms{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_PANEL;this.m_iPositionType=x.CENTER;this.allItems=[]}onEnable(){this.btn_back.on(Laya.Event.CLICK,this,this.goMatchEnd)}setOpenData(e){this.mcLanList.vScrollBarSkin="",e.forEach(a=>{if(a.id==S.instance.playerDto.pid){this.myRank=a;return}}),this.mcLanList.array=e;let i=-1;this.mcLanList.selectedIndex=i,this.showListEffect(),A.instance.myPlayer.hp>0?this.successAni.visible=!0:this.successAni.visible=!1}showListEffect(){this.allItems=[];for(var e=this.mcLanList.array.length,i=0;i<e;i++){var a=this.mcLanList.getCell(i);a?(a.skewX=.5,a.alpha=0,this.allItems.push(a),Laya.timer.once(100+i*500,this,this.startShowItem,[i],!1)):console.log("showListEffect _item is null")}}startShowItem(e){var i=this.allItems[e];if(i==null){console.log("no list item now");return}i.scaleX=0,i.alpha=0,this.mcLanList.tweenTo(e,500),Laya.Tween.to(i,{scaleX:1,alpha:1},100,Laya.Ease.circOut,null,0,!1)}goMatchEnd(){V.intance.openModule(p.MatchEndView,this.myRank),this.close()}onDisable(){this.removeEvent()}removeEvent(){Laya.Tween.clearAll(this),Laya.timer.clearAll(this)}};hs=u([ju("NlnToPI4TTuxIDhRKLPChg")],hs);var ds=class extends Laya.Dialog{};var{regClass:Xu}=Laya,ys=class extends ds{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_PANEL;this.m_iPositionType=x.CENTER}onEnable(){this.btn_next.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_receive.on(Laya.Event.CLICK,this,this.onReceive)}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN)}onReceive(){this.setToMainScene(),this.currRoomRankPlayerDto.rankNum<16||at.instance.notice(f.instance.getLanguage(2e3))}setOpenData(e){this.currRoomRankPlayerDto=e,e.rankNum<4?this.img_rankIcon.skin="res/matchRank1/img_battleend_ranking_"+e.rankNum+".png":this.img_rankIcon.skin="res/matchRank1/img_battleend_ranking_4.png",this.mcLanList.vScrollBarSkin="",this.tf_rank.text=e.rankNum+"",e.rankNum<16?this.btn_receive.label=f.instance.getUILang("Redeem CP"):(this.btn_receive.label=f.instance.getUILang("Receive"),this.btn_receive.disabled=!1);var i=[],a=W.instance.reward;a.forEach(r=>{var o=new ue(r.id);o.newAddCnt=At.formatNumber(r.count,2),i.push(o)}),this.mcLanList.array=i,this.mcLanList.visible=!0;let n=-1;this.mcLanList.selectedIndex=n}onDisable(){this.removeEvent(),W.instance.clearData()}removeEvent(){}};ys=u([Xu("y-nP_lRrQVef9uttVJ0rDw")],ys);var gs=class extends Laya.Box{};var{regClass:qu}=Laya,bs=class extends gs{constructor(){super();this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){if(super.dataSource=e,this.roomPlayer=e,!this.roomPlayer){this.img_back.skin="res/matchReady/img_jjc_0.png",this.box_show.visible=!1;return}this.addEvent(),this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){if(this.img_back.skin="res/matchReady/img_jjc_1.png",this.tf_name.text=Qt.shortHeroStr(this.roomPlayer.name),this.box_show.visible=!0,this.destroyed)return;let e=this.roomPlayer.icon;this.playerIcon.headSkin=e,this.img_sign.visible=this.roomPlayer.leader>0})}toDetail(){this.heroVo.id}};bs=u([qu("PiGdVEY9T-K8CCfWLChS0w")],bs);var fs=class extends Laya.Sprite{};var{regClass:zu}=Laya,Ls=class extends fs{constructor(){super();this.isAddEvent=!1;this.isMe=!1;this.inGround=!1;this.moveSpeed=6;this._speed=6;this.biasSpeed=0;this.lastDirectStr="left";this.directStr="left";this._roleDirection=7;this.inControl=!1;this.isStop=!1;this.isLockAni=!1;this.aniChange=!1;this.displacementType=0;this.timeStamp=0;this.currArea=0;this.flashCount=0;this.lastX=-1;this.lastY=-1;this.lastRoleDirection1=-1;this.lastSpeed1=-1;this.lastArea=-1}get speed(){return this._speed}set speed(e){this._speed=e,this.biasSpeed=Math.round(this.speed*Math.sin(45*Math.PI/180)),console.log("Role speed2: ",this.speed,this.biasSpeed,this.roomPlayerDto.id)}get roleDirection(){return this._roleDirection}set roleDirection(e){this._roleDirection=e,e!=-4&&(e>=2&&e<=4?this.directStr="right":e>=6&&e<=8&&(this.directStr="left"),this.lastDirectStr!=this.directStr&&(this.heroBox.scaleX=this.directStr=="left"?1:-1,this.lastDirectStr=this.directStr))}set myRoleDirection(e){if(this.roleDirection!=e){this.roleDirection=e;for(var i=1;i<9;i++)this["img_d_"+i].visible=i==e}}addEvent(){this.isAddEvent||(Laya.timer.frameLoop(1,this,this.onFrameUpdate),this.isAddEvent=!0)}onFrameUpdate(){this._isRealDead&&!A.instance.myHeroSpr._isDead&&(this.visible=!1)}set dataSource(e){if(this.roomPlayerDto=e,!!this.roomPlayerDto){if(this.pos(this.roomPlayerDto.x,this.roomPlayerDto.y),this.addEvent(),this.speed=this.roomPlayerDto.speed,this.currArea=this.roomPlayerDto.area,console.log("MatchHeroSpr speed: "+this.speed),this.roomPlayerDto.hp<=0){this._isDead=!0,this.setDead();return}this.heroVo=new jt,this.heroVo.id=this.roomPlayerDto.heroId,this.heroVo.color=this.roomPlayerDto.heroColor,this.moveSpeed=this.heroVo.heroItem.mov/30,this.setCurrentOutPut(),this.updataBlood()}}setDead(){console.log("MatchHeroSpr setDead: "+this.isMe),this._isRealDead=!0,this.alpha=.5,this.img_deadImg.visible=!0;var e=this.img_deadImg.y;this.tf_name.visible=!1,this.box_blood.visible=!1,this.heroSk.visible=!1,this.img_deadImg.y=0,this.img_deadImg.scale(0,0),this.getComponent(Laya.RigidBody).mask=1;var i=this;Laya.Tween.to(this.img_deadImg,{y:e,scaleX:1,scaleY:1},400,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){i.isMe&&d.intance.event(b.EVENT_GameScene_Gray)}))}updataBlood(){this._healthBar.value=this.roomPlayerDto.hp/this.roomPlayerDto.maxHp}setCurrentOutPut(){this.heroSk.dataSource=this.heroVo,this.tf_name.text=Qt.shortHeroStr(this.roomPlayerDto.name)}onAwake(){}backAni(){}idle(){console.log(`${this.roomPlayerDto.id} 播放 待机 动画`),!this._isDead&&this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_daiji,!0,!1)}walk(){console.log(`${this.roomPlayerDto.id} 播放 走动 动画`),!this._isDead&&this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_xingzou,!0,!1)}run(){console.log(`${this.roomPlayerDto.id} 播放 跑动 动画`),!this._isDead&&this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_shanbi,!0,!1)}playAttackAnimation(e,i,a,n){if(!this._isDead){var r=j.intance.m_dicSkills.get(e);if(console.log(`${this.roomPlayerDto.id} 攻击 , 播放 ${e} 动画`),r.type==1){if(i&&A.instance.onSendAnimation(e,Tt.TYPE_GONGJI),this.isStop=!0,this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_gongji,!1),i){var o=A.instance.getAttackTarget(r);o&&o.roomPlayerDto.hp>0&&Laya.timer.frameOnce(1,this,this.onRealAttack,[r,o.roomPlayerDto.id])}Laya.timer.frameOnce(20,this,()=>{this.isStop=!1,n(),this.aniChange=!0}),A.instance.playSound(1)}else if(r.type==2)i&&A.instance.onSendAnimation(e,Tt.TYPE_TI),this.isStop=!0,this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_ti,!1),i&&Laya.timer.frameOnce(17,this,this.onRealAttack,[r]),Laya.timer.frameOnce(30,this,()=>{this.isStop=!1,n(),this.aniChange=!0}),A.instance.playSound(2);else if(r.type==5){var l=[];if(this.displacementType=r.displacementType,i){var v=r.displacement>0?r.displacement:50;l=se.rollCharacterByDir(this.x,this.y,this.roleDirection,v),A.instance.onSendAnimation(e,Tt.TYPE_FEI,-1,l[0],l[1])}else l[0]=a.get("newX"),l[1]=a.get("newY");if(this.isStop=!0,this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_ti,!1),this.heroVo.heroItem.race!=4){var I=A.instance.huaEffect;this.huaSpineSk||(this.huaSpineSk=new Laya.SpineSkeleton,this.spineNodeFront.addChild(this.huaSpineSk)),this.huaSpineSk.templet=null,this.huaSpineSk.animationName="animation",this.huaSpineSk.templet=I,this.huaSpineSk.visible=!0,this.huaSpineSk.scaleX=this.directStr=="left"?1:-1,Laya.timer.frameOnce(15,this,()=>{this.onHuaComplate()})}i&&Laya.timer.frameOnce(17,this,this.onRealAttack,[r]),Laya.timer.frameOnce(5,this,this.onRoll,[l]),Laya.timer.frameOnce(20,this,()=>{this.isStop=!1,this.displacementType=0,n(),this.aniChange=!0}),A.instance.playSound(3)}else if(r.type==3){var l=[];if(i){var v=r.displacement>0?r.displacement:350;l=se.rollCharacterByDir(this.x,this.y,this.roleDirection,v),A.instance.onSendAnimation(e,Tt.TYPE_HUA,-1,l[0],l[1])}else l[0]=a.get("newX"),l[1]=a.get("newY");if(this.getComponent(Laya.BoxCollider).isSensor=!0,this.isStop=!0,this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_hua,!1),this.heroVo.heroItem.race!=4){var I=A.instance.huaEffect;this.huaSpineSk||(this.huaSpineSk=new Laya.SpineSkeleton,this.spineNodeFront.addChild(this.huaSpineSk)),this.huaSpineSk.templet=null,this.huaSpineSk.animationName="animation",this.huaSpineSk.templet=I,this.huaSpineSk.visible=!0,this.huaSpineSk.scaleX=this.directStr=="left"?1:-1,Laya.timer.frameOnce(15,this,()=>{this.onHuaComplate()})}Laya.timer.frameOnce(5,this,this.onRoll,[l]),Laya.timer.frameOnce(20,this,()=>{this.getComponent(Laya.BoxCollider).isSensor=!1,this.isStop=!1,n(),this.aniChange=!0}),A.instance.playSound(3)}else if(r.type==4){i&&(this.isLockAni=!0,A.instance.onSendAnimation(e,Tt.TYPE_DANG)),this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_dang,!1),this.dunpaiSk||(this.dunpaiSk=A.instance.dunpaiTemplet.buildArmature(0),this.dunpaiSk.x=-45,this.skNode.addChild(this.dunpaiSk)),this.dunpaiSk.play(0,!0);var k=2e3,q=r.buff;if(q.length>2){var Q=q[2],H=j.intance.m_dicBuffs.get(Q);k=parseInt(H.time+"")}Laya.timer.once(k,this,()=>{this.isLockAni=!1,this.dunpaiSk&&(this.dunpaiSk.stop(),this.dunpaiSk.visible=!1),n(),this.aniChange=!0}),A.instance.playSound(2)}}}onRoll(e){this.inGround||Laya.Tween.to(this,{x:e[0],y:e[1]},330)}onHuaComplate(){this.huaSpineSk.stop(),this.huaSpineSk.visible=!1}onRealAttack(e,i=-1){if(console.log("onRealAttack",i),i>0)A.instance.onSendAttack(i,1,e.id);else{var a=A.instance.getAttackTarget(e);a&&a.roomPlayerDto.hp>0&&A.instance.onSendAttack(a.roomPlayerDto.id,1,e.id)}}playBeijiAnimation(e){this._isDead||(console.log(`${this.roomPlayerDto.id} 播放 被击 动画`),this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_beiji,!1),Laya.timer.once(1e3,this,()=>{e()}))}playChuShengAnimation(e){this._isDead||(console.log(`${this.roomPlayerDto.id} 播放 出生 动画`),this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_ruchang,!1),Laya.timer.once(1e3,this,()=>{e()}))}attack(e=0,i=!0,a=null){if(console.log(`${this.roomPlayerDto.id} 攻击 s`),this._isAttacking||this._isDead){console.log(`${this.roomPlayerDto.id} 没有靠近目标或正在攻击中或技能冷却中或已死亡，无法攻击`);return}this._isAttacking=!0,this.playAttackAnimation(e,i,a,()=>{this._isAttacking=!1})}takeDamage(e,i){var a=e.skill,n=e.attackValue,r=e.defHp;console.log(`${this.roomPlayerDto.id} 受到 ${n} 伤害s`),!this._isDead&&(this.roomPlayerDto.hp=r,console.log(`${this.roomPlayerDto.id} 受到 ${n} 伤害`),this.updateHealthBar(i),this.showDamageLabel(a,n,e),this._isAttacking&&(console.log(`${this.roomPlayerDto.id} 正在攻击中，受到攻击中断攻击 暂时没有中断攻击`),Laya.timer.clear(this,this.onRealAttack),this._isAttacking=!1),this._isTakingDamage=!0,this.isLockAni=!0,this.beijiSk||(this.beijiSk=A.instance.beijiTemplet.buildArmature(0),this.skNode.addChild(this.beijiSk)),this.beijiSk.play(0,!1),this.playBeijiAnimation(()=>{this.beijiSk&&(this.beijiSk.stop(),this.beijiSk.visible=!1),this._isTakingDamage=!1,this.isLockAni=!1,this.backAni()}))}die(e){if(console.log(`${this.roomPlayerDto.id} 死亡s`),!this._isDead){console.log(`${this.roomPlayerDto.id} 死亡`);var i=se.judgePosition(e.x-this.x,e.y-this.y);this.roleDirection=i,this._isDead=!0,this.heroSk.isReady&&this.heroSk.sk.play(Tt.ANI_siwang,!1),Laya.timer.once(2e3,this,this.setDead)}}applySkillEffect(e){console.log(`${this.roomPlayerDto.id} 受到技能效果: ${e}`)}updateHealthBar(e){this.roomPlayerDto.hp<=0&&(this.roomPlayerDto.hp=0,this.die(e)),this._healthBar.value=this.roomPlayerDto.hp/this.roomPlayerDto.maxHp}showDamageLabel(e,i,a){if(i.length>1)for(var n=j.intance.m_dicSkills.get(e),r=n.section,o=r,l=0;l<i.length;l++){var v=i[l];this.showDamageLabelDetailDelay(v,o[l][1],a)}else i.length==1?this.showDamageLabelDetailDelay(i[0],100,a):this.showDamageLabelDetailDelay(0,100,a);var I=this;if(a.allAtkValue!=0){var k=200;this.originalBlendMode=this.img_hp_bg.blendMode,this.flashCount=0,Laya.timer.loop(k,this,this.flashBlood)}}flashBlood(){var e=2;this.flashCount<e?this.img_hp_bg.blendMode===this.originalBlendMode?this.img_hp_bg.blendMode="lighter":(this.img_hp_bg.blendMode=this.originalBlendMode,this.flashCount++):(this.img_hp_bg.blendMode=this.originalBlendMode,Laya.timer.clear(this,this.flashBlood))}showDamageLabelDetailDelay(e,i,a){Laya.timer.once(i,this,this.showDamageLabelDetail,[e,a],!1)}showDamageLabelDetail(e,i){var a=Laya.Pool.getItemByCreateFun("damageNumber",A.instance.damageNumPrefab.create,A.instance.damageNumPrefab);a.init(e,i),this.addChild(a)}onSendMoveData(){if(!this._isDead){var e=this.speed,i=this.roleDirection,a=this.x,n=this.y;if(Math.abs(a-this.lastX)>2||Math.abs(n-this.lastY)>2||this.lastRoleDirection1!=i||this.lastSpeed1!=e||this.lastArea!=this.currArea){this.pos(a,n),this.lastX=a,this.lastY=n,this.lastRoleDirection1=i,this.lastSpeed1=e,this.lastArea=this.currArea;var r=S.instance.m_serverTime;this.timeStamp=r,A.instance.onSendMove(r,this.roomPlayerDto.id,e,i,a,n,this.currArea)}}}beiTui(e){var i=this.roomPlayerDto.id,a=this.x,n=this.y;if(Math.abs(a-this.lastX)>2||Math.abs(n-this.lastY)>2){this.lastX=a,this.lastY=n;var r=S.instance.m_serverTime;this.timeStamp=r,A.instance.onSendTargetMove(r,e,i,a,n)}}onPushMoveData(e,i,a,n,r,o){if(this.roleDirection=a,this.speed!=i&&(this.speed=i,i==0?this.idle():this.walk()),this.currArea!=o&&(this.currArea=o),e<=this.timeStamp){console.log("位置数据忽略："+e+" < "+this.timeStamp);return}(Math.abs(n-this.lastX)>1||Math.abs(r-this.lastY)>1)&&(this.pos(n,r),this.lastX=n,this.lastY=r)}onPushTargetMoveData(e,i,a){if(e<=this.timeStamp){console.log("推人数据忽略："+e+" < "+this.timeStamp);return}(Math.abs(i-this.lastX)>2||Math.abs(a-this.lastY)>2)&&(this.pos(i,a),this.lastX=i,this.lastY=a)}sendToServer(e){}initBirth(e){e?this.createBirthSpine():this.onPlayBirthEnd()}createBirthSpine(){this.heroSk.visible=!1,this.tf_name.visible=!1,this.box_blood.visible=!1,this.chushengBackSpineSk||(this.chushengBackSpineSk=new Laya.SpineSkeleton,this.spineNodeBack.addChild(this.chushengBackSpineSk)),this.chushengFrontSpineSk||(this.chushengFrontSpineSk=new Laya.SpineSkeleton,this.spineNodeFront.addChild(this.chushengFrontSpineSk)),this.chushengBackSpineSk.on(Laya.Event.READY,this,this.onBirthReady);var e=A.instance.ruchangEffects[this.getRandomAnimationType()];this.destroyed||(this.chushengBackSpineSk.animationName="animation2",this.chushengBackSpineSk.templet=e,this.chushengFrontSpineSk.animationName="animation1",this.chushengFrontSpineSk.templet=e)}getRandomAnimationType(){return Math.floor(Math.random()*3)}onBirthReady(){Laya.timer.once(500,this,this.onPlayBirth1)}onPlayBirth1(){this.isLockAni=!0,this.heroSk.visible=!0,this.playChuShengAnimation(()=>{this.isLockAni=!1,this.aniChange=!0}),this.chushengBackSpineSk.visible=!0,this.chushengBackSpineSk.play("animation2",!1),this.chushengFrontSpineSk.visible=!0,this.chushengFrontSpineSk.play("animation1",!1),Laya.timer.once(1300,this,this.onPlayBirthEnd)}onPlayBirthEnd(){this.chushengBackSpineSk&&(this.chushengBackSpineSk.off(Laya.Event.READY,this,this.onPlayBirth1),this.chushengBackSpineSk.destroy(),this.chushengBackSpineSk.removeSelf()),this.chushengFrontSpineSk&&(this.chushengFrontSpineSk.destroy(),this.chushengFrontSpineSk.removeSelf()),this.img_d.visible=!0,this.tf_name.visible=!0,this.box_blood.visible=!0}onDisable(){this.chushengBackSpineSk&&this.chushengBackSpineSk.off(Laya.Event.READY,this,this.onPlayBirth1),Laya.timer.clearAll(this),Laya.Tween.clearAll(this)}};Ls=u([zu("JIaWsVNzTK2dJIUcev60tQ")],Ls);var vs=class extends Laya.Box{};var{regClass:Qu}=Laya,ws=class extends vs{init(){var t=W.instance.currArenaItem.coinType;this.img_bing.skin="gameIcon/map/1001/img_bing_"+t+".png"}set dataSource(t){super.dataSource=t}};ws=u([Qu("W3qDvbUmSa2SFKJ5iEmjsg")],ws);var Is=class extends Laya.Box{};var{regClass:Ju}=Laya,Ss=class extends Is{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){this.roomPlayerDto=e,this.roomPlayerDto&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){this.tf_rank.text=this.roomPlayerDto.rankNum+"";let e=this.roomPlayerDto.icon;this.playerIcon.headSkin=e,this.tf_name.text=f.instance.getLanguage(this.roomPlayerDto.name),this.tf_kill.text=this.roomPlayerDto.kill+"",this.roomPlayerDto.id==A.instance.myPlayer.id?(this.img_bg.skin="res/match1/img_ph2.png",this.tf_rank.color="#000000",this.tf_name.color="#ffe64b",this.img_kill.filters=[_t.YELLOW],this.tf_kill.color="#ffe64b",this.box_item.x=6):(this.img_bg.skin="res/match1/img_ph.png",this.tf_rank.color="#ffffff",this.tf_name.color="#ffffff",this.img_kill.filters=null,this.tf_kill.color="#ffffff",this.box_item.x=15)}};Ss=u([Ju("XTVFXeI_R768e0Elv_ePAA")],Ss);var Es=class extends Laya.Scene{};var{regClass:Zu}=Laya,Ts=class extends Es{constructor(){super(...arguments);this.type=1}onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP}onOpened(e){this.type=e}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN)}onEnable(){console.log("MatchReadyRT onEnable"),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.btn_random.on(Laya.Event.CLICK,this,()=>{this.generateName()}),this.btn_enter.on(Laya.Event.CLICK,this,()=>{var e=this.input_username.text;if(console.log("phyBtn"),e==""){alert("用户名不能为空");return}It.instance.openId=e,It.instance.initSocket()})}generateRandomName(e){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a="";for(let n=0;n<e;n++){let r=Math.floor(Math.random()*i.length);a+=i.charAt(r)}return a}generateName(){this.input_username.text=this.generateRandomName(8)}onDestroy(){}};Ts=u([Zu("mOlMVGD3TRCKNoddhyUGLw")],Ts);var Ds=class extends Laya.Dialog{};var{regClass:$u}=Laya,Cs=class extends Ds{constructor(){super(...arguments);this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_PANEL;this.m_iPositionType=x.CENTER}onEnable(){}onOpened(e){this.updateBattleCD()}updateBattleCD(){var e=W.instance.matchDto.startTime-W.instance.matchDto.nowTime;W.instance.startCoolDownTime=Math.round(e/1e3),W.instance.startCoolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):Laya.timer.clear(this,this.onSetCoolTime)}onSetCoolTime(){W.instance.startCoolDownTime>=0?(this.fontClip_reduceTime.value=W.instance.startCoolDownTime+"",this.scaleEffect(),W.instance.startCoolDownTime--):(Laya.timer.clear(this,this.onSetCoolTime),this.onMatchStartEnd())}scaleEffect(){var e=this;Laya.Tween.to(this.fontClip_reduceTime,{scaleX:1.3,scaleY:1.3},200,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){Laya.Tween.to(e.fontClip_reduceTime,{scaleX:1,scaleY:1},200,Laya.Ease.linearInOut)}))}onMatchStartEnd(){Laya.timer.once(1e4,this,this.close)}onDisable(){this.removeEvent(),W.instance.stopAll=!1}removeEvent(){Laya.timer.clearAll(this),Laya.Tween.clearAll(this)}};Cs=u([$u("xpPoFvX_SqiYMO5AaOwGyA")],Cs);var Ms=class extends Laya.Box{};var{regClass:tp}=Laya,xs=class extends Ms{constructor(){super();this.showAdd=!1;this.isAddEvent=!1}createChildren(){super.createChildren()}addEvent(){this.isAddEvent||(this.on(Laya.Event.CLICK,this,this.toDetail),this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.itemVo=e,this.itemVo&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){this.itemVo&&(this.knapsackItem.showAdd=!0,this.knapsackItem.dataSource=this.itemVo)})}toDetail(){!this.itemVo||!this.itemVo.needTip||(this.itemVo.type===Ut.TYPE_Equipment?V.intance.openModule(p.EquipDetailDialog,this.itemVo):V.intance.openModule(p.KnapsackTipDialog,this.itemVo))}};xs=u([tp("WXpxCvqlQ2mKdcJCYlqOeg")],xs);var As=class extends Laya.Scene{};var{regClass:ep}=Laya,Rs=class extends As{constructor(){super(...arguments);this.liveNum=0}onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP,A.instance.init()}onOpened(e){var i=W.instance.matchDto.startTime-W.instance.matchDto.nowTime;i>0&&V.intance.openModule(p.MatchReadyView);var a=W.instance.matchDto.arenaId,n=j.intance.m_dicArenaDic.get(a);W.instance.currArenaItem=n;var r=W.instance.currArenaItem.mapid,o=Laya.loader.getRes("gameIcon/map/map_"+r+".lh"),l=Laya.Pool.getItemByCreateFun("MatchMap1001",o.create,o);l.init(),A.instance.gameMap=l,A.instance.box_players=l.box_players,this.matchBox.removeChildren(),this.matchBox.addChild(l);var v=S.instance.playerDto;this.tf_roleName.text=v.name;let I=v.icon;this.playerIcon.headSkin=I,A.instance.initMatch(this,this.onInitEnd)}onInitEnd(e){e.updateSkill(),e.updateKill(),e.updateBattleCD(),Laya.timer.frameLoop(10,e,e.updateCharactersOrder)}onRestoreData(){A.instance.updateMatch(this,this.onInitEnd)}updateSkill(){for(var e=A.instance.myPlayer,i=j.intance.m_dicHeros.get(e.heroId),a=i.skillIds.length,n=0;n<a;n++){var r=i.skillIds[n],o=j.intance.m_dicSkills.get(r),l=this["matchSkill"+(n+1)];l.keyNum=n+1,l.dataSource=o;var v=e.skillCd.get(r);v&&l.updateSkillCooldown(v),l.updateGlobalCooldown(e.commonCd),l.visible=!0}}updateKill(){A.instance.myPlayer&&(this.tf_kill.text=A.instance.myPlayer.kill+""),this.list_rank.array=this.getSortPlayer(A.instance.matchHeroDic.values),this.tf_remainer.text=this.liveNum+"",this.tf_total.text="/ "+A.instance.matchHeroDic.values.length}getSortPlayer(e){var i=e.slice(),a=i.sort((r,o)=>o.score-r.score);this.liveNum=0;var n=1;return a.forEach(r=>{r.rankNum=n,n++,r.hp>0&&this.liveNum++}),a}updateBattleCD(){W.instance.matchCoolDownTime=Math.round(W.instance.matchDto.remainderCd/1e3),W.instance.matchCoolDownTime>0?(this.onSetCoolTime(),Laya.timer.loop(1e3,this,this.onSetCoolTime)):Laya.timer.clear(this,this.onSetCoolTime)}onSetCoolTime(){W.instance.matchCoolDownTime>=0?(this.fontClip_reduceTime.value=He.format(W.instance.matchCoolDownTime,":",!1),W.instance.matchCoolDownTime>90?this.fontClip_reduceTime.skin="res/match1/fontClip_1.png":W.instance.matchCoolDownTime>10?this.fontClip_reduceTime.skin="res/match1/fontClip_2.png":(this.fontClip_reduceTime.skin="res/match1/fontClip_3.png",this.scaleEffect()),W.instance.stopAll||W.instance.matchCoolDownTime--):Laya.timer.clear(this,this.onSetCoolTime)}scaleEffect(){var e=this;Laya.Tween.to(this.fontClip_reduceTime,{scaleX:1.3,scaleY:1.3},200,Laya.Ease.linearInOut,Laya.Handler.create(this,function(){Laya.Tween.to(e.fontClip_reduceTime,{scaleX:1,scaleY:1},200,Laya.Ease.linearInOut)}))}updateCharactersOrder(){A.instance.matchHeroSprs.sort((e,i)=>e.y-i.y);for(let e=0;e<A.instance.matchHeroSprs.length;e++)A.instance.matchHeroSprs[e].zOrder=e}onFirstBloodPush(e){var i=e.pid,a=A.instance.matchHeroDic.get(i);let n=a.icon;this.img_firstBlood_head.skin=R.instance.getPlayerIcon(n),this.img_firstBlood.visible=!0,this.img_firstBlood.alpha=0,this.img_firstBlood.y=-200,Laya.Tween.to(this.img_firstBlood,{y:92,alpha:1},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onFirstBlood1))}onFirstBlood1(){this.zi_firstBlood.scale(1,1),Laya.Tween.to(this.zi_firstBlood,{scaleX:1.5,scaleY:1.5},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onFirstBlood2))}onFirstBlood2(){Laya.Tween.to(this.zi_firstBlood,{scaleX:1,scaleY:1},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onFirstBlood3))}onFirstBlood3(){Laya.Tween.to(this.img_firstBlood,{y:-200,alpha:0},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onFirstBlood4),1500)}onFirstBlood4(){this.img_firstBlood.visible=!1}onMutiKillPush(e){this.fontClip_kill.value=e.kill+"";var i=!1;e.kill>=3?(i=!0,this.img_mutiKill.skin="res/match1/img_kill_3s.png"):this.img_mutiKill.skin="res/match1/img_kill_2s.png";var a=e.pid,n=A.instance.matchHeroDic.get(a);let r=n.icon;this.img_mutiKill_head.skin=R.instance.getPlayerIcon(r),this.img_mutiKill.visible=!0,this.img_mutiKill.alpha=0,this.img_mutiKill.y=-200,Laya.Tween.to(this.img_mutiKill,{y:175,alpha:1},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onMutiKill1,[i]))}onMutiKill1(e){this.zi_mutiKill.scale(1,1),e?Laya.Tween.to(this.zi_mutiKill,{scaleX:1.5,scaleY:1.5},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onMutiKill2)):this.onMutiKill3(2e3)}onMutiKill2(){Laya.Tween.to(this.zi_mutiKill,{scaleX:1,scaleY:1},200,Laya.Ease.linearNone,Laya.Handler.create(this,this.onMutiKill3,[1500]))}onMutiKill3(e){Laya.Tween.to(this.img_mutiKill,{y:-200,alpha:0},200,Laya.Ease.linearInOut,Laya.Handler.create(this,this.onMutiKill4),e)}onMutiKill4(){this.img_mutiKill.visible=!1}onGameSceneGray(){this.matchBox.gray=!0}onEnable(){console.log("MatchScene onEnable"),d.intance.on(b.UPDATE_KILL_NUM,this,this.updateKill),d.intance.on(b.EVENT_RESTORE_DATA,this,this.onRestoreData),d.intance.on(b.EVENT_FirstBlood,this,this.onFirstBloodPush),d.intance.on(b.EVENT_MutiKill,this,this.onMutiKillPush),d.intance.on(b.EVENT_GameScene_Gray,this,this.onGameSceneGray),Laya.stage.on(Laya.Event.FOCUS,this,this.onWindowFocus)}onWindowFocus(){A.instance.sendRestoreData()}onDisable(){d.intance.off(b.UPDATE_KILL_NUM,this,this.updateKill),d.intance.off(b.EVENT_RESTORE_DATA,this,this.onRestoreData),d.intance.off(b.EVENT_FirstBlood,this,this.onFirstBloodPush),d.intance.off(b.EVENT_MutiKill,this,this.onMutiKillPush),d.intance.off(b.EVENT_GameScene_Gray,this,this.onGameSceneGray),Laya.stage.off(Laya.Event.FOCUS,this,this.onWindowFocus),Laya.timer.clearAll(this)}};Rs=u([ep("sX0uLhOQSmm8b-_sHNqe5w")],Rs);var{regClass:ip,property:lx}=Laya,da=class extends Laya.Script{constructor(){super()}onAwake(){}onStart(){A.instance.playMusic()}onLateUpdate(){A.instance.moveGameWindow()}};da=u([ip("Ply19emtSrqrBk7nHXToAQ")],da);var ks=class extends Laya.Button{};var{regClass:ap}=Laya,Os=class extends ks{constructor(){super();this.isAddEvent=!1;this.isCanClick=!0;this.skillCooldown=5e3;this.thisGlobalCooldown=1e4;this.globalCooldown=1e4;this.remainingSkillCooldown=0;this.remainingGlobalCooldown=0}onEnable(){this.addEvent()}addEvent(){this.isAddEvent||(d.intance.on(b.EVENT_CLICK_NUM,this,this.onNumberClick),d.intance.on(b.EVENT_UPDATE_GLOBAL_COOL,this,this.updateGlobalCooldown),this.isAddEvent=!0,this.on(Laya.Event.CLICK,this,this.onSkillButtonClick),this.on(Laya.Event.MOUSE_UP,this,this.onSkillButtonUp))}onNumberClick(e){e==this.keyNum&&this.onSkillButtonClick(null)}set dataSource(e){super.dataSource=e,this.skillItem=e,this.skillItem&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){this.skillItem&&(this.skillIconItem.isBig=this.skillItem.icon=="1001",this.skillIconItem.dataSource=this.skillItem,this.skillCooldown=this.skillItem.cd,this.thisGlobalCooldown=this.skillItem.commCd,Laya.timer.frameLoop(1,this,this.updateCooldown))})}onMouseClick(e){if(this.isCanClick){this.isCanClick&&(this.isCanClick=!1);var i=0;A.instance.playSound(1),Laya.timer.once(1e3,this,()=>{this.isCanClick=!0})}}onSkillButtonUp(e){e&&e.stopPropagation(),Be.clearClickFilter(this)}onSkillButtonClick(e){e&&e.stopPropagation(),this.remainingSkillCooldown<=0&&this.remainingGlobalCooldown<=0?(console.log("技能释放！"),Laya.Tween.to(this,{scaleX:.8,scaleY:.8},100,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1},100,Laya.Ease.linearNone)})),A.instance.myHeroSpr.attack(this.skillItem.id),this.updateSkillCooldown(this.skillCooldown),d.intance.event(b.EVENT_UPDATE_GLOBAL_COOL,[this.thisGlobalCooldown])):console.log("技能或全局冷却还在进行中，无法释放。")}updateSkillCooldown(e){this.remainingSkillCooldown=e}updateGlobalCooldown(e){this.globalCooldown=e,this.remainingGlobalCooldown=e}updateCooldown(){if(this.remainingSkillCooldown>0){this.remainingSkillCooldown-=Laya.timer.delta;let e=this.remainingSkillCooldown/1e3;this.txt_time.text=e.toFixed(1),this.updateCooldownMask(this.skillCooldownMask,this.remainingSkillCooldown/this.skillCooldown,"#000000"),this.img_djs.visible=!0,this.txt_time.visible=!0}else this.img_djs.visible=!1,this.txt_time.visible=!1;this.remainingGlobalCooldown>0?(this.remainingGlobalCooldown-=Laya.timer.delta,this.updateCooldownMask(this.globalCooldownMask,this.remainingGlobalCooldown/this.globalCooldown,"#00000036"),this.globalCooldownMask.visible=!0):this.globalCooldownMask.visible=!1,this.skillIconItem.gray=this.remainingSkillCooldown>0||this.remainingGlobalCooldown>0}updateCooldownMask(e,i,a){let n=this.width/2,r=this.width/2,o=this.height/2;e.graphics.clear(),e.graphics.drawPie(r,o,n,-90+360*(1-i),270,a)}onDisable(){d.intance.off(b.EVENT_UPDATE_GLOBAL_COOL,this,this.updateGlobalCooldown),d.intance.offAllCaller(this),Laya.timer.clearAll(this)}};Os=u([ap("x6t-z1VuR52yXWju0qxGBg")],Os);var Ps=class extends Laya.Box{};var{regClass:np}=Laya,Ns=class extends Ps{onEnable(){}notice(t){let e=t;this.label_tf.text=e,this.label_tf.x=68,this.image_bg.width=68*2+this.label_tf.textField.textWidth,e.length/45>1&&(this.image_bg.height=this.label_tf.textField.textHeight+25)}get view(){return this}get width(){return this.image_bg.width}};Ns=u([np("Nm27xWbYSG6mj-EXqPOZ_A")],Ns);var Bs=class extends Laya.Box{};var{regClass:rp}=Laya,Hs=class extends Bs{onEnable(){this.updateLocalAssets(),d.intance.on(b.ROLE_INFO_CHANGE,this,this.updateLocalAssets),d.intance.on(ae.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets)}onDisable(){d.intance.off(b.ROLE_INFO_CHANGE,this,this.updateLocalAssets),d.intance.off(ae.UPDATE_LOCAL_WALLET_LIST_EVENT,this,this.updateLocalAssets)}updateLocalAssets(){this.tf_3001.text=At.filterNumFormat(S.instance.getConsumeValue(Et.TYPE_TOX),2),this.tf_3006.text=At.filterNumFormat(S.instance.getConsumeValue(Et.TYPE_BTC),8),this.tf_3007.text=At.filterNumFormat(S.instance.getConsumeValue(Et.TYPE_ETH),4),this.tf_3004.text=At.filterNumFormat(S.instance.getConsumeValue(Et.TYPE_USDT),2),this.tf_3005.text=At.filterNumFormat(S.instance.getConsumeValue(Et.TYPE_GOLD),0)}};Hs=u([rp("7P9MlqipSaG6QoKpQowDbQ")],Hs);var Us=class extends Laya.Box{};var{regClass:sp}=Laya,Vs=class extends Us{constructor(){super();this.isAddEvent=!1}addEvent(){this.isAddEvent||(this.isAddEvent=!0)}set dataSource(e){super.dataSource=e,this.heroVo=e,this.heroVo&&(this.addEvent(),this.setCurrentOutPut())}setCurrentOutPut(){return _(this,null,function*(){this.heroSk.dataSource=this.heroVo,this.tf_name.text=Qt.shortHeroStr(this.heroVo.name);let e=this.heroVo.heroItem.level+"";zt.instance.setStar(this,e)})}};Vs=u([sp("IcuwbMwvRKqMyiXxDzW-dA")],Vs);var Gs=class extends Laya.Dialog{};var{regClass:op}=Laya,Fs=class extends Gs{constructor(e){super();this.m_strName="我是OpenSceneRuntime";this.m_iLayerType=x.M_POP;this.m_iPositionType=x.CENTER}onEnable(){this.initContainer(),bt.instance.playSoundByName(bt.soundName32)}initContainer(){var e=ft.instance.getOneItem();e&&this.showItem(e)}showItem(e){let i=this.heroListItem;i.dataSource=e}onDisable(){d.intance.event(b.EVENT_CHECK_REMAIN,p.HeroGetDialog)}};Fs=u([op("mrqJhWahTxuTjeSGIs559Q")],Fs);var xt=class xt{constructor(){}static pointEquil(t,e){return t&&e&&t.x==e.x&&t.y==e.y}static isEmpty(t){for(let e in t)return!1;return!0}static showTxtEffect(t,e){let i=parseInt(t.text),a=Math.floor((e-i)/5),n=0;Laya.timer.loop(60,null,r);let r=function(){n++,i+=a,n>=5&&(i=e,Laya.timer.clear(null,r)),t.text=i+""}}static showTxtFlash(t){let e=t.color;t.color=xt.COLORS[0],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,i),50);let i=function(){t.color=xt.COLORS[1],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,a),50)},a=function(){t.color=xt.COLORS[0],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,n),50)},n=function(){t.color=xt.COLORS[1],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,r),50)},r=function(){t.color=xt.COLORS[0],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,o),50)},o=function(){t.color=xt.COLORS[1],Laya.Tween.to(t,{},10,null,Laya.Handler.create(null,l),50)},l=function(){t.color=e}}static getProKey(t){return xt.PRO_DIC[t]?xt.PRO_DIC[t]:t}static getIconName(t){return xt.proList[t]}static clonePoint(t){return new Laya.Point(t.x,t.y)}static copyObj(t){let e={};for(let i in t)e[i]=t[i];return e}static mergeObj(t,e){for(let i in e)t[i]?t[i]=parseFloat(t[i])+parseFloat(e[i]):t[i]=e[i];return t}static checkHit(t){return t.visible&&t.mouseX>0&&t.mouseY>0&&t.mouseX<=t.width&&t.mouseY<=t.height}static separateObj(t,e){if(e)for(let i in e)t[i]&&(t[i]=parseFloat(t[i])-parseFloat(e[i]));return t}static toFixed(t,e=1){if((t+"").indexOf(".")!=-1){let i=parseFloat(t).toFixed(e);return e==1&&i.charAt(i.length-1)=="0"&&(i=parseInt(i)+""),i}return t+""}static formatResWith(t){return t>=1e12?Math.floor(t/1e12)+xt.RES_W[3]:t>=1e9?Math.floor(t/1e9)+xt.RES_W[2]:t>=1e6?Math.floor(t/1e6)+xt.RES_W[1]:t>=1e4?Math.floor(t/1e3)+xt.RES_W[0]:t+""}static formatNumWithSign(t,e=","){t=Math.floor(t);let i=t+"",a=1,n=[];for(let r=i.length-1;r>=0;r--)n.push(i.charAt(r)),a>0&&a%3==0&&n.push(e),a++;return n.reverse(),n[0]==e&&n.shift(),n.join("")}static autoRecyle(t,e=!1){t.on(Laya.Event.COMPLETE,null,i,[t]),t.isPlaying||t.play(1,!1);let i=function(a){a.off(Laya.Event.COMPLETE,null,i),a.stop(),a.removeSelf(),e&&Laya.Pool.recover("Animation",a)}}static createEllipse(t,e,i,a,n,r=1,o="#ffffff"){let l=[],v=a>n?r/a:r/n;for(let I=0;I<2*Math.PI;I+=v)l.push(e+a*Math.cos(I)-a/2,i+n*Math.sin(I));return t&&t.drawPoly(l.shift(),l.shift(),l,o),l}};xt.blackFilter=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.78,0]),xt.blackFilter2=new Laya.ColorFilter([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.5,0]),xt.qualityColors=["#78cefd","#78cefd","#78cefd","#d5a8ff","#fdd378","#ffa8a8","#ffa8a8","#ffa8a8"],xt.COLORS=["#69ff4c","#FFFFFF"],xt.PRO_DIC={HP:"hp",ATK:"attack",DEF:"defense",SPEED:"speed",RES:"resilience",CDMG:"critDamage",CDMGR:"critDamReduct"},xt.proList={hp:"HP",attack:"ATK",defense:"DEF",speed:"SPEED",hit:"hit",dodge:"dodge",crit:"crit",critDamage:"CDMG",resilience:"RES",critDamReduct:"CDMGR"},xt.RES_W=["K","M","B","T"];var pi=xt;var Ks=class extends Laya.Box{};var{regClass:lp}=Laya,Ws=class extends Ks{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.shopItem=e,this.shopItem&&this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){this.tf_name.text=f.instance.getLanguage(this.shopItem.title),this.img_const.skin=R.instance.getMoneyIcon(this.shopItem.cost[0]),this.tf_const.text=At.formatNumber(this.shopItem.cost[1])+"",this.shopItem.type==1&&(this.tf_name.color=pi.qualityColors[parseInt(this.shopItem.icon)-1],this.img_bg.skin=R.instance.getHeroQuality(this.shopItem.icon),this.img_icon.skin=R.instance.getHeroEggIcon(this.shopItem.icon))})}};Ws=u([lp("awS07ko0RBaxCnxXWqiR4g")],Ws);var Ys=class extends Laya.Box{};var{regClass:cp}=Laya,js=class extends Ys{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.shopItem=e,this.shopItem&&this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){if(this.tf_name.text=f.instance.getLanguage(this.shopItem.title),this.img_const.skin=R.instance.getMoneyIcon(this.shopItem.cost[0]),this.tf_const.text=At.formatNumber(this.shopItem.cost[1])+"",this.shopItem.type==2){var e=j.intance.m_dicItems.get(this.shopItem.icon);this.img_bg.skin=R.instance.getItemQualityIcon(e.quality+""),this.tf_name.color=pi.qualityColors[e.quality-1],this.img_icon.skin=R.instance.getItemIcon(this.shopItem.icon)}})}};js=u([cp("din69PYeRbSapMB2H6E06g")],js);var Xs=class extends Laya.Scene{};var{regClass:up}=Laya,qs=class extends Xs{constructor(){super(...arguments);this.currTab=0;this.type=1;this.addL=1;this.price=0;this.isSkReady=!1}onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP}onOpened(e){e&&(this.type=e,this.onClickTab(this.type))}onEnable(){d.intance.on(b.EVENT_HERO_DRAW_BACK,this,this.onDrawBack),this.btn_recruit.on(Laya.Event.CLICK,this,this.onRecruit),this.btn_reduce.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_reduce]),this.btn_plus.clickHandler=new Laya.Handler(this,this.handleClickBtn,[this.btn_plus]),this.btn_1.on(Laya.Event.CLICK,this,this.onClickTab,[1]),this.btn_2.on(Laya.Event.CLICK,this,this.onClickTab,[2]),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.listPanel1.vScrollBarSkin="",this.listPanel1.selectHandler=Laya.Handler.create(this,this.onSelectItem,[1],!1),this.listPanel2.vScrollBarSkin="",this.listPanel2.selectHandler=Laya.Handler.create(this,this.onSelectItem,[2],!1),this.img_sk.on(Laya.Event.PLAYED,this,this.stopAni,[2]),this.box_2.visible=!1,this.initLuckDrawView();let e=(Laya.stage.height-X.DESIGN_HEIGHT)/2}onRecruit(){return _(this,null,function*(){if(this.shopItem.open==0&&X.Debug==0){at.instance.notice(f.instance.getLanguage(12));return}this.shopItem.type==1?(this.setChou1Ani("animation"+this.shopItem.icon+"_1"),yield Pt.instance.recruit(this.shopItem.id),this.setChou2Ani("animation"+this.shopItem.icon+"_2")):yield Pt.instance.recruitItem(this.shopItem.id,this.addL)})}setTab(e){for(let i=1;i<7;i++)e==i?(this["btn_"+i].getChildByName("selectBox").visible=!0,this["btn_"+i].getChildByName("tf_txt").color="#143f6b",this["btn_"+i].getChildByName("img_tab_icon").skin="res/shop/img_shop_"+i+"_s.png"):(this["btn_"+i].getChildByName("selectBox").visible=!1,this["btn_"+i].getChildByName("tf_txt").color="#7ff1fe",this["btn_"+i].getChildByName("img_tab_icon").skin="res/shop/img_shop_"+i+".png")}initLuckDrawView(){return _(this,null,function*(){this.destroyed||(this.type?this.onClickTab(this.type):this.onClickTab(1))})}onClickTab(e){if(this.currTab!=e)if(this.setTab(e),e==1){if(this.box_2.visible=!0,this.destroyed)return;this.shopItems=this.getItemByType(1),this.listPanel1.array=this.shopItems,this.listPanel1.visible=!0,this.listPanel2.visible=!1,this.listPanel1.selectedIndex=-1,this.listPanel1.selectedIndex=0}else{if(this.box_2.visible=!0,this.destroyed)return;this.shopItems=this.getItemByType(2),this.listPanel2.dataSource=this.shopItems,this.listPanel1.visible=!1,this.listPanel2.visible=!0,this.listPanel2.selectedIndex=-1,this.listPanel2.selectedIndex=0}}getItemByType(e){var i=j.intance.m_dicShops.values,a=[];return i.forEach(n=>{n.type==e&&a.push(n)}),a}onSelectItem(e,i){this.shopItem=this.shopItems[i],console.log(this.shopItem),this.shopItem?(this.tf_name.text=f.instance.getLanguage(this.shopItem.title),this.tf_des.text=f.instance.getLanguage(this.shopItem.des),this.img_const.skin=R.instance.getMoneyIcon(this.shopItem.cost[0]),this.addL=1,this.price=At.formatNumber(this.shopItem.cost[1]),this.setPriceByNum(),e==1?(this.img_icon.visible=!1,this.img_sk.visible=!0,this.setIdleAni("animation"+this.shopItem.icon+"_0"),this.box_count.visible=!1):e==2&&(this.img_icon.skin=R.instance.getItemBigIcon(this.shopItem.icon),this.img_icon.y=60,this.img_icon.visible=!0,this.img_sk.visible=!1,this.box_count.visible=!0),this.btn_recruit.visible=!0):(this.tf_name.text="",this.tf_des.text="",this.img_icon.visible=!1,this.img_sk.visible=!1,this.box_count.visible=!1,this.btn_recruit.visible=!1)}handleClickBtn(e){switch(e){case this.btn_reduce:this.addL>1&&this.addL--,this.setPriceByNum();break;case this.btn_plus:this.addL<100&&this.addL++,this.setPriceByNum();break}}setPriceByNum(){this.tf_num.text=this.addL+"",this.tf_const.text=this.addL*this.price+""}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN)}stopAni(e){console.log("stopAni: "+e),this.isSkReady||(this.isSkReady=!0,this.callLater(this.stopSk))}stopSk(){this.img_sk.paused(),this.img_sk.stop()}setIdleAni(e){this.isSkReady?(this.img_sk.play(e,!1),this.img_sk.stop()):this.img_sk.animationName=e}setChou1Ani(e){this.isSkReady?this.img_sk.play(e,!0):this.img_sk.animationName=e}setChou2Ani(e){this.isSkReady?this.img_sk.play(e,!1):this.img_sk.animationName=e,Laya.timer.once(800,this,this.openHeroGetView)}openHeroGetView(){ft.instance.autoPop=!0,Zt.instance.startShow(),this.setIdleAni("animation"+this.shopItem.icon+"_0")}onDrawBack(e){}startAni(){this.img_sk.paused(),this.img_sk.play(0,!1)}removeEvent(){d.intance.off(b.EVENT_HERO_DRAW_BACK,this,this.onDrawBack)}};qs=u([up("IPCUkD5kRse3Gz5tw0Aovw")],qs);var zs=class extends Laya.Box{};var{regClass:pp}=Laya,Qs=class extends zs{constructor(){super();this.isAddEvent=!1}set dataSource(e){super.dataSource=e,this.unionItem=e,this.unionItem&&this.setCurrentOutPut()}setCurrentOutPut(){return _(this,null,function*(){this.tf_name.text=f.instance.getLanguage(this.unionItem.name),this.tf_lv.text=f.instance.getUILang("LV.")+this.unionItem.unionLv,this.tf_num.text="<font color='#25ff63'>"+this.unionItem.number+"</font>/"+this.unionItem.maxNumber,this.img_lvBg.skin="res/union1/img_trade_di_"+(this.unionItem.unionLv>3?4:this.unionItem.unionLv)+".png",this.img_lvIcon.skin="res/union1/img_trade_"+(this.unionItem.unionLv>3?4:this.unionItem.unionLv)+".png"})}onChange(e){e?this.bg.skin="res/union1/img_trade_bg_2.png":this.bg.skin="res/union1/img_trade_bg_1.png"}};Qs=u([pp("cbbqawzdSI2g161G69xpUg")],Qs);var Js=class extends Laya.Scene{};var{regClass:mp}=Laya,Zs=class extends Js{constructor(){super(...arguments);this.currTab=0;this.type=1;this.items=[];this.hasItem=!1}onAwake(){this.m_iLayerType=x.M_POP,this.m_iPositionType=x.UP}onOpened(e){this.type=e}onEnable(){this.btn_search.on(Laya.Event.CLICK,this,this.onSearch),this.btn_back&&this.btn_back.on(Laya.Event.CLICK,this,this.setToMainScene),this.list_union.vScrollBarSkin="",this.list_union.selectHandler=Laya.Handler.create(this,this.onSelectItem,null,!1),this.list_union.renderHandler=Laya.Handler.create(this,this.onItemRender,null,!1),this.box_show.visible=!1,this.initLuckDrawView();let e=(Laya.stage.height-X.DESIGN_HEIGHT)/2}initLuckDrawView(){return _(this,null,function*(){this.getItemByName(""),this.destroyed})}getItemByName(e){this.list_union.selectedIndex=-1,this.items=[],this.hasItem=!1;for(var i=j.intance.m_dicUnions.values,a=i.length,n=0;n<a;n++){var r=i[n],o=f.instance.getLanguage(r.name);Qt.caseInsensitiveSearchWithRegex(o,e)&&(this.hasItem=!0,this.items.push(r))}this.list_union.array=this.items,this.items.length>0?this.list_union.selectedIndex=0:this.list_union.selectedIndex=-1}onSearch(){var e=this.input_search.text;this.getItemByName(e)}onItemRender(e,i){e.onChange(this.list_union.selectedIndex==i)}onSelectItem(e,i){var a=this.items[e];console.log(a),a?(this.tf_name.text=f.instance.getLanguage(a.name),this.tf_des.text=f.instance.getLanguage(a.declaration),this.tf_name.text=f.instance.getLanguage(a.name),this.tf_num.text="<font color='#25ff63'>"+a.number+"</font>/"+a.maxNumber,this.img_lvIcon.skin="res/union1/img_trade_"+(a.unionLv>3?4:a.unionLv)+".png",this.box_show.visible=!0):this.box_show.visible=!1}setToMainScene(){ot.intance.setCurrentScene(J.M_SCENE_MAIN)}removeEvent(){}};Zs=u([mp("VfpfbqXcSQalDIkuosz8Rw")],Zs);var{regClass:hp,property:XA}=Laya,ya=class extends Laya.Script{constructor(){super()}onEnable(){this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:-10})}onTriggerEnter(t,e,i){this.owner.removeSelf()}onUpdate(){this.owner.y<-10&&this.owner.removeSelf()}onDisable(){Laya.Pool.recover("bullet",this.owner)}};ya=u([hp("hIXP-u9_RfeIwPLhNGNjGw")],ya);var{regClass:dp,property:QA}=Laya,ga=class extends Laya.Script{constructor(){super()}onEnable(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onClick)}onClick(t){Laya.stage.width=1334,Laya.stage.height=750,Laya.stage.scaleMode=Laya.Stage.SCALE_FIXED_WIDTH,Laya.Scene.open("scenes/Index.ls")}onDisable(){this.owner.off(Laya.Event.MOUSE_DOWN,this)}};ga=u([dp("DQCudilORvOvMM7hTH8i7w")],ga);var{regClass:yp,property:gp}=Laya,De=class extends Laya.Script{constructor(){super();this.level=1}get itemId(){return this._itemId}set itemId(e){this._itemId=e,this.owner.skin="resources/UI/images/bag/"+e+".png"}onEnable(){this._rig=this.owner.getComponent(Laya.RigidBody),this.level=Math.round(Math.random()*5)+1}onUpdate(){}onCollisionEnter(e){console.log("collision: ",e)}onTriggerEnter(e,i,a){var n=this.owner;if(console.log("owener: ",n),e.label==="buttle"&&n.parent){let r=Laya.Pool.getItemByCreateFun("effect",this.createEffect,this);r.pos(n.x,n.y),n.parent.addChild(r),r.play(0,!0),n.removeSelf(),Laya.SoundManager.playSound("resources/sound/destroy.wav")}}createEffect(){let e=new Laya.Animation;e.loadAnimation("resources/ani/TestAni.ani"),e.on(Laya.Event.COMPLETE,null,i);function i(){e.removeSelf(),Laya.Pool.recover("effect",e)}return e}onDisable(){Laya.Pool.recover("dropBox",this.owner)}};u([gp({type:"number"})],De.prototype,"level",2),De=u([yp("3L23NCFLSAieUApqTrVoCQ")],De);var{regClass:bp,property:e2}=Laya,Fe=class extends Laya.Script{constructor(){super();this.touchHeroIds=new F;this.touchGlasses=new F;this.updateIndex=0}onAwake(){}onEnable(){}onCollisionEnter(e){console.log(this.constructor.name+" onCollisionEnter collision",e)}onCollisionStay(e){console.log(this.constructor.name+" onCollisionStay collision",e)}onCollisionExit(e){console.log(this.constructor.name+" onCollisionExit collision",e)}onTriggerEnter(e,i,a){if(console.log(this.constructor.name+" onTriggerEnter other",e,"self",i,a),e.label==="ground")console.warn("ground in");else if(e.label&&e.label.startsWith("grass"))this.owner.isMe&&(console.warn("grass in"),this.touchGlasses.set(e.label,!0),this.setMyCurrArea());else if(e.label==="item")this.owner.enterItemId=e.owner.getComponent(De).itemId;else if(e.label==="role"){var n=e.owner.roomPlayerDto.id;if(this.touchHeroIds.set(n,e.owner),this.owner.displacementType==2){var r=A.instance.canAttack(this.owner,e.owner);r&&Laya.Tween.clearAll(this.owner)}}}onTriggerStay(e,i,a){console.log(this.constructor.name+" onTriggerStay other",e,"self",i,a)}onTriggerExit(e,i,a){if(console.log(this.constructor.name+" onTriggerExit other",e,"self",i,a),e.label==="ground")this.owner.inGround=!1,console.warn("ground exit");else if(e.label&&e.label.startsWith("grass"))this.owner.isMe&&(console.warn("grass out"),this.touchGlasses.remove(e.label),this.setMyCurrArea());else if(e.label==="item")this.owner.enterItemId==e.owner.getComponent(De).itemId&&(this.owner.enterItemId=0);else if(e.label==="role"){var n=e.owner.roomPlayerDto.id;this.touchHeroIds.remove(n)}}setMyCurrArea(){this.touchGlasses.keys.length>0?this.owner.currArea=1:this.owner.currArea=0,this.owner.onSendMoveData()}onUpdate(){if(this.owner.isMe)A.instance.myHeroSpr.currArea>0?this.owner.alpha=.6:this.owner.alpha=1;else{this.owner.currArea>0?A.instance.myHeroSpr.currArea==this.owner.currArea?(this.owner.visible=!0,this.owner.alpha=.6):this.owner.visible=!1:(this.owner.visible=!0,this.owner.alpha=1);return}if(!this.owner.isStop){if(this.owner.speed>0){switch(this.owner.isLockAni||(this.lastSpeed!=this.owner.speed||this.owner.aniChange)&&(this.owner.aniChange=!1,this.owner.heroSk.isReady&&this.owner.walk(),this.lastSpeed=this.owner.speed),this.owner.roleDirection){case 1:this.owner.y=Math.round(this.owner.y-this.owner.speed);break;case 2:this.owner.x=Math.round(this.owner.x+this.owner.biasSpeed),this.owner.y=Math.round(this.owner.y-this.owner.biasSpeed);break;case 3:this.owner.x=Math.round(this.owner.x+this.owner.speed);break;case 4:this.owner.x=Math.round(this.owner.x+this.owner.biasSpeed),this.owner.y=Math.round(this.owner.y+this.owner.biasSpeed);break;case 5:this.owner.y=Math.round(this.owner.y+this.owner.speed);break;case 6:this.owner.x=Math.round(this.owner.x-this.owner.biasSpeed),this.owner.y=Math.round(this.owner.y+this.owner.biasSpeed);break;case 7:this.owner.x=Math.round(this.owner.x-this.owner.speed);break;case 8:this.owner.x=Math.round(this.owner.x-this.owner.biasSpeed),this.owner.y=Math.round(this.owner.y-this.owner.biasSpeed);break}console.log("this.owner.inControl 0: "+this.owner.inControl+", id: "+this.owner.roomPlayerDto.id),this.owner.inControl&&!this.owner._isDead&&(console.log("this.owner.inControl 1: "+this.owner.inControl+", id: "+this.owner.roomPlayerDto.id),this.touchHeroIds.values.forEach(e=>{var i=A.instance.canTui(this.owner,e);i&&(console.log("this.owner.inControl 2: "+this.owner.inControl+", id: "+this.owner.roomPlayerDto.id),e.beiTui(this.owner.roomPlayerDto.id))}))}else this.owner.isLockAni||(this.lastSpeed!=this.owner.speed||this.owner.aniChange)&&(this.owner.aniChange=!1,this.owner.idle(),this.lastSpeed=this.owner.speed);this.updateIndex==0&&this.owner.onSendMoveData(),this.updateIndex++,this.updateIndex>0&&(this.updateIndex=0)}}onDisable(){}};Fe=u([bp("DknC7B57SZi-09Mz092daQ")],Fe);var{regClass:fp,property:ac}=Laya,Ce=class extends Laya.Script{constructor(){super();this.createBoxInterval=1e3;this._time=0;this._started=!1;this.updateStop=!1}onEnable(){let e=["resources/UI/images/test/b1.png"];Laya.loader.load(e).then(i=>{this._time=Date.now(),this._gameBox=this.owner.getChildByName("gameBox"),Laya.stage.on(Laya.Event.BLUR,this,()=>{this.updateStop=!0}),Laya.stage.on(Laya.Event.FOCUS,this,()=>{this.updateStop=!1}),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onStageClick)})}onStart(){let e=this.owner.getChildByName("ground").getComponent(Laya.BoxCollider);e.width=Laya.stage.width}onUpdate(){if(this.updateStop)return;let e=Date.now();e-this._time>this.createBoxInterval&&this._started&&(this._time=e,this.createBox())}createBox(){let e=Laya.Pool.getItemByCreateFun("dropBox",this.dropBox.create,this.dropBox);e.pos(Math.random()*(Laya.stage.width-100),-100),this._gameBox.addChild(e)}onStageClick(e){e.stopPropagation();let i=Laya.Pool.getItemByCreateFun("bullet",this.bullet.create,this.bullet);i.pos(Laya.stage.mouseX,Laya.stage.mouseY),this._gameBox.addChild(i)}startGame(){this._started||(this._started=!0,this.enabled=!0)}stopGame(){this._started=!1,this.enabled=!1,this.createBoxInterval=1e3,this._gameBox.removeChildren()}};u([ac({type:Laya.Prefab})],Ce.prototype,"dropBox",2),u([ac({type:Laya.Prefab})],Ce.prototype,"bullet",2),Ce=u([fp("5iJgbfCiSn6Rc8upAfHtjA")],Ce);var $s=class extends Laya.Scene{};var{regClass:Lp,property:u2}=Laya,Ke=class extends $s{constructor(){super();Ke.instance=this}onEnable(){this._control=this.getComponent(Ce),this.tipLbll.on(Laya.Event.CLICK,this,this.onTipClick)}onTipClick(e){this.tipLbll.visible=!1,this._score=0,this.scoreLbl.text="分数：",this._control.startGame()}addScore(e=1){this._score+=e,this.scoreLbl.text="分数："+this._score,this._control.createBoxInterval>600&&this._score%20==0&&(this._control.createBoxInterval-=20)}stopGame(){this.tipLbll.visible=!0,this.tipLbll.text="游戏结束了，点击屏幕重新开始",this._control.stopGame()}};Ke=u([Lp("Y5UkAabiTgWFZQnBL1EpEw")],Ke);var to=class extends Laya.Scene{};var{regClass:_p,property:b2}=Laya,ba=class extends to{constructor(){super()}onOpened(t){t&&(this.msgLab.x=t.point&&t.point.x?t.point.x:Laya.stage.mouseX-50,this.msgLab.y=t.point&&t.point.y?t.point.y:Laya.stage.mouseY-80,this.msgLab.text=t.text,Laya.Tween.to(this.msgLab,{y:this.msgLab.y-100,alpha:0},1e3,Laya.Ease.linearNone))}};ba=u([_p("9kGOzpbbSOWSAmN0l9VtfQ")],ba);var{regClass:vp,property:dl}=Laya,fa=Laya.Browser,nc=Laya.Render,rc=Laya.SpriteUtils,Nt=class extends Laya.Script{constructor(){super();Nt.instance=this}onEnable(){this.videoBtn.on(Laya.Event.MOUSE_DOWN,this,()=>{this.createElementVideo()})}createElementVideo(){fa.window.IframeElementRT=this,this.createScript(),this.createDiv(),this.createIframe("resources/files/video.html?url=layaAir.mp4"),this.setDOMElementInArea(),Laya.stage.on(Laya.Event.RESIZE,this,this.setDOMElementInArea)}setDOMElementInArea(){this.iframeElement!=null&&this.divElement!=null&&(rc.fitDOMElementInArea(this.divElement,this.closeBox,0,0,this.closeBox.width,this.closeBox.height),rc.fitDOMElementInArea(this.iframeElement,this.iframeBox,0,0,this.iframeBox.width,this.iframeBox.height))}createScript(){this.scriptElement=fa.document.createElement("script"),fa.document.body.appendChild(this.scriptElement),this.scriptElement.innerHTML="function closeVideo(){IframeElementRT.closeVideo() }"}createIframe(e){this.iframeElement=fa.createElement("iframe"),fa.document.body.appendChild(this.iframeElement),this.iframeElement.style.zIndex=nc.canvas.style.zIndex+998,this.iframeElement.src=e,this.iframeElement.style.margin="0",this.iframeElement.style.scrolling="no",this.iframeElement.style.frameborder="0",this.iframeElement.style.padding="0",this.iframeElement.style.left="0",this.iframeElement.style.top="0px",this.iframeElement.style.position="absolute"}createDiv(){this.divElement=Laya.Browser.createElement("div"),Laya.Browser.document.body.appendChild(this.divElement),this.divElement.innerHTML="<img src='resources/files/x.png' width='60px' height='60px' onclick='closeVideo()'/>",this.divElement.style.zIndex=nc.canvas.style.zIndex+999}closeVideo(){Laya.Browser.document.body.removeChild(this.scriptElement),Laya.Browser.document.body.removeChild(this.iframeElement),Laya.Browser.document.body.removeChild(this.divElement),this.scriptElement=this.iframeElement=this.divElement=null,Laya.stage.off(Laya.Event.RESIZE,this,this.setDOMElementInArea)}};u([dl({type:Laya.Button})],Nt.prototype,"videoBtn",2),u([dl({type:Laya.Box})],Nt.prototype,"closeBox",2),u([dl({type:Laya.Box})],Nt.prototype,"iframeBox",2),Nt=u([vp("ZtMxoJHQTWipjGWyGV51jQ")],Nt);var eo=class extends Laya.Scene{};var{regClass:wp,property:I2}=Laya,La=class extends eo{constructor(){super()}onEnable(){Laya.Physics2D.I&&(Laya.Physics2D.I.enableDebugDraw=!1),this.tabBindViewStack(),this.topTab.selectedIndex=0,this.item0Tab.selectedIndex=0}onClicked(){let t=this.item2Tab.getChildByName("item2"),e=this.item2Tab.getChildByName("item3"),i=this.item2Tab.getChildByName("item4");t.on(Laya.Event.MOUSE_DOWN,this,()=>{Laya.Scene.open("scenes/uiDemo/page/OpenMainScene.ls",!1)}),e.on(Laya.Event.MOUSE_DOWN,this,()=>{Laya.Scene.open("scenes/uiDemo/page/OpenScene.ls",!1)}),i.on(Laya.Event.MOUSE_DOWN,this,()=>{Laya.Scene.open("scenes/uiDemo/page/Dialog.ls",!1,{title:"弹窗的标题",text:"弹窗的具体文本……"})})}tabBindViewStack(){this.topTab.selectHandler=new Laya.Handler(this,t=>{this.tabPage.selectedIndex=t,t==1&&(this.item1Tab.selectedIndex=0),t==2&&(this.item2Tab.selectedIndex=0),t==3&&(this.item3Tab.selectedIndex=0),t==4&&(this.item4Tab.selectedIndex=0),Laya.Physics2D.I&&(Laya.Physics2D.I.enableDebugDraw=!1),Nt.instance.iframeElement&&Nt.instance.closeVideo(),t==2&&this.item2Page.selectedIndex==1&&!Nt.instance.iframeElement&&Nt.instance.createElementVideo()}),this.item0Tab.selectHandler=new Laya.Handler(this,t=>{this.item0Page.selectedIndex=t}),this.item1Tab.selectHandler=new Laya.Handler(this,t=>{this.item1Page.selectedIndex=t,t!==4&&Laya.Physics2D.I?Laya.Physics2D.I.enableDebugDraw=!1:t==4&&Laya.Physics2D.I&&(Laya.Physics2D.I.enableDebugDraw=!0)}),this.item2Tab.selectHandler=new Laya.Handler(this,t=>{switch(this.item2Page.selectedIndex=t,t){case 1:!Nt.instance.iframeElement&&Nt.instance.createElementVideo();break;case 2:Laya.Scene.open("scenes/uiDemo/page/OpenMainScene.ls",!1);break;case 3:Laya.loader.load("prefab/uiDemo/page/Win.lh").then(e=>{let i=e.create();this.tabPage.parent.addChild(i)});break;case 4:Laya.loader.load("prefab/uiDemo/page/Dialog.lh").then(e=>{e.create().show()});break}t!==1&&Nt.instance.iframeElement&&Nt.instance.closeVideo()}),this.item3Tab.selectHandler=new Laya.Handler(this,t=>{this.item3Page.selectedIndex=t}),this.item4Tab.selectHandler=new Laya.Handler(this,t=>{this.item4Page.selectedIndex=t})}onDisable(){}};La=u([wp("gbAKGLFtQ5WL6-NpVocAEA")],La);var{regClass:Ip,property:io}=Laya,Me=class extends Laya.Script{constructor(){super(...arguments);this.isPlay=!1}onAwake(){console.log("创建动画模板"),this.createAniTemplate("moveB"),this.createAniTemplate("moveC"),this.createAniTemplate("moveE"),this.createAniTemplate("moveF"),this.createAniTemplate("moveH"),this.createAniTemplate("moveI"),this.createAniTemplate("moveK"),this.createAniTemplate("moveL"),this.aniSource.play(0,!0,"moveB")}onEnable(){this.playAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!0,this.aniSource.play(0,!0,this.selectAni.selectedLabel)}),this.stopAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!1,this.aniSource.isPlaying&&this.aniSource.stop()}),this.selectAni.selectHandler=new Laya.Handler(this,()=>{this.isPlay?this.aniSource.play(0,!0,this.selectAni.selectedLabel):this.aniSource.play(0,!1,this.selectAni.selectedLabel)})}createAniTemplate(e,i=8){let a=[];for(let n=0;n<i;n++)a.push("resources/UI/role/atlasAni/139x/"+e+n+".png");Laya.Animation.createFrames(a,e)}onError(e){console.log("加载失败: "+e)}};u([io({type:Laya.Button})],Me.prototype,"playAni",2),u([io({type:Laya.Button})],Me.prototype,"stopAni",2),u([io({type:Laya.ComboBox})],Me.prototype,"selectAni",2),u([io({type:Laya.Animation})],Me.prototype,"aniSource",2),Me=u([Ip("tmkUlMggQi20FZpy6nC1aw")],Me);var{regClass:Sp,property:ao}=Laya,xe=class extends Laya.Script{constructor(){super(...arguments);this.isPlay=!1}onEnable(){this.isPlay=!0,this.playAnimation(this.selectAni.selectedLabel),this.playAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!0,this.playAnimation(this.selectAni.selectedLabel)}),this.stopAni.on(Laya.Event.MOUSE_DOWN,this,()=>{this.isPlay=!1,this.aniSource.isPlaying&&this.aniSource.stop()}),this.selectAni.selectHandler=new Laya.Handler(this,()=>{this.isPlay?this.playAnimation(this.selectAni.selectedLabel):this.playAnimation(this.selectAni.selectedLabel,!1)})}playAnimation(e,i=!0,a=7){let n=[];for(let r=0;r<a;r++)n.push("resources/UI/role/frameAni/"+e+r+".png");this.aniSource.loadImages(n).play(0,i)}};u([ao({type:Laya.Button})],xe.prototype,"playAni",2),u([ao({type:Laya.Button})],xe.prototype,"stopAni",2),u([ao({type:Laya.ComboBox})],xe.prototype,"selectAni",2),u([ao({type:Laya.Animation})],xe.prototype,"aniSource",2),xe=u([Sp("8gw7FS4iT1q8EhdN3sWklQ")],xe);var{regClass:Ep,property:R2}=Laya,sc=Laya.Event,Tp=Laya.SpineSkeleton,_a=class extends Laya.Script{constructor(){super(...arguments);this.skinArray=["goblin","goblingirl"];this.skinIndex=0;this.spineAniIndex=6}onEnable(){this.createLayaSpine(),this.createSpine()}createLayaSpine(){this.skeletonNode=this.owner.getChildByName("skeletonNode"),Laya.loader.load("resources/UI/role/spineAni/goblins.sk").then(e=>{this.skeletonAni=e.buildArmature(1),this.skeletonNode.addChild(this.skeletonAni),this.skeletonAni.x=128,this.skeletonAni.y=390,this.spineAniNum=this.skeletonAni.getAnimNum(),this.skeletonAni.play(0,!0),this.changeSkin(),this.skeletonNode.on(sc.CLICK,this,this.changeSkin)})}parseComplete(){}createSpine(){this.spineNode=this.owner.getChildByName("spineNode"),Laya.loader.load("resources/UI/role/spineAni/spineboy-pma.skel",Laya.Loader.SPINE).then(e=>{this.spineAni=new Tp,this.spineAni.templet=e,this.spineNode.addChild(this.spineAni),this.spineAni.scale(.3,.3),this.spineAni.pos(220,390),this.spineAniNum=this.spineAni.getAnimNum(),this.spineAni.play(this.spineAniIndex,!0),this.spineNode.on(sc.CLICK,this,this.changeAni)})}spineParseComplete(){}changeAni(){++this.spineAniIndex>=this.spineAniNum&&(this.spineAniIndex=5),this.spineAni.play(this.spineAniIndex,!0,!0)}changeSkin(){this.skeletonAni.showSkinByName(this.skinArray[this.skinIndex]),++this.skinIndex>=this.skinArray.length&&(this.skinIndex=0)}};_a=u([Ep("qTd2xmRXT4i0Re94qly0Lg")],_a);var{regClass:Dp,property:va}=Laya,oc=Laya.Event,Cp=Laya.Point,Le=class extends Laya.Script{constructor(){super();this.runAniName="runRight,runRDown1,runRDown2,runRDown3,runDown,runLDown3,runLDown2,runLDown1,runLeft,runLUp1,runLUp2,runLUp3,runUp,runRUp3,runRUp2,runRUp1";this.standAniName="right,Rdown,down,Ldown,left,Lup,up,Rup";this.stageMouse=new Cp;this.angle=0;this.isMoving=!1;this.isRun=!1}onEnable(){this.createMap(),this.sceneWindow.on(oc.MOUSE_UP,this,this.mouseUp),this.roleAniNode=this.roleAni.create(),this.sceneWindow.addChild(this.roleAniNode),this.roleAniNode.pivot(this.roleAniNode.width/2,this.roleAniNode.height/2+26),this.roleAniNode.scale(.6,.6),this.roleAniNode.x=this.lastX=48,this.roleAniNode.y=this.lastY=48,this._animator=this.roleAniNode.getComponent(Laya.Animator2D);let e=this._animator.getDefaultState();console.log(e.name),this.createWallMap()}createWallMap(){Laya.loader.load("resources/tiledMap/desert_new.json").then(()=>{let i=Laya.loader.getRes("resources/tiledMap/desert_new.json").data.layers[0].data,a;a=new Array;for(var n=0;n<40;n++){a[n]=new Array;for(var r=0;r<60;r++)i[n*60+r]==30?a[n][r]=1:a[n][r]=0}this.graph=new window.Graph(a),this.opts=[],this.opts.closest=!0,this.opts.heuristic=window.astar.heuristics.diagonal})}mouseUp(e){if(this.isMoving)return;this.stageMouse.x=Laya.stage.mouseX,this.stageMouse.y=Laya.stage.mouseY;let i=this.gameMap.globalToLocal(this.stageMouse);var a=this.graph.grid[Math.ceil(this.roleAniNode.y/32)-1][Math.ceil(this.roleAniNode.x/32)-1],n=this.graph.grid[Math.ceil(i.y/32)-1][Math.ceil(i.x/32)-1];this._everyPath=window.astar.search(this.graph,a,n,{closest:this.opts.closest}),this._everyPath.length>0&&(this.isMoving=!0),Laya.timer.loop(100,this,this.loopfun)}loopfun(){if(this._everyPath.length>0){let e=this._everyPath[0].y*32+16,i=this._everyPath[0].x*32+16;e==this.lastX?i>this.lastY?this.angle=90:this.angle=270:e>this.lastX?this.angle=0:this.angle=180,this.switchAni("run"),this.lastX=e,this.lastY=i,Laya.Tween.to(this.roleAniNode,{x:e,y:i},100),this._everyPath.splice(0,1)}else this.switchAni("stand"),Laya.timer.clear(this,this.loopfun),this.isMoving=!1}createMap(){this.tiledMap=new Laya.TiledMap,this.tiledMap.createMap("resources/tiledMap/desert_new.json",new Laya.Rectangle(0,0,this.sceneWindow.width,this.sceneWindow.height),new Laya.Handler(this,this.completeHandler))}onLoaded(){this.tiledMap.mapSprite().removeSelf(),this.gameMap.addChild(this.tiledMap.mapSprite())}completeHandler(e=null){this.onLoaded()}switchAni(e){if(e=="run"){let i=this.getOrientation(this.angle,this.runAniName);this._animator.play(i),this.isRun=!0}else{this.isRun=!1;let i=this.getOrientation(this.angle,this.standAniName);this.lastAngle!==this.angle&&this._animator.play(i)}}getOrientation(e,i){let a=i.split(","),n=360/a.length;return a[Math.floor(e/n)]}onDisable(){Laya.stage.off(oc.MOUSE_UP,this,this.mouseUp),this.tiledMap&&this.tiledMap.destroy()}};u([va({type:Laya.Sprite})],Le.prototype,"gameMap",2),u([va({type:Laya.Prefab})],Le.prototype,"roleAni",2),u([va({type:"string"})],Le.prototype,"runAniName",2),u([va({type:"string"})],Le.prototype,"standAniName",2),u([va({type:Laya.Panel})],Le.prototype,"sceneWindow",2),Le=u([Dp("zBb5TGy7Swu5_GpFiGzUng")],Le);var{regClass:Mp,property:B2}=Laya,lc=Laya.Rectangle,We=class extends Laya.Script{constructor(){super(...arguments);this._rect1=lc.TEMP;this._rect2=lc.TEMP}rectDetection(e,i){return!(e.x>i.x+i.width||e.x+e.width<i.x||e.y>i.y+i.height||e.y+e.height<i.y)}collisionWith(e,i,a){let n=[];if(a==0){var r=Laya.Point.create(),o=e.width/2,l=e.height/2,v=Laya.Point.create(),I,k;r.x=e.x+o,r.y=e.y+l,I=this.rectToRadius(e.width,e.height)}else if(a==2){var q,Q;Q=this.arrayToPoint(e)}for(let H=0;H<i.length;H++)if(e!=i[H])switch(a){case 0:v.x=i[H].x+i[H].width/2,v.y=i[H].y+i[H].height/2,k=this.rectToRadius(i[H].width,i[H].height),this.circleDetection(r,v,I+k)&&n.push(i[H]);break;case 1:this.rectDetection(e,i[H])&&n.push(i[H]);break;case 2:e.name==="c1"?(q=this.arrayToPoint(i[H]),this.circleAndPolygonDetection(e,q,i[H])&&n.push(i[H])):i[H].name==="c1"?this.circleAndPolygonDetection(i[H],Q,e)&&n.push(i[H]):(q=this.arrayToPoint(i[H]),this.polygonDetection(Q,q,e,i[H])&&n.push(i[H]));break}return n}circleAndPolygonDetection(e,i,a){let n=this.getSides(i),r=[],o=Laya.Point.create(),l=Laya.Point.create(),v=e.hitArea._hit._cmds[0].radius,I=this.getNodeCoord(i,a);o.x=e.x+e.hitArea._hit._cmds[0].x,o.y=e.y+e.hitArea._hit._cmds[0].y,l=this.getNearestPoint(o,I),r.push(new Laya.Point(l.x-o.x,l.y-o.y));for(let k=0,q=n.length;k<q;k++)r.push(this.perpendicular(n[k]));for(let k=0,q=r.length;k<q;k++){let Q=r[k],H=this.getCircleProjection(o,Q,v),Z=this.getPolygonProjection(I,Q);if(!this.isOverlap(H,Z))return!1}return!0}getNearestPoint(e,i){let a=i[0],n=this.getDistance(e,a),r,o;for(let l=1;l<i.length;l++)r=i[l],o=this.getDistance(e,r),o<n&&(n=o,a=r);return a}polygonDetection(e,i,a,n){let r=this.getSides(e).concat(this.getSides(i)),o=[],l=this.getNodeCoord(e,a),v=this.getNodeCoord(i,n);for(let I=0,k=r.length;I<k;I++)o.push(this.perpendicular(r[I]));for(let I=0,k=o.length;I<k;I++){let q=o[I],Q=this.getPolygonProjection(l,q),H=this.getPolygonProjection(v,q);if(!this.isOverlap(Q,H))return!1}return!0}isOverlap(e,i){let a,n;return a=e.min<i.min?e.min:i.min,n=e.max>i.max?e.max:i.max,e.max-e.min+(i.max-i.min)>=n-a}getNodeCoord(e,i){let a=[];for(let n=0;n<e.length;n++){let r=Laya.Point.create();r.x=e[n].x+i.x+i.hitArea._hit._cmds[0].x,r.y=e[n].y+i.y+i.hitArea._hit._cmds[0].y,a.push(r)}return a}getPolygonProjection(e,i){let a=null,n=null;for(let r=0;r<e.length;r++){let o=this.dotProduct(e[r],i)/this.getLength(i);(a===null||o<a)&&(a=o),(n===null||o>n)&&(n=o)}return{min:a,max:n}}getCircleProjection(e,i,a){let n=this.dotProduct(e,i)/this.getLength(i);return{min:n-a,max:n+a}}rectToRadius(e,i){let a;return e==i?a=e/2:a=Math.sqrt(e*e+i*i)/2,a}circleDetection(e,i,a){return Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))<=a}circlesCollision(e,i,a,n){let r=this.subtract(e,i),o=this.getCircleProjection(e,r,a),l=this.getCircleProjection(i,r,n);return!!this.isOverlap(o,l)}arrayToPoint(e){let i=[],a=[];if(a=e.hitArea._hit._cmds[0].points,a&&a.length>3)for(let n=0;n<a.length/2;n++)i[n]=Laya.Point.create(),i[n].x=a[n*2],i[n].y=a[n*2+1];return i}perpendicular(e){let i=Laya.Point.create();return i.x=e.y,i.y=-e.x,i}getNormal(e){let i=Math.sqrt(e.x*e.x+e.y*e.y);return new Laya.Point(e.y/i,(0-e.x)/i)}getSides(e){var i=e,a=i.length,n=new Array;if(a>=3){for(var r=1,o=i[0];r<a;r++){let l=i[r];n.push(this.subtract(l,o)),o=l}n.push(this.subtract(i[0],i[a-1]))}return n}getLength(e){return Math.sqrt(e.x*e.x+e.y*e.y)}dotProduct(e,i){return e.x*i.x+e.y*i.y}subtract(e,i){return Laya.Point.create().setTo(e.x-i.x,e.y-i.y)}getDistance(e,i){let a=e.x-i.x,n=e.y-i.y;return Math.sqrt(a*a+n*n)}};We=u([Mp("naI7Ga3ZQzuwHxZXbiaZEw")],We);var no=class extends Laya.View{};var{regClass:xp,property:G2}=Laya,Ae=class extends no{constructor(){super();this._detectionType=0;this.collisionNodes=null;Ae.i=this}onEnable(){this.collisionNodes=[this.c1,this.p1,this.p2],this._script=this.getComponent(We),this.detectionType.selectHandler=new Laya.Handler(this,this.onSelected),this.detectionType.selectedIndex=0}onSelected(e){switch(console.log("onSelected:"+e),this._detectionType=e,e){case 0:this.setCircleLine([this.c11,this.p11,this.p22]);break;case 1:this.setRectLine([this.c11,this.p11,this.p22]);break;case 2:this.c11.graphics.clear(),this.p11.graphics.clear(),this.p22.graphics.clear();break}}collisionWith(e){let i;i=this._script.collisionWith(e,this.collisionNodes,this._detectionType),i.length>0?(i.push(e),this.setLineWidth(i)):this.retsetLineWidth()}setLineWidth(e){for(let i=0;i<e.length;i++)e[i]._graphics._cmds[0].lineWidth=3}retsetLineWidth(){for(let e=0;e<this.collisionNodes.length;e++)this.collisionNodes[e]._graphics._cmds[0].lineWidth=0}setCircleLine(e,i=1,a="#1e00fb"){for(let n=0;n<e.length;n++){e[n].graphics.clear();let r=e[n].width/2,o=e[n].height/2,l=this._script.rectToRadius(e[n].width,e[n].height);e[n].graphics.drawCircle(r,o,l,null,a,i)}}setRectLine(e,i=1,a="#1e00fb"){for(let n=0;n<e.length;n++)e[n].graphics.clear(),e[n].graphics.drawRect(e[n].x,e[n].y,e[n].width,e[n].height,null,a,i)}};Ae=u([xp("RrGHZH_SROCrF5XxFa05sg")],Ae);var{regClass:Ap,property:mi}=Laya,Ye=Laya.Event,cc=Laya.Point,ye=class extends Laya.Script{constructor(){super();this.runAniName="runRight,runRDown1,runRDown2,runRDown3,runDown,runLDown3,runLDown2,runLDown1,runLeft,runLUp1,runLUp2,runLUp3,runUp,runRUp3,runRUp2,runRUp1";this.standAniName="right,Rdown,down,Ldown,left,Lup,up,Rup";this.stageMouse=new cc;this.axisPivot=new cc;this.angle=0;this.radian=0;this.isMoving=!1;this.isRun=!1;this.mLastX=0;this.mLastY=0}onEnable(){this.createMap(),this.joystickAxis=this.joystickBG.getChildByName("joystickAxis"),this.maxDistance=this.joystickBG.width-this.joystickAxis.width,this.axisPivot.x=this.joystickAxis.x,this.axisPivot.y=this.joystickAxis.y,this.sceneWindow.on(Ye.MOUSE_DOWN,this,this.mouseDown),this.sceneWindow.on(Ye.MOUSE_MOVE,this,this.mouseMove),this.sceneWindow.on(Ye.MOUSE_UP,this,this.mouseUp),this.sceneWindow.on(Ye.MOUSE_OUT,this,this.mouseUp),this.roleAniNode=this.roleAni.create(),this.sceneWindow.addChild(this.roleAniNode),this.roleAniNode.pivot(this.roleAniNode.width/2,this.roleAniNode.height/2),this.roleAniNode.x=this.sceneWindow.width/2,this.roleAniNode.y=this.sceneWindow.height/2,this._animator=this.roleAniNode.getComponent(Laya.Animator2D);let e=this._animator.getDefaultState();console.log(e.name)}createMap(){this.tiledMap=new Laya.TiledMap,this.tiledMap.createMap("resources/tiledMap/desert_new.json",new Laya.Rectangle(0,0,this.sceneWindow.width,this.sceneWindow.height),new Laya.Handler(this,this.completeHandler))}onLoaded(){this.tiledMap.mapSprite().removeSelf(),this.gameMap.addChild(this.tiledMap.mapSprite())}completeHandler(e=null){this.onLoaded()}mouseDown(e){this.touchId=e.touchId,this.isMoving=!0,this.updateJoystickPoint()}updateJoystickPoint(){this.stageMouse.x=Laya.stage.mouseX,this.stageMouse.y=Laya.stage.mouseY;let e=this.joystickBG.globalToLocal(this.stageMouse),i=e.x-this.joystickAxis.width/2,a=e.y-this.joystickAxis.height/2;this.radian=Math.atan2(a-this.axisPivot.y,i-this.axisPivot.x),this.lastAngle=this.angle,this.angle=Math.round(this.radian*180/Math.PI*10)/10,this.angle<0&&(this.angle+=360),this.getDistance(this.joystickBG.width/2,this.joystickBG.height/2,e.x,e.y)>this.maxDistance&&this.lastAngle!==this.angle?(this.joystickAxis.x=Math.floor(Math.cos(this.radian)*this.maxDistance)+this.axisPivot.x,this.joystickAxis.y=Math.floor(Math.sin(this.radian)*this.maxDistance)+this.axisPivot.y):this.joystickAxis.pos(e.x-this.joystickAxis.width/2,e.y-this.joystickAxis.height/2),this.switchAni("run")}switchAni(e){if(e=="run"){let i=this.getOrientation(this.angle,this.runAniName);i!==this.lastRunAniName&&(this.lastRunAniName=i,this._animator.play(i)),this.isRun=!0}else{this.isRun=!1;let i=this.getOrientation(this.angle,this.standAniName);this.lastAngle!==this.angle&&this._animator.play(i)}}mouseUp(e){e.touchId==this.touchId&&(this.touchId=null,this.isMoving=!1,this.joystickAxis.pos(this.axisPivot.x,this.axisPivot.y),this.switchAni("stand"))}mouseMove(e){e.touchId==this.touchId&&this.updateJoystickPoint()}getOrientation(e,i){let a=i.split(","),n=360/a.length;return a[Math.floor(e/n)]}onUpdate(){this.isMoving&&this.updateRoleMove()}updateRoleMove(){this.switchAni("run");let e=Math.cos(this.radian)*2,i=Math.sin(this.radian)*2;this.mLastX+=e,this.mLastY+=i,this.mLastX<0?this.mLastX=0:this.mLastX>1920-this.sceneWindow.width&&(this.mLastX=1920-this.sceneWindow.width),this.mLastY<0?this.mLastY=0:this.mLastY>1280-this.sceneWindow.height&&(this.mLastY=1280-this.sceneWindow.height),this.tiledMap.moveViewPort(this.mLastX,this.mLastY)}getDistance(e,i,a,n){let r=e-a,o=i-n;return Math.sqrt(r*r+o*o)}onDisable(){Laya.stage.off(Ye.MOUSE_DOWN,this,this.mouseDown),Laya.stage.off(Ye.MOUSE_UP,this,this.mouseUp),Laya.stage.off(Ye.MOUSE_MOVE,this,this.mouseMove),this.tiledMap&&this.tiledMap.destroy()}};u([mi(Laya.Sprite)],ye.prototype,"gameMap",2),u([mi(Laya.Prefab)],ye.prototype,"roleAni",2),u([mi({type:"string"})],ye.prototype,"runAniName",2),u([mi({type:"string"})],ye.prototype,"standAniName",2),u([mi({type:Laya.Panel})],ye.prototype,"sceneWindow",2),u([mi(Laya.Image)],ye.prototype,"joystickBG",2),ye=u([Ap("k2DFVaFIQEyMRaElgOWsVw")],ye);var ro=class extends Laya.Box{};var{regClass:Rp}=Laya,wa=class extends ro{constructor(){super();this.lastIndex=-1}onEnable(){let e="resources/json/bagList.json";Laya.loader.fetch(e,"json").then(i=>{i.bagList&&i.bagList.length>0&&(this.bagList.array=i.bagList,this.bagList.renderHandler=new Laya.Handler(this,this.onListRender),this.bagList.selectHandler=new Laya.Handler(this,this.onListSelect),this.bagList.mouseHandler=new Laya.Handler(this,this.onListMouse),this.bagList.vScrollBarSkin="")})}onListRender(e,i){i>this.bagList.array.length||i<0}onListSelect(e){this.tips.visible=!0,this.bagList.array[e].listItemBG={skin:"resources/UI/images/bg/bg100-1.png"},this.lastIndex!==-1&&(this.bagList.array[this.lastIndex].listItemBG={skin:"resources/UI/images/bg/bg100-0.png"}),this.lastIndex=e,this.itemImg.skin=this.bagList.array[e].listItemImg.skin,this.itemNumber.text="数量 "+this.bagList.array[e].listItemNumber.text,this.itemReadme.text=this.bagList.array[e].readme}onListMouse(e,i){}onDisable(){}};wa=u([Rp("fimeRTYXT46eMH6komwhJQ")],wa);var{regClass:kp,property:yl}=Laya,Ue=class extends Laya.Script{constructor(){super()}onEnable(){var e=this.getDataSourece();Laya.loader.load("prefab/ComboList.lh").then(i=>{let a=i.create();this.comboList=a,this.comboList.array=e,this.comboList.repeatY=e.length,this.combo2.list=this.comboList,this.combo2.list.width=this.combo2.width,this.combo2.list.hScrollBarSkin="",this.combo2.selectHandler=new Laya.Handler(this,this.onSelected2)}),this.combo1.selectHandler=new Laya.Handler(this,this.onSelected1)}onSelected1(e){this.selectedText.text="您选中了："+this.combo1.selectedLabel}onSelected2(e){this.selectedText.text="您选中了："+(e<0?"":this.comboList.array[e].label)}getDataSourece(){for(var e=[],i=0;i<10;i++)e[i]={optText:{text:"选项"+(i+1)}};return e}onDisable(){}};u([yl({type:Laya.ComboBox})],Ue.prototype,"combo1",2),u([yl({type:Laya.ComboBox})],Ue.prototype,"combo2",2),u([yl({type:Laya.Label})],Ue.prototype,"selectedText",2),Ue=u([kp("M6bGyqDSRCGU3TkvNeqvRw")],Ue);var so=class extends Laya.View{};var{regClass:Op}=Laya,Ia=class extends so{onEnable(){this.hList.array=this.getListDataSource(),this.hList.scrollTo(1);let e=this.hList.cells[1].getChildByName("icon");e.scaleX=e.scaleY=2,this.hList.scrollBar.on(Laya.Event.CHANGE,this,this.onScrollBarChange),this.leftLimit=this.getLeftLimit(),this.rightLimit=this.getRightLimit()}onScrollBarChange(){var e=this.hList.scrollBar.value,i=this.hList.array;if(e>this.leftLimit){var a=i.shift();i[i.length]=a,this.hList.array=i,this.hList.scrollBar.value=e-this.hList.cells[0].width-this.hList.spaceX,this.iconTweenToLeft()}else e<this.rightLimit&&(a=i.pop(),i.unshift(a),this.hList.array=i,this.hList.scrollBar.value=e+this.hList.cells[0].width+this.hList.spaceX,this.iconTweenToRight())}iconTweenToLeft(e=200){let i=this.hList.cells[0].getChildByName("icon");i.scaleX=i.scaleY=2,Laya.Tween.to(i,{scaleX:1,scaleY:1},e);let a=this.hList.cells[1].getChildByName("icon");a.scaleX=a.scaleY=1,Laya.Tween.to(a,{scaleX:2,scaleY:2},e)}iconTweenToRight(e=200){let i=this.hList.cells[1].getChildByName("icon");i.scaleX=i.scaleY=2,Laya.Tween.to(i,{scaleX:1,scaleY:1},e);let a=this.hList.cells[2].getChildByName("icon");a.scaleX=a.scaleY=1,Laya.Tween.to(a,{scaleX:2,scaleY:2},e)}getRightLimit(){return this.hList.cells[0].width-this.hList.spaceX}getLeftLimit(){return this.hList.cells[0].width*2+this.hList.spaceX}getListDataSource(e=5){let i=[];for(let a=0;a<e;a++)i[a]={},i[a].icon={skin:`resources/UI/role/r${a}.png`};return i}};Ia=u([Op("WFag7yYwR9q-iI31OJUedg")],Ia);var{regClass:Pp,property:oo}=Laya,Re=class extends Laya.Script{constructor(){super();this.optStatus=[];this.timestampFormat=(e,i)=>{let a=i?new Date(i):new Date,n={"M+":a.getMonth()+1,"D+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"S+":a.getMilliseconds()};new RegExp("(Y+)").test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e}}onEnable(){let e="resources/json/mailList.json";Laya.loader.fetch(e,"json").then(i=>{let a=i.mailList;a&&a.length>0&&(this.mailList.array=a,this.mailList.mouseHandler=new Laya.Handler(this,this.onListMouse),this.mailList.repeatY=a.length,this.mailList.vScrollBarSkin=""),this.addMail.on(Laya.Event.CLICK,this,this.addMialItem),this.selectDel.on(Laya.Event.CLICK,this,this.listSelectDel),this.selectFlag.on(Laya.Event.CLICK,this,this.listSelectFlag)})}listSelectFlag(){if(this.optStatus.length>0){for(let e=0;e<this.optStatus.length;e++){let i=this.optStatus[e];this.mailList.array[i].flag=1,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail_open.png"},this.mailList.array[i].flagBtn={label:"标为未读",labelColors:"#3277f3,#3277f3,#3277f3"}}this.mailList.refresh(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"已成功标记"})}else Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"没有勾选项，请先勾选"})}listSelectDel(){if(this.optStatus.length>0){this.optStatus.sort(function(e,i){return i-e});for(let e=0;e<this.optStatus.length;e++)this.mailList.array.splice(this.optStatus[e],1);this.optStatus=[],this.mailList.refresh(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"已成功删除"})}else Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"没有勾选项，请先勾选"})}addMialItem(){var e=this.mailList.startIndex+1;let i={mailTitle:{text:"这里是新增加的邮件"+e},mailDateTime:{text:this.timestampFormat("YYYY-MM-DD hh:mm")},opt:{visible:!1},flagStatus:{skin:"resources/UI/images/comp/img_mail.png"},flagBtn:{label:"标为已读",labelColors:"#000000,#000000,#000000"}};if(this.mailList.array.splice(e,0,i),this.optStatus.length>0)for(let a=0;a<this.optStatus.length;a++)this.optStatus[a]>=e&&(this.optStatus[a]+=1);this.mailList.refresh()}onListMouse(e,i){if(e.type==Laya.Event.CLICK){var a=this.optStatus.indexOf(i);switch(e.target.name){case"optBG":a===-1?(this.mailList.array[i].opt={visible:!0},this.optStatus.push(i)):(this.mailList.array[i].opt={visible:!1},this.optStatus.splice(a,1)),this.mailList.refresh();break;case"mailTitle":Laya.Scene.open("scenes/uiDemo/Dialog.scene",!1,{title:this.mailList.array[i].mailTitle.text,text:"邮件内容，此处省略1000字……………………"}),this.mailList.array[i].flag=1,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail_open.png"},this.mailList.array[i].flagBtn={label:"标为未读",labelColors:"#3277f3,#3277f3,#3277f3"},this.mailList.refresh();break;case"flagBtn":this.mailList.array[i].flag===1?(this.mailList.array[i].flag=0,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail.png"},this.mailList.array[i].flagBtn={label:"标为已读",labelColors:"#000000,#000000,#000000"}):(this.mailList.array[i].flag=1,this.mailList.array[i].flagStatus={skin:"resources/UI/images/comp/img_mail_open.png"},this.mailList.array[i].flagBtn={label:"标为未读",labelColors:"#3277f3,#3277f3,#3277f3"}),this.mailList.refresh();break;case"delBtn":if(this.mailList.array.splice(i,1),a>-1){this.optStatus.splice(a,1);for(let n=a;n<this.optStatus.length;n++)this.optStatus[n]-=1}this.mailList.refresh(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"删除成功"});break}}}};u([oo({type:Laya.List})],Re.prototype,"mailList",2),u([oo({type:Laya.Button})],Re.prototype,"addMail",2),u([oo({type:Laya.Button})],Re.prototype,"selectDel",2),u([oo({type:Laya.Button})],Re.prototype,"selectFlag",2),Re=u([Pp("HzpJPDUEQN69Xg1VasHb-w")],Re);var{regClass:Np,property:hi}=Laya,ge=class extends Laya.Script{constructor(){super();this.scrollBarIsStop=!1;this.msgIdNow=1;this.itemIsOpen=!1;this.itemOpenId=-1;this.redHotStatus=[];this.mouseDown=!1}onEnable(){this.refreshList.array=this.createListData(9),this.refreshList.repeatY=this.refreshList.array.length,this.refreshList.vScrollBarSkin="",this.toLine.on(Laya.Event.CLICK,this,this.onToLineBtn),this.toTop.on(Laya.Event.CLICK,this,this.onToTopBtn),this.toBottom.on(Laya.Event.CLICK,this,this.onToBottomBtn),this.refreshList.on(Laya.Event.MOUSE_UP,this,this.stageOnMouseUp),this.refreshList.on(Laya.Event.MOUSE_OUT,this,this.stageOnMouseUp),this.refreshList.scrollBar.stopMoveLimit=this.scrollBarIsStopBind.bind(this),this.refreshLimit("dragTopLimit",80),this.refreshLimit("dragBottomLimit",80,20),this.refreshList.mouseHandler=new Laya.Handler(this,this.onListMouse)}stageOnMouseUp(){this.mouseDown=!1}refreshLimit(e,i,a=0,n=2e3){e==="dragTopLimit"?this.refreshList.scrollBar.topMoveLimit=i:e==="dragBottomLimit"&&(this.refreshList.scrollBar.bottomMoveLimit=i),this.refreshList.scrollBar.on(e,this,()=>{if(console.log("达到了滚动限制:"+e),this.refreshLoading.visible=!0,e==="dragTopLimit"){this.refreshLoading.bottom=NaN,this.refreshLoading.top=a;var r=this.createListData(5,"顶部新增的标题");r=r.concat(this.refreshList.array);var o=0+5,l=0;if(this.redHotStatus.length>0)for(let v=0;v<this.redHotStatus.length;v++)this.redHotStatus[v]+=5}else if(e==="dragBottomLimit"){this.refreshList.scrollBar.disableDrag=!0,this.refreshLoading.top=NaN,this.refreshLoading.bottom=a;var r=this.createListData(5,"底部新增的标题");r=this.refreshList.array.concat(r);var o=this.refreshList.array.length-1,l=o+5}this.scrollBarIsStop=!0,Laya.timer.once(n,this,()=>{this.refreshList.array=r,this.refreshList.scrollTo(l),this.refreshList.selectedIndex=o,this.scrollBarIsStop=!1,this.refreshList.scrollBar.backToNormal(),this.refreshLoading.visible=!1})})}onListMouse(e,i){e.type==Laya.Event.MOUSE_DOWN&&(this.mouseDown=!0,this.itemIsOpen?(this.itemIsOpen=!1,this.itemOpenId=-1,Laya.Tween.to(this.openedItem,{x:0},500,null,Laya.Handler.create(this,()=>{this.refreshList.scrollBar.disableDrag=!1}))):(this.moveLastPos=e.target.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),e.target.on(Laya.Event.MOUSE_MOVE,this,this.onItemBoxMouseMove,[e.target,i]))),e.type==Laya.Event.MOUSE_UP&&(this.mouseDown=!1,this.itemOnMouseUp()),e.type==Laya.Event.CLICK&&(e.target.name=="flag"&&this.onClickFlag(i),e.target.name=="del"&&this.onClickDel(i))}itemOnMouseUp(){if(this.itemIsOpen){var e;this.openedItem.x<-80?e=-262:(this.itemIsOpen=!1,e=0),e!==this.openedItem.x&&Laya.Tween.to(this.openedItem,{x:e},500),this.refreshList.scrollBar.disableDrag=!1,this.itemOpenId!==-1&&(this.openedItem.off(Laya.Event.MOUSE_MOVE,this,this.onItemBoxMouseMove),this.itemOpenId=-1)}}onClickFlag(e){var i=this.redHotStatus.indexOf(e);i==-1?(this.refreshList.array[e].avatar={},this.refreshList.array[e].avatar.redHot={visible:!0},this.refreshList.array[e].flag={flagText:{text:"标记已读"}},this.redHotStatus.push(e)):(this.refreshList.array[e].avatar={redHot:{visible:!1}},this.refreshList.array[e].flag={flagText:{text:"标记未读"}},this.redHotStatus.splice(i,1)),this.refreshList.refresh()}onClickDel(e){this.refreshList.array.splice(e,1),this.itemOpenId=-1;var i=this.redHotStatus.indexOf(e);if(i>-1&&this.redHotStatus.splice(e,1),this.redHotStatus.length>0)for(let a=0;a<this.redHotStatus.length;a++)this.redHotStatus[a]>e&&(this.redHotStatus[a]+=1);this.refreshList.refresh()}onItemBoxMouseMove(e,i){if(this.mouseDown){let a=e.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),n=this.moveLastPos.x-a.x,r=this.moveLastPos.y-a.y;Math.abs(n)>Math.abs(r)&&!this.itemIsOpen&&(this.openedItem=e,this.itemIsOpen=!0,this.refreshList.scrollBar.disableDrag=!0,this.itemOpenId=i),this.itemIsOpen&&(this.openedItem.x-=n,this.openedItem.x<-262?this.openedItem.x=-262:this.openedItem.x>0&&(this.openedItem.x=0))}else this.refreshList.scrollBar.disableDrag=!1}scrollBarIsStopBind(){return this.scrollBarIsStop}onToLineBtn(){let e=parseInt(this.lineNumber.text)-1;this.refreshList.scrollTo(e),e<this.refreshList.array.length&&(this.refreshList.selectedIndex=e)}onToTopBtn(){this.refreshList.scrollTo(0),this.refreshList.selectedIndex=0}onToBottomBtn(){let e=this.refreshList.array.length-1;this.refreshList.scrollTo(e),this.refreshList.selectedIndex=e}createListData(e=5,i="初始测试标题"){let a=new Date,n=a.getHours()<10?"0"+a.getHours():""+a.getHours(),r=a.getMinutes()<10?"0"+a.getMinutes():""+a.getMinutes();for(var o=[],l=0;l<e;l++){let v={text:n+" : "+r};o[l]={},o[l].msgTime=v,o[l].msgTitle={text:i+(this.msgIdNow+l)},o[l].avatar={redHot:{visible:!1}}}return this.msgIdNow+=l,o}onDisable(){}};u([hi({type:Laya.List})],ge.prototype,"refreshList",2),u([hi({type:Laya.Button})],ge.prototype,"toLine",2),u([hi({type:Laya.Button})],ge.prototype,"toTop",2),u([hi({type:Laya.Button})],ge.prototype,"toBottom",2),u([hi({type:Laya.Box})],ge.prototype,"refreshLoading",2),u([hi({type:Laya.Label})],ge.prototype,"lineNumber",2),ge=u([Np("m0TR8w0gTbWSvHbZTzrORA")],ge);var lo=class extends Laya.View{};var{regClass:Bp,property:uR}=Laya,Sa=class extends lo{onEnable(){this.tree1.xml=this.getTreeData(!0),this.tree2.xml=this.getTreeData(!1)}getTreeData(t){let e="<data>";if(t)e+="<dir itemLabel='一级目录一' isOpen='false'><file itemLabel='二级子项1 '/><file itemLabel='二级子项2 '/><file itemLabel='二级子项3 '/><file itemLabel='二级子项4 '/><file itemLabel='二级子项5 '/></dir><dir itemLabel='一级目录二' isOpen='true'><file itemLabel='二级子项1 '/><file itemLabel='二级子项2 '/><file itemLabel='二级子项3 '/></dir><dir itemLabel='一级目录三' isOpen='false'><file itemLabel='二级子项1 '/><file itemLabel='二级子项2 '/><file itemLabel='二级子项3 '/><file itemLabel='二级子项4 '/><file itemLabel='二级子项5 '/></dir><file itemLabel='一级子项1 '/><file itemLabel='一级子项2 '/>";else for(let i=0;i<5;i++){e+="<item title='目录"+(i+1)+"' isOpen='true'>";for(let a=0;a<5;a++)e+="<subpage title='子项标题"+(a+1)+"' />";e+="</item>"}return e+="</data>",new Laya.XML(e)}};Sa=u([Bp("GJWtWFwsQoqNpjA1k42SpQ")],Sa);var co=class extends Laya.Scene{};var{regClass:Hp,property:yR}=Laya,Ea=class extends co{onEnable(){}onDisable(){}};Ea=u([Hp("JQ1fkq03ThewqQWRXQPgmw")],Ea);var{regClass:Up,property:fR}=Laya,je=class extends Laya.Script{constructor(){super()}baseUI(e){this.window=e,this.searchCloseButton(e)}searchCloseButton(e){for(let i=0;i<e.numChildren;i++){let a=e.getChildAt(i);a instanceof Laya.Button&&a.name=="closeBtn"?(a.on(Laya.Event.MOUSE_DOWN,this,()=>{this.window.close()}),console.log("baseUI 发现closeBtn，统一添加关闭事件")):this.searchCloseButton(a)}}onDisable(){}};je=u([Up("7Fkz4T7JQ5ujwNcIx9lGNA")],je);var{regClass:Vp,property:vR}=Laya,Ta=class extends je{constructor(){super()}onEnable(){this.ui=this.owner,this.baseUI(this.ui)}onDisable(){}};Ta=u([Vp("utN7JQs_T3iw6KqWT-beFQ")],Ta);var uo=class extends Laya.Box{};var{regClass:Gp,property:TR}=Laya,uc=Laya.Event,pc=Laya.Mouse,Da=class extends uo{constructor(){super()}onEnable(){Laya.Browser.onPC?(this.panel.on(uc.MOUSE_OVER,this,()=>{pc.cursor="move"}),this.panel.on(uc.MOUSE_OUT,this,()=>{pc.cursor="auto"})):this.topLab.text="背景可拖拽，双指缩放改变大小"}};Da=u([Gp("9s1SW9WKRrSodo6JY27VSw")],Da);var{regClass:Fp,property:po}=Laya,ke=class extends Laya.Script{constructor(){super()}onEnable(){this.graphics=this.graphicsSprite.graphics,Laya.timer.loop(2e3,this,()=>{this.changeImgSkin(),this.changeSpriteTexture(),this.changeFillTexture(),this.changeTexture()})}changeImgSkin(){this.Img.skin=this.randomImg()}changeSpriteTexture(){this.spImg.loadImage(this.randomImg(!0,6,5))}changeFillTexture(){this.graphics.clear();let e=this.randomImg(!0,4);Laya.loader.load(e).then(i=>{this.graphics.fillTexture(i,0,0,1,1)})}changeTexture(){this.textureImg.graphics.clear();let e=Laya.loader.getRes(this.randomImg(!0,8));this.textureImg.graphics.drawTexture(e)}randomImg(e=!1,i=8,a=1){let n=Math.floor(Math.random()*(i-a+1))+a;return e?"resources/UI/role/m"+n+".png":"resources/UI/role/w"+n+".png"}onDisable(){}};u([po({type:Laya.Image})],ke.prototype,"Img",2),u([po({type:Laya.Sprite})],ke.prototype,"spImg",2),u([po({type:Laya.Sprite})],ke.prototype,"graphicsSprite",2),u([po({type:Laya.Sprite})],ke.prototype,"textureImg",2),ke=u([Fp("ulgCMWfCQKiihSJynpbJFg")],ke);var mo=class extends Laya.View{};var{regClass:Kp,property:kR}=Laya,ho=Laya.Event,Ca=class extends mo{onEnable(){this._hitArea.on(ho.MOUSE_DOWN,this,()=>{this._hitArea.off(ho.MOUSE_MOVE,this,this.bg3MaskMove),this._hitArea.startDrag(),this._hitArea.on(ho.MOUSE_MOVE,this,this.bg3MaskMove)}),this._mask.on(ho.MOUSE_MOVE,this,this.maskMove)}bg3MaskMove(t){t.stopPropagation(),this.bg3Mask.x=this._hitArea.x,this.bg3Mask.y=this._hitArea.y}maskMove(){let t=this.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),e=t.x-this._mask.width/this.bg2.scaleX/2,i=t.y-this._mask.height/this.bg2.scaleY/2;e>80&&i>80&&(this._mask.x=t.x-this._mask.width/this.bg2.scaleX/2,this._mask.y=t.y-this._mask.height/this.bg2.scaleY/2,this.bg2.x=(-t.x-this._mask.width/2)*(this.bg2.scaleX-1),this.bg2.y=(-t.y-this._mask.height/2)*(this.bg2.scaleY-1))}};Ca=u([Kp("zt0rBsEST9KVJgcimd7SFA")],Ca);var{regClass:Wp,property:Xe}=Laya,oe=class extends Laya.Script{constructor(){super()}onEnable(){this.changeMouseCursor(),this.throughTab.selectHandler=new Laya.Handler(this,this.onSwitchTab)}onSwitchTab(e){switch(e){case 0:this.leftBg.hitTestPrior=!0,this.rightBg.hitTestPrior=!0;break;case 1:this.leftBg.hitTestPrior=!1,this.rightBg.hitTestPrior=!1;break}}changeMouseCursor(){this.leftBg.on(Laya.Event.MOUSE_OVER,this,()=>{Laya.Mouse.cursor="move"}),this.leftBg.on(Laya.Event.MOUSE_OUT,this,()=>{Laya.Mouse.cursor="auto"}),this.rightBg.on(Laya.Event.MOUSE_OVER,this,()=>{Laya.Mouse.cursor="move"}),this.rightBg.on(Laya.Event.MOUSE_OUT,this,()=>{Laya.Mouse.cursor="auto"}),this.leftBg.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了左侧的可点击区域",point:{x:Laya.stage.mouseX-100}}),console.log("click "+this.leftBg.name)}),this.rightBg.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了右侧的可点击区域",point:{x:Laya.stage.mouseX-120}}),console.log("click "+this.rightBg.name)}),this.btn1.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了测试按钮1"}),console.log("click btn1")}),this.btn2.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了测试按钮2"}),console.log("click btn2")}),this.close1.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了左侧关闭按钮",point:{x:Laya.stage.mouseX-100}}),console.log("click "+this.close1.name)}),this.close2.on(Laya.Event.CLICK,this,e=>{e.stopPropagation(),Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:"点击了右侧关闭按钮",point:{x:Laya.stage.mouseX-120}}),console.log("click "+this.close2.name)})}onDisable(){}};u([Xe({type:Laya.Tab})],oe.prototype,"throughTab",2),u([Xe({type:Laya.Sprite})],oe.prototype,"leftBg",2),u([Xe({type:Laya.Sprite})],oe.prototype,"rightBg",2),u([Xe({type:Laya.Button})],oe.prototype,"btn1",2),u([Xe({type:Laya.Button})],oe.prototype,"btn2",2),u([Xe({type:Laya.Sprite})],oe.prototype,"close1",2),u([Xe({type:Laya.Sprite})],oe.prototype,"close2",2),oe=u([Wp("AmLUThtNSaW6zL9W205gyg")],oe);var{regClass:Yp,property:yo}=Laya,Oe=class extends Laya.Script{onEnable(){this.bTop.getComponent(Laya.BoxCollider).width=this.bTop.width,this.bBottom.getComponent(Laya.BoxCollider).width=this.bBottom.width,this.bRight.getComponent(Laya.BoxCollider).height=this.bRight.height,this.bLeft.getComponent(Laya.BoxCollider).height=this.bLeft.height}};u([yo({type:Laya.Image})],Oe.prototype,"bTop",2),u([yo({type:Laya.Image})],Oe.prototype,"bBottom",2),u([yo({type:Laya.Image})],Oe.prototype,"bRight",2),u([yo({type:Laya.Image})],Oe.prototype,"bLeft",2),Oe=u([Yp("jp5l8WZtQLuVyfU4ljEFyQ")],Oe);var go=class extends Laya.View{};var{regClass:jp,property:KR}=Laya,Ma=class extends go{onEnable(){this.testProgress()}testProgress(){this.loading2.value=.01,this.loadText.text="资源加载中……",Laya.timer.loop(100,this,this.changeProgress)}changeProgress(){this.loading2.value+=.05,this.loading2.value==1&&(this.loadText.text="资源加载完成",Laya.timer.clear(this,this.changeProgress),Laya.timer.once(3e3,this,()=>{this.testProgress()}))}};Ma=u([jp("9w97n2rXRjiACN_vzizQPw")],Ma);var{regClass:Xp,property:jR}=Laya,Ve=class extends Laya.Script{constructor(){super()}onStart(){this._anim=this.owner.getComponent(Laya.Animator)}isPlayanimaByName(e=0){let i=this._anim.getControllerLayer(e);if(i==null)return!1;let a=i.getCurrentPlayState();return a==null?!1:a.animatorState.clip.islooping?!0:a._finish}isSameByName(e,i=0){let a=this._anim.getControllerLayer(i);if(a==null)return!1;let n=a.getCurrentPlayState();if(n==null)return!1;if(n.animatorState.name==e)return!0}playAnim(e,i=!1){if(i){if(this.isSameByName(e))return;this._anim.play(e,0,0);return}this.isPlayanimaByName()||this._anim.play(e,0,0)}};Ve=u([Xp("q0uAMn-DTUm70T4fGtxGlw")],Ve);var kt=Laya.InputManager,{regClass:qp,property:tk}=Laya,xa=class extends Laya.Script{constructor(){super(...arguments);this.currRockerBar=null;this.maxDistance=80;this.isMouseDown=!1;this.mouseDownPosition=new Laya.Point;this._currentMouse=new Laya.Point;this.initRockerBarPosition=new Laya.Point;this.key1Pressed=!1;this.key2Pressed=!1;this.key3Pressed=!1;this.key4Pressed=!1;this.directionOffset=0;this.isKeyRun=!1}onEnable(){Laya.InputManager.multiTouchEnabled=!0}onStart(){this.currRockerBar=this.owner.getChildByName("freebar"),this.img_freebar_arrow=this.currRockerBar.getChildByName("img_freebar_arrow"),this.freetrack=this.owner.getChildByName("freetrack"),this.img_arrow_left=this.freetrack.getChildByName("img_arrow_left"),this.img_arrow_right=this.freetrack.getChildByName("img_arrow_right"),this.img_arrow_up=this.freetrack.getChildByName("img_arrow_up"),this.img_arrow_down=this.freetrack.getChildByName("img_arrow_down"),this.img_freebar_arrow.visible=!1,Laya.Browser.onPC?this.freetrack.visible=!0:this.img_arrow_left.visible=this.img_arrow_right.visible=this.img_arrow_up.visible=this.img_arrow_down.visible=!1,this.initialise()}initialise(){this.initRockerBarPosition.setTo(this.currRockerBar.x,this.currRockerBar.y),this.currRockerBar.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.onMouseMove),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onMouseUp)}onSkillKeyDown(e,i,a){switch(e.stopPropagation(),i){case 1:this.key1Pressed=a;break;case 2:this.key2Pressed=a;break;case 3:this.key3Pressed=a;break}}onMouseDown(e){W.instance.stopAll||(e.stopPropagation(),this.isMouseDown=!0,this.currRockerBar.selected=!0,Laya.Browser.onPC||(this.freetrack.visible=!0),this.mouseDownPosition.setTo(this.owner.mouseX,this.owner.mouseY),console.log("onMouseDown this.owner.mouse: ",this.owner.mouseX,this.owner.mouseY),this.isKeyRun=!1,this.touchId=e.touchId)}onMouseUp(e){this.isMouseDown&&this.endClick(e)}endClick(e){this.isMouseDown=!1,this.currRockerBar.x=this.initRockerBarPosition.x,this.currRockerBar.y=this.initRockerBarPosition.y,this.currRockerBar.selected=!1,Laya.Browser.onPC||(this.freetrack.visible=!1),this.setDir(-4)}onMouseMove(e){if(!this.isMouseDown||!this.currRockerBar)return;e.stopPropagation(),this._currentMouse.setTo(e.stageX,e.stageY);let i=this.owner.globalToLocal(this._currentMouse,!1),a=i.x-this.mouseDownPosition.x,n=i.y-this.mouseDownPosition.y;if(Math.sqrt(_i(a,2)+_i(n,2))<this.maxDistance)this.currRockerBar.x=this.initRockerBarPosition.x+a,this.currRockerBar.y=this.initRockerBarPosition.y+n;else{let o=Math.atan2(a,n);this.currRockerBar.x=Math.sin(o)*this.maxDistance+this.initRockerBarPosition.x,this.currRockerBar.y=Math.cos(o)*this.maxDistance+this.initRockerBarPosition.y}if(Math.abs(a)>this.directionOffset||Math.abs(n)>this.directionOffset){let o=se.judgePosition(a,n);console.log("this.direction:"+o),this.setDir(o)}}onUpdate(){W.instance.stopAll||this.getKeyboardPressed()}setDir(e){if(this.lastDirection!=e&&(A.instance.setMyHeroDirection(e),this.lastDirection=e),e==-4)this.img_freebar_arrow.visible=!1;else{this.img_freebar_arrow.visible=!0;let i=(e-3)*45;this.img_freebar_arrow.rotation=45+i}}getKeyboardPressed(){if(kt.hasKeyDown(Laya.Keyboard.W)&&kt.hasKeyDown(Laya.Keyboard.A)?(this.isKeyRun=!0,this.setDir(8)):kt.hasKeyDown(Laya.Keyboard.W)&&kt.hasKeyDown(Laya.Keyboard.D)?(this.isKeyRun=!0,this.setDir(2)):kt.hasKeyDown(Laya.Keyboard.S)&&kt.hasKeyDown(Laya.Keyboard.A)?(this.isKeyRun=!0,this.setDir(6)):kt.hasKeyDown(Laya.Keyboard.S)&&kt.hasKeyDown(Laya.Keyboard.D)?(this.isKeyRun=!0,this.setDir(4)):kt.hasKeyDown(Laya.Keyboard.W)?(this.isKeyRun=!0,this.setDir(1)):kt.hasKeyDown(Laya.Keyboard.D)?(this.isKeyRun=!0,this.setDir(3)):kt.hasKeyDown(Laya.Keyboard.S)?(this.isKeyRun=!0,this.setDir(5)):kt.hasKeyDown(Laya.Keyboard.A)?(this.isKeyRun=!0,this.setDir(7)):this.isKeyRun&&this.setDir(-4),kt.hasKeyDown(Laya.Keyboard.H)||kt.hasKeyDown(Laya.Keyboard.NUMPAD_1)){if(this.key1Pressed)return;this.key1Pressed=!0,d.intance.event(b.EVENT_CLICK_NUM,1),Laya.timer.once(500,this,this.notKey1Pressed)}if(kt.hasKeyDown(Laya.Keyboard.J)||kt.hasKeyDown(Laya.Keyboard.NUMPAD_2)){if(this.key2Pressed)return;this.key2Pressed=!0,d.intance.event(b.EVENT_CLICK_NUM,2),Laya.timer.once(500,this,this.notKey2Pressed)}if(kt.hasKeyDown(Laya.Keyboard.K)||kt.hasKeyDown(Laya.Keyboard.NUMPAD_3)){if(this.key3Pressed)return;this.key3Pressed=!0,d.intance.event(b.EVENT_CLICK_NUM,3),Laya.timer.once(500,this,this.notKey3Pressed)}if(kt.hasKeyDown(Laya.Keyboard.L)||kt.hasKeyDown(Laya.Keyboard.NUMPAD_4)){if(this.key4Pressed)return;this.key4Pressed=!0,d.intance.event(b.EVENT_CLICK_NUM,4),Laya.timer.once(500,this,this.notKey4Pressed)}}notKey1Pressed(){this.key1Pressed=!1}notKey2Pressed(){this.key2Pressed=!1}notKey3Pressed(){this.key3Pressed=!1}notKey4Pressed(){this.key4Pressed=!1}getKeyPressed(e){var i=e.toParentPoint(new Laya.Point(e.x,e.y));return i.x>e.x&&i.x<e.x+e.width&&i.y>e.y&&i.y<e.y+e.height}getDistance(e,i,a,n){let r=e-a,o=i-n;return Math.sqrt(r*r+o*o)}onDisable(){Laya.InputManager.multiTouchEnabled=!1}};xa=u([qp("7cTqWb35RwygSkuWy4QkgQ")],xa);var di=class{static playSkillEffect(t,e,i){var a=["Attack01","Attack02","Attack03","Attack04"],n=a[e];Laya.Sprite3D.load(t,Laya.Handler.create(null,function(r){i.addChild(r);var o=r.getChildByName(n);o.active=!0;var l=o.getComponent(Laya.ShurikenParticleRenderer);l._particleSystem.play(),setTimeout(()=>{r.removeSelf()},1e3)}))}static playEnemyHurtSkillEffect(t,e){Laya.Sprite3D.load(t,Laya.Handler.create(null,function(i){e.addChild(i);var a="Attack",n=i.getChildByName(a),r=n.getComponent(Laya.ShurikenParticleRenderer);if(r._particleSystem.play(),n.numChildren>0)for(let v=0;v<n.numChildren;v++){var o=n.getChildAt(v),l=o.getComponent(Laya.ShurikenParticleRenderer);l._particleSystem.play()}setTimeout(()=>{i.removeSelf()},1e3)}))}static playNormalEffect(t,e){Laya.Sprite3D.load(t,Laya.Handler.create(null,function(i){e.addChild(i);var a=i,n=a.getComponent(Laya.ShurikenParticleRenderer);if(n._particleSystem.play(),a.numChildren>0)for(let l=0;l<a.numChildren;l++){var r=a.getChildAt(l),o=r.getComponent(Laya.ShurikenParticleRenderer);o._particleSystem.play()}setTimeout(()=>{i.removeSelf()},1e3)}))}};var{regClass:zp,property:mc}=Laya,qe=class extends Laya.Script{constructor(){super();this.followTarget=null;this.speed=.02;this.mLife=5;this.mIsEnd=!1;this.mIsAttack=!1;this.mIsAttackStart=!1;this.mCanPlayFirst=!0;this.mAttackDelayTime=0;this.mCurrentIndex=0;this.followTarget=A.instance.getCurrentHero()}onUpdate(){if(!this.mIsEnd){this.followTarget==null&&(this.followTarget=A.instance.getCurrentHero());var e=new Laya.Vector3(this.followTarget.transform.position.x,0,this.followTarget.transform.position.z),i=new Laya.Vector3(this.owner.transform.position.x,0,this.owner.transform.position.z),a=Laya.Vector3.distance(e,i);if(a<10)if(a<=1)this.mIsAttack?this.isAttackendByPlayer():(this.mCanPlayFirst?(this.mCanPlayFirst=!1,this.attackPlayer()):(this.mAttackDelayTime=this.mAttackDelayTime+Laya.timer.delta,this.mAttackDelayTime>1e3&&(this.mAttackDelayTime=0,this.attackPlayer())),this.mIsAttackStart=!1),A.instance.insertValidList(this.owner);else{this.mAttackDelayTime=0;var n=new Laya.Vector3;Laya.Vector3.subtract(e,i,n),Laya.Vector3.normalize(n,n),this.owner.transform.lookAt(e,Laya.Vector3.Up);var r=this.owner.transform.position;r.vadd(new Laya.Vector3(n.x*this.speed,0,n.z*this.speed),r),this.owner.transform.position=r,this.anim&&this.anim.playAnim("run",!0),this.mCanPlayFirst=!0,this.mIsAttackStart=!1,this.mIsAttack=!1}else this.anim&&this.anim.playAnim("ldle",!0),A.instance.removeValidListByValue(this.owner);this.mLife<=0&&(this.mIsEnd=!0,this.anim&&this.anim.playAnim("die",!0),setTimeout(()=>{A.instance.removeValidListByValue(this.owner),this.owner.removeSelf();var o=A.instance.getCurrentPlane(),l=this.mCurrentIndex;A.instance.createEnemy(o.getChildAt(l),l)},600))}}setCurrentIndex(e){this.mCurrentIndex=e}setLife(e){this.mLife=e}attackPlayer(){di.playEnemyHurtSkillEffect("resources/prefab/eff_monster.lh",this.owner.getChildAt(0)),A.instance.playSound(2),this.anim&&this.anim.playAnim("attack",!0),setTimeout(()=>{this.mIsEnd||this.anim&&this.anim.playAnim("ldle",!0)},500)}isAttackendByPlayer(){this.mIsAttackStart||(this.anim&&this.anim.playAnim("shouji",!0),di.playNormalEffect("resources/prefab/eff_shouji.lh",this.owner.getChildAt(0)),setTimeout(()=>{this.mIsEnd||(this.anim&&this.anim.playAnim("shouji",!0),this.mIsAttack=!1)},500),this.mIsAttackStart=!0)}getLife(){return this.mLife}setIsAttack(e){this.mIsAttack=e}};u([mc({type:Ve})],qe.prototype,"anim",2),u([mc({type:"number"})],qe.prototype,"speed",2),qe=u([zp("eWO-rqURQ6ag7phXtJPZCA")],qe);var{regClass:Qp,property:Aa}=Laya,_e=class extends Laya.Script{constructor(){super();this.animname="";this.force=!1;this.isBig=!1;this.isCanClick=!0}onStart(){d.intance.on(b.EVENT_CLICK_NUM3,this,this.onMouseClick)}onMouseClick(e){this.isCanClick&&(Laya.Tween.to(this.btn_pic,{scaleX:1.1,scaleY:1.1},250,Laya.Ease.linearIn,Laya.Handler.create(this,()=>{Laya.Tween.to(this.btn_pic,{scaleX:1,scaleY:1},150,Laya.Ease.linearIn)})),A.instance.myHeroSpr.getComponent(Fe).catchItem(),A.instance.playSound(1),this.anim1&&(this.anim1.playAnim(this.animname,this.force),setTimeout(()=>{this.anim1.playAnim("idle",this.force),this.isCanClick=!0},500)))}onDestroy(){d.intance.offAllCaller(this)}};u([Aa({type:Ve})],_e.prototype,"anim1",2),u([Aa({type:"string"})],_e.prototype,"animname",2),u([Aa({type:"boolean"})],_e.prototype,"force",2),u([Aa({type:"boolean"})],_e.prototype,"isBig",2),u([Aa({type:Laya.Sprite})],_e.prototype,"btn_pic",2),_e=u([Qp("xovkzdhOSuOc_JJKi_7s2g")],_e);var{regClass:Jp,property:hc}=Laya,ze=class extends Laya.Script{constructor(){super();this.isBig=!1;this.isCanClick=!0}onStart(){d.intance.on(b.EVENT_CLICK_NUM,this,this.onNumberClick)}onNumberClick(e){e==1?this.isBig||this.onMouseClick(null):this.isBig&&this.onMouseClick(null)}onMouseClick(e){if(this.isCanClick){this.isCanClick&&(this.isCanClick=!1);var i=A.instance.getValidList();Laya.Tween.to(this,{scaleX:1.1,scaleY:1.1},250,Laya.Ease.linearIn,Laya.Handler.create(this,()=>{Laya.Tween.to(this,{scaleX:1,scaleY:1},150,Laya.Ease.linearIn)}));var a=0;this.isBig?(A.instance.myHeroSpr.attack(),A.instance.playSound(3)):(A.instance.myHeroSpr.attack(),A.instance.playSound(1)),setTimeout(()=>{this.isCanClick=!0},500)}}getDistance(e,i){return Math.sqrt(e*e+i*i)}getDistanceByPoint(e,i,a,n){let r=e-a,o=i-n;return Math.sqrt(r*r+o*o)}onDestroy(){d.intance.offAllCaller(this)}};u([hc({type:"boolean"})],ze.prototype,"isBig",2),u([hc({type:Laya.Sprite})],ze.prototype,"btn_pic",2),ze=u([Jp("ye1w48wgTbqktuLPDOjmkw")],ze);var{regClass:Zp,property:vk}=Laya,Ra=class extends Laya.Script{constructor(){super(...arguments);this.maxX=0;this.minX=-90;this.maxY=0;this.minY=-580;this.scaleSize=.1;this.lastDistance=0;this.startedSingleTouchDrag=!1}onEnable(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.onMouseWheel()}onMouseWheel(){this.owner.on(Laya.Event.MOUSE_WHEEL,this,e=>{let i=this.owner.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY));e.delta>0&&(this.owner.scaleX+=this.scaleSize,this.owner.scaleY+=this.scaleSize),e.delta<0&&(this.owner.scaleX-=this.scaleSize,this.owner.scaleY-=this.scaleSize,this.owner.scaleX<1&&(this.owner.scaleX=1),this.owner.scaleY<1&&(this.owner.scaleY=1));let a=this.owner.globalToLocal(new Laya.Point(Laya.stage.mouseX,Laya.stage.mouseY)),n=(a.x-i.x)*this.owner.scaleX,r=(a.y-i.y)*this.owner.scaleY;n+=this.owner.x,r+=this.owner.y,this.updateLimit(),n>this.maxX?this.owner.x=this.maxX:n<this.minX?this.owner.x=this.minX:this.owner.x=n,r>this.maxY?this.owner.y=this.maxY:r<this.minY?this.owner.y=this.minY:this.owner.y=r})}onStart(){this.updateLimit()}updateLimit(){let e=this.owner.parent;this.minX=Math.min(e.width-this.owner.width*this.owner.scaleX,0),this.minY=Math.min(e.height-this.owner.height*this.owner.scaleY,0)}onMouseDown(e){if(e.stopPropagation(),e.touches&&e.touches.length>1){this.startedSingleTouchDrag&&(this.owner.stopDrag(),this.startedSingleTouchDrag=!1);let i=this.setPivot(e);!i.x||!i.y?console.log("(((((((((((((((((((((((",this.lastPivot,JSON.parse(JSON.stringify(e.touches))):(this.lastDistance=this.getDistance(e),this.lastPivot=i,this.owner.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove))}else this.owner.startDrag(),this.startedSingleTouchDrag=!0}onMouseUp(e){this.owner.off(Laya.Event.MOUSE_MOVE,this,this.mouseMove)}getDistance(e){var i=0;if(e.touches&&e.touches.length>1){let a=e.touches[0].pos.x-e.touches[1].pos.x,n=e.touches[0].pos.y-e.touches[1].pos.y;i=Math.sqrt(a*a+n*n)}return i}mouseMove(e){let i=this.getDistance(e);this.owner.scaleX+=(i-this.lastDistance)*(this.scaleSize/10),this.owner.scaleY+=(i-this.lastDistance)*(this.scaleSize/10),this.owner.scaleX<1&&(this.owner.scaleX=1),this.owner.scaleY<1&&(this.owner.scaleY=1),this.owner.scaleX>5&&(this.owner.scaleX=5),this.owner.scaleY>5&&(this.owner.scaleY=5);let a=this.setPivot(e);if(!a.x||!a.y)console.log("$$$$$$$$$$$",a,JSON.parse(JSON.stringify(e.touches)));else{this.updateLimit();let n=(a.x-this.lastPivot.x)*this.owner.scaleX,r=(a.y-this.lastPivot.y)*this.owner.scaleY;n+=this.owner.x,r+=this.owner.y,n>this.maxX?this.owner.x=this.maxX:n<this.minX?this.owner.x=this.minX:this.owner.x=n,r>this.maxY?this.owner.y=this.maxY:r<this.minY?this.owner.y=this.minY:this.owner.y=r,this.lastDistance=i}}setPivot(e){if(e.touches&&e.touches.length>=2){let i=this.owner.globalToLocal(new Laya.Point(e.touches[0].pos.x,e.touches[0].pos.y)),a=this.owner.globalToLocal(new Laya.Point(e.touches[1].pos.x,e.touches[1].pos.y));return new Laya.Point((i.x+a.x)/2,(i.y+a.y)/2)}return this.lastPivot}onUpdate(){this.owner.x>this.maxX&&(this.owner.x=this.maxX),this.owner.x<this.minX&&(this.owner.x=this.minX),this.owner.y>this.maxY&&(this.owner.y=this.maxY),this.owner.y<this.minY&&(this.owner.y=this.minY)}addTestPoint(e,i="#ff0000",a=2){let n=new Laya.Sprite;n.graphics.drawCircle(0,0,a,i),this.owner.addChild(n),n.pos(e.x,e.y)}};Ra=u([Zp("c71-MoP2RIyCrdBAfjnIgw")],Ra);var{regClass:$p,property:tm}=Laya,yi=class extends Laya.Script{constructor(){super(...arguments);this.tipsText="";this.isDown=!1}onEnable(){this.tipsText.replace(/(^\s*)|(\s*$)/g,"")}onMouseDown(){this.owner.startDrag(),this.isDown=!0}onMouseUp(){this.isDown=!1}onMouseMove(){this.isDown&&Ae.i.collisionWith(this.owner)}onMouseOver(){Laya.Mouse.cursor="move",this.tipsText!==""&&Laya.Scene.open("scenes/uiDemo/Msg.ls",!1,{text:this.tipsText})}onMouseOut(){Laya.Mouse.cursor="auto"}};u([tm({type:"string"})],yi.prototype,"tipsText",2),yi=u([$p("oWa7FUgoQ6CqtyJh_D1Y2w")],yi);var{regClass:em,property:ka}=Laya,bo=Laya.Event,dc=Laya.Point,ve=class extends Laya.Script{constructor(){super();this.runAniName="runRight,runRDown1,runRDown2,runRDown3,runDown,runLDown3,runLDown2,runLDown1,runLeft,runLUp1,runLUp2,runLUp3,runUp,runRUp3,runRUp2,runRUp1";this.standAniName="right,Rdown,down,Ldown,left,Lup,up,Rup";this.stageMouse=new dc;this.axisPivot=new dc;this.angle=0;this.radian=0;this.isMoving=!1;this.isRun=!1}onEnable(){this.joystickBG=this.owner,this.joystickAxis=this.owner.getChildByName("joystickAxis"),this.maxDistance=this.joystickBG.width-this.joystickAxis.width,this.axisPivot.x=this.joystickAxis.x,this.axisPivot.y=this.joystickAxis.y,this.sceneWindow.on(bo.MOUSE_DOWN,this,this.mouseDown),this.sceneWindow.on(bo.MOUSE_MOVE,this,this.mouseMove),this.sceneWindow.on(bo.MOUSE_UP,this,this.mouseUp),this.sceneWindow.on(bo.MOUSE_OUT,this,this.mouseUp),this.roleAniNode=this.roleAni.create(),this.gameMap.addChild(this.roleAniNode),this.roleAniNode.pivot(this.roleAniNode.width/2,this.roleAniNode.height/2),this.roleAniNode.x=this.gameMap.width/2,this.roleAniNode.y=this.gameMap.height/2,this._animator=this.roleAniNode.getComponent(Laya.Animator2D)}mouseDown(e){this.touchId=e.touchId,this.isMoving=!0,this.updateJoystickPoint()}updateJoystickPoint(){this.stageMouse.x=Laya.stage.mouseX,this.stageMouse.y=Laya.stage.mouseY;let e=this.joystickBG.globalToLocal(this.stageMouse),i=e.x-this.joystickAxis.width/2,a=e.y-this.joystickAxis.height/2;this.radian=Math.atan2(a-this.axisPivot.y,i-this.axisPivot.x),this.lastAngle=this.angle,this.angle=Math.round(this.radian*180/Math.PI*10)/10,this.angle<0&&(this.angle+=360),console.log("radian: "+this.radian+", angle: "+this.angle),this.getDistance(this.joystickBG.width/2,this.joystickBG.height/2,e.x,e.y)>this.maxDistance&&this.lastAngle!==this.angle?(this.joystickAxis.x=Math.floor(Math.cos(this.radian)*this.maxDistance)+this.axisPivot.x,this.joystickAxis.y=Math.floor(Math.sin(this.radian)*this.maxDistance)+this.axisPivot.y):this.joystickAxis.pos(e.x-this.joystickAxis.width/2,e.y-this.joystickAxis.height/2),this.switchAni("run")}switchAni(e){if(e=="run"){let i=this.getOrientation(this.angle,this.runAniName);i!==this.lastRunAniName&&(this.lastRunAniName=i,this._animator.play(i)),this.isRun=!0}else{this.isRun=!1;let i=this.getOrientation(this.angle,this.standAniName);this.lastAngle!==this.angle&&this._animator.play(i)}}mouseUp(e){e.touchId==this.touchId&&(this.touchId=null,this.isMoving=!1,this.joystickAxis.pos(this.axisPivot.x,this.axisPivot.y),this.switchAni("stand"))}mouseMove(e){e.touchId==this.touchId&&this.updateJoystickPoint()}getOrientation(e,i){let a=i.split(","),n=360/a.length;return a[Math.floor(e/n)]}onUpdate(){this.isMoving&&this.updateRoleMove()}updateRoleMove(){this.switchAni("run");let e=Math.cos(this.radian)*2,i=Math.sin(this.radian)*2;(e<0&&this.gameMap.x<0||e>0&&this.gameMap.x>this.sceneWindow.width-this.gameMap.width)&&(this.gameMap.x-=e),(i<0&&this.gameMap.y<0||i>0&&this.gameMap.y>this.sceneWindow.height-this.gameMap.height)&&(this.gameMap.y-=i)}getDistance(e,i,a,n){let r=e-a,o=i-n;return Math.sqrt(r*r+o*o)}};u([ka({type:Laya.Prefab})],ve.prototype,"roleAni",2),u([ka({type:"string"})],ve.prototype,"runAniName",2),u([ka({type:"string"})],ve.prototype,"standAniName",2),u([ka({type:Laya.Sprite})],ve.prototype,"gameMap",2),u([ka({type:Laya.Box})],ve.prototype,"sceneWindow",2),ve=u([em("Pl5-_PonSLe-7mCnxeXfRw")],ve);var{regClass:im,property:Mk}=Laya,Oa=class extends Laya.Script{constructor(){super();this.isOpen=!0}onEnable(){this.toolbarBG=this.owner.parent,this._owner=this.owner,this.menu=this.owner.parent.getChildByName("menu")}onMouseDown(e){e.stopPropagation(),this.isOpen?(Laya.Tween.to(this.toolbarBG,{width:106},1e3,Laya.Ease.strongOut),Laya.Tween.to(this._owner,{x:52,rotation:540},1e3,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.isOpen=!1})),Laya.Tween.to(this.menu,{alpha:0},300,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.menu.visible=!1}))):(Laya.Tween.to(this.toolbarBG,{width:460},1e3,Laya.Ease.strongOut),Laya.Tween.to(this._owner,{x:402,rotation:-360},1e3,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.isOpen=!0})),Laya.Tween.to(this.menu,{alpha:1},200,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{this.menu.visible=!0})))}onDisable(){}};Oa=u([im("hPkwKQvKQTaeBeEpHxNUEA")],Oa);})();
//# sourceMappingURL=bundle.js.map
